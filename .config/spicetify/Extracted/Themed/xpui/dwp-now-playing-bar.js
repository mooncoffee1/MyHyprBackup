"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{20814:(e,n,t)=>{t.d(n,{n:()=>d});var i=t(52542),r=t(13734),o=(t(7651),t(83234),t(30456),t(26701),t(37417),t(11737),t(51691),t(702),t(5672),t(43379),t(34192),t(88856),t(51565),t(18316),t(2648)),a=t(17011),c=t(86070),l=["icon","activeIcon","label","isActive"];function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var d=function(e){var n=e.icon,t=e.activeIcon,i=e.label,s=e.isActive,d=(0,r.A)(e,l);return(0,c.jsx)(a.Zp,{label:i,children:(0,c.jsx)(o.H,u({"aria-label":"".concat(i,", ").concat(s?"selected":"unselected",", button"),"aria-pressed":s,semanticColor:s?"textBrightAccent":"textSubdued",iconOnly:s?t:n,"aria-haspopup":"menu",size:"small"},d))})}},223:(e,n,t)=>{t.d(n,{t:()=>y});var i=t(88677),r=t(92156),o=t(15446),a=t(92107),c=t(20814),l=t(45613),s=t(49507),u=t(86222),d=t(80021),v=t(12341),f=(t(86746),t(79024),t(25550),t(71425),t(43379),t(97460),t(15342),t(93577),t(30758)),p=t(85673),g=t(67963),m=t(53607),b=t(86070),h=(0,f.memo)((function(e){var n=e.onFeedbackReasonSelect,t=new Map([["not_relevant",a.Ru.get("ad-formats.ad-feedback.dislike.not-relevant")],["too_often",a.Ru.get("ad-formats.ad-feedback.dislike.too-often")],["unpleasant",a.Ru.get("ad-formats.ad-feedback.dislike.unpleasant-content")],["offensive",a.Ru.get("ad-formats.ad-feedback.dislike.offensive-content")],["do_not_like",a.Ru.get("ad-formats.ad-feedback.dislike.do-not-like")]]);return(0,b.jsx)(m.pZ,{value:"dislike-ad",children:(0,b.jsx)(p.W,{children:Array.from(t).map((function(e){var t=(0,v.A)(e,2),i=t[0],r=t[1];return(0,b.jsx)(m.pZ,{value:r,children:(0,b.jsx)(g.D,{role:"menuitem","aria-label":r,onClick:function(){return n(i,r)},children:r})},i)}))})})})),y=function(e){var n=e.item,t=(0,i.wA)(),v=(0,l.L)(n).logAdFeedback,f=(0,i.d4)((function(e){return(0,u.N2)(e,n.id)}));return(0,b.jsx)(d.b,{menu:(0,b.jsx)(h,{onFeedbackReasonSelect:function(e,i){n.id&&(t((0,s.NI)({adId:n.id,reason:i})),v("dislike_".concat(e)))}}),children:(0,b.jsx)(c.n,{item:n,icon:r.P,activeIcon:o.X,label:a.Ru.get("ad-formats.ad-feedback.dislike"),isActive:f,"data-testid":"button-dislike-ad",onClick:function(){if(n.id){if(f)return t((0,s.vA)({adId:n.id})),void v("cancel_dislike");t((0,s.NI)({adId:n.id})),v("dislike_menu")}}})})}},10877:(e,n,t)=>{t.d(n,{T:()=>y});var i=t(88677),r=t(74587),o=t(8861),a=t(92107),c=t(20814),l=t(45613),s=t(49507),u=t(86222),d=t(80021),v=t(12341),f=(t(86746),t(79024),t(25550),t(71425),t(43379),t(97460),t(15342),t(93577),t(30758)),p=t(85673),g=t(67963),m=t(53607),b=t(86070),h=(0,f.memo)((function(e){var n=e.onFeedbackReasonSelect,t=new Map([["relevant",a.Ru.get("ad-formats.ad-feedback.like.relevant")],["interested_in_brand",a.Ru.get("ad-formats.ad-feedback.like.interested-in-brand")],["interested_in_product",a.Ru.get("ad-formats.ad-feedback.like.interested-in-product")],["enjoyable",a.Ru.get("ad-formats.ad-feedback.like.enjoyable-content")],["discovered_new",a.Ru.get("ad-formats.ad-feedback.like.discovered-new")]]);return(0,b.jsx)(m.pZ,{value:"like-ad",children:(0,b.jsx)(p.W,{children:Array.from(t).map((function(e){var t=(0,v.A)(e,2),i=t[0],r=t[1];return(0,b.jsx)(m.pZ,{value:r,children:(0,b.jsx)(g.D,{role:"menuitem","aria-label":r,onClick:function(){return n(i,r)},children:r})},i)}))})})})),y=function(e){var n=e.item,t=(0,i.wA)(),v=(0,l.L)(n).logAdFeedback,f=(0,i.d4)((function(e){return(0,u.Tt)(e,n.id)}));return(0,b.jsx)(d.b,{menu:(0,b.jsx)(h,{onFeedbackReasonSelect:function(e,i){n.id&&(t((0,s.F$)({adId:n.id,reason:i})),v("like_".concat(e)))}}),children:(0,b.jsx)(c.n,{item:n,icon:r.G,activeIcon:o.q,label:a.Ru.get("ad-formats.ad-feedback.like"),isActive:f,"data-testid":"button-like-ad",onClick:function(){if(n.id){if(f)return t((0,s.D$)({adId:n.id})),void v("cancel_like");t((0,s.F$)({adId:n.id})),v("like_menu")}}})})}},26262:(e,n,t)=>{t.d(n,{O:()=>u});var i=t(2648),r=t(10158),o=t(92107),a=t(17011),c=t(47795),l=t(60455),s=t(86070),u=function(e){var n=e.isDisliked,t=void 0!==n&&n,u=e.onClick,d=void 0===u?function(){}:u,v=e.className,f=e.size,p=void 0===f?"medium":f,g=e.label,m=void 0===g?o.Ru.get("playback-control.ban"):g,b=(0,l.y)();return(0,s.jsx)(a.Zp,{label:m,children:(0,s.jsx)(i.H,{role:"switch","aria-label":m,"aria-checked":t,className:v,onClick:d,iconOnly:r.P,size:b===c.E.MEDIUM?p:"small"})})}},26760:(e,n,t)=>{t.d(n,{z:()=>r});var i=t(79070),r=function(){var e=(0,i.C)(),n=e.togglePanel;return{isPickerOpen:e.isActive,triggerRef:{current:null},toggleDevicePicker:function(e){n(e)}}}},45590:(e,n,t)=>{t.r(n),t.d(n,{NowPlayingBar:()=>Tr});var i=t(30758),r=t(88677),o=t(94079),a=t(2942),c=t(13534),l=t(11854),s=t(92107),u=t(74512);const d="dz_h98rH9nZCwfPdnKgr",v="rAfV2jB_HMM9Xtr0Rqvn",f="XkXPpDRWozMF6G8_GlLQ";var p=t(86070),g=i.memo((function(e){var n=e.handleClick,t=(0,r.d4)(u.q),i=s.Ru.get("pta.bottom-bar.title"),o=s.Ru.get("fta.bottom-bar.subtitle"),a=s.Ru.get("fta.sign-up-free");return(0,p.jsxs)("div",{className:d,onClick:n,"data-testid":"signup-bar",children:[(0,p.jsxs)("div",{className:v,children:[(0,p.jsx)(c.E,{as:"p",variant:"bodySmallBold",children:i}),(0,p.jsx)(c.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:t?s.Ru.get("fta.bottom-bar.subtitle-two"):o}})]}),(0,p.jsx)(l.$,{colorSet:"invertedLight",onClick:n,className:f,children:t?s.Ru.get("mwp.d2p.modal.cta"):a})]})})),m=t(52542),b=(t(47994),t(97500)),h=t.n(b),y=t(96234),k=t(31787),x=t(10595),j=t(26760),C=t(40149),N=t(61325),w=t(12574);const A="gqYYMz8DkhaT3e44LcHQ",I="VX33mI2V_jRA7hRBI9_0";var P=function(e){var n=e.remoteDeviceName,t=e.remoteDeviceType,i=e.connectionStatus,r=e.omitConnectionStateText,o=void 0!==r&&r,a=(0,w.r)(k.s,{}),l=a.spec,u=a.logger,d=(0,j.z)(),v=d.triggerRef,f=d.toggleDevicePicker,g=d.isPickerOpen,m=(0,C.$A)(t,i),b=i===N.zP.CONNECTED?s.Ru.get("web-player.connect.bar.connected-state",{device_name:n}):s.Ru.get("web-player.connect.bar.connecting-state",{device_name:n});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m,{size:"small",className:I,role:"presentation",semanticColor:"essentialBase"}),(0,p.jsx)(y.Y,{component:"button",onClick:function(){var e=l.activeDeviceButtonFactory(),n=u.logInteraction(g?e.hitUiHide():e.hitUiReveal()).interactionId,t=g;f(n),t||(0,x.I)("DEVICE-PICKER")},ref:v,className:A,children:(0,p.jsx)(c.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:o&&i===N.zP.CONNECTED?n:b})})]})};const O="nQSM_BrSHJ4Cp3XSuLOF";var S=function(){return(0,p.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:O,children:[(0,p.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,p.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,p.jsx)("defs",{children:(0,p.jsx)("clipPath",{id:"clip0_491_88335",children:(0,p.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]})},T=t(15136),D=t(21926),E=t(3424),R=t(31650),B=t(75397);const _="main-connectBar-connectBar",F="main-connectBar-connected",L="main-connectBar-connecting";var U=function(){var e=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{isPlayingRemotely:i.isPlayingRemotely,connectionStatus:i.connectionStatus,remoteDeviceName:null===(n=i.remoteDevice)||void 0===n?void 0:n.name,remoteDeviceType:null===(t=i.remoteDevice)||void 0===t?void 0:t.type}}),B.a),n=e.isPlayingRemotely,t=e.connectionStatus,i=e.remoteDeviceName,r=e.remoteDeviceType,o=(0,R.D)().currentSession,a=Boolean(null==o?void 0:o.active),c=n&&i&&r;if(!c&&!a)return null;var l=t===N.zP.CONNECTED||a,s=t===N.zP.CONNECTING&&!a;return(0,p.jsxs)("div",{className:h()(_,(0,m.A)((0,m.A)({"encore-bright-accent-set":l},F,l),L,s)),children:[a&&(0,p.jsx)(T.K,{}),a&&c&&(0,p.jsx)(S,{}),c&&(0,p.jsx)(P,{connectionStatus:t,remoteDeviceName:i,remoteDeviceType:r,omitConnectionStateText:a})]})},M=function(){return(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(U,{})})},V=t(15057),H=t(93493),z=t(49213),Q=t(62822),q=t(93091),K=t.n(q),Z=t(74308),Y=t(61548),W=t(96036),G=t(42444),X=t(92986),J=t(33350),$=t(5248),ee=function(e){var n=e.className,t=void 0===n?"":n,o=e.disabledClassName,a=void 0===o?"":o,c=e.onClick,l=(0,G.lZ)(),u=(0,i.useContext)(W.s),d=(0,$.o)((function(e){var n;return null!==(n=null==e?void 0:e.hasContext)&&void 0!==n&&n})),v=(0,r.wA)(),f=!d,g=(0,i.useCallback)((0,Q.A)(K().mark((function e(){return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=u&&u.current){e.next=2;break}return e.abrupt("return");case 2:null==c||c(!0),v((0,Y.f)()),(0,J.X8)(u.current);case 5:case"end":return e.stop()}}),e)}))),[v,u,c]),b=h()(t,(0,m.A)({},a,f));return l?(0,p.jsx)(X.f,{onToggle:g,className:b,icon:Z.L,label:s.Ru.get("npv.full-screen"),disabled:f,testId:"fullscreen-mode-button"}):null},ne=(0,i.memo)(ee),te=t(83409),ie=t(62586),re=t(45842),oe=t(79070);t(7651),t(30456),t(26701),t(37417),t(11737),t(51691),t(702),t(5672),t(43379),t(34192),t(88856),t(51565),t(18316);var ae=t(12341),ce=t(57502),le=t(2648),se=t(64399),ue=t(63715),de=t(77225);const ve="YXmoVBUuxZBY8Hh5GKjE",fe="T5ZnRxyz77bA1OMH61wo",pe="VLyyIUlq5U8KjKAcs9QA",ge="S8k0V5C_z3AUnCUaJKBg";var me=function(e){var n=e.onClose,t=e.onActionButtonClick,r=e.onMouseEnter,o=e.onMouseLeave,a=e.message,u=e.title,d=e.users,v=(0,w.r)(ue.m,{}),f=v.spec,g=v.logger,m=(0,i.useCallback)((function(){g.logInteraction(f.nudgeScanningTooltipFactory().closeButtonFactory().hitUiHide()),null==n||n()}),[g,n,f]),b=(0,i.useCallback)((function(){g.logInteraction(f.nudgeScanningTooltipFactory().joinButtonFactory().hitJoinSocialListeningSession()),t()}),[g,t,f]);return(0,p.jsxs)("div",{className:ve,onMouseEnter:r,onMouseLeave:o,children:[(0,p.jsxs)("div",{className:fe,children:[d.length>0&&(0,p.jsx)(de.g,{users:d}),(0,p.jsx)(c.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",className:pe,children:u}),(0,p.jsx)(le.H,{iconOnly:se.M,size:"small",semanticColor:"textBase",onClick:m,"aria-label":s.Ru.get("close")})]}),(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:a}),(0,p.jsx)("div",{className:ge,children:(0,p.jsx)(l.$,{colorSet:"invertedLight",size:"small",onClick:b,children:s.Ru.get("web-player.social-connect.join-modal.button-primary")})})]})};const be="xP7v0EBcbJMj1xIJxywg",he="zJU_lLLzQL6oKvMA0c5b";var ye=function(e){var n=e.onClose,t=e.onMouseEnter,i=e.onMouseLeave,r=e.onClick,o=e.impressionCallback,a=e.message;return(0,p.jsxs)("div",{className:be,onMouseEnter:t,onMouseLeave:i,ref:o,onClick:r,children:[(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:a}),(0,p.jsx)(le.H,{iconOnly:se.M,size:"small",semanticColor:"textBase",onClick:function(e){e.stopPropagation(),null==n||n()},"aria-label":s.Ru.get("close"),className:he})]})},ke=t(75195);const xe="Ff6EfEq4XqAVswazzkJY",je="qKtH3N2HaKmj4QktMeei",Ce="YqfUOVs6GgQf7Xx2vGYG";var Ne=function(e){var n=e.onActionButtonClick,t=e.onMouseEnter,r=e.onMouseLeave,o=e.message,a=(0,w.r)(ue.m,{}),u=a.spec,d=a.logger,v=(0,i.useCallback)((function(){d.logInteraction(u.nudgeBroadcastingTooltipFactory().changeButtonFactory().hitUiReveal()),null==n||n()}),[d,n,u]);return(0,p.jsxs)("div",{className:xe,onMouseEnter:t,onMouseLeave:r,children:[(0,p.jsx)(ke.h,{size:"medium",className:je}),(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:o}),(0,p.jsx)("div",{className:Ce,children:(0,p.jsx)(l.$,{colorSet:"invertedLight",size:"small",onClick:v,children:s.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-button")})})]})},we=t(9789),Ae=t(60624),Ie=function(){var e,n,t,i,o,a,c,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we.C,s=(0,r.Pj)(),u=l().isActive,d=(0,Ae.h)();return document.hasFocus()&&!u&&(e=s.getState(),n=d.current.length>0,a=e.ui,c=e.ads,!(a.blockUserDialog.isOpen||a.connectDevicePicker.isOpen||a.deleteFolderDialog.isOpen||a.deletePlaylistDialog.isOpen||a.fullscreenMode.isOpen||a.improvedSignupPromptDialog.isOpen||a.keyboardShortcutsHelpModal.isOpen||a.leavePlaylistDialog.isOpen||a.loginToListenDialog.isOpen||a.offlineDeviceLimitReachedDialog.isOpen||a.playbackNotSupportedErrorDialog.isOpen||a.premiumDialog.isOpen||a.signupToListenDialog.isOpen||!0===(null===(t=c.billboard)||void 0===t?void 0:t.isOpen)&&!c.billboard.isMinimized||!1===(null===(i=c.vto)||void 0===i?void 0:i.isHidden)&&!1===(null===(o=c.vto)||void 0===o?void 0:o.isMinimized)||n))},Pe=t(66143),Oe=function(e){return Boolean(null==e?void 0:e.supportsDJNarration)},Se=t(56575),Te=t(80677),De=t(57039),Ee=t(10821),Re=t(9063),Be=t(64869),_e=t(51653),Fe=t(98962),Le=t(80344),Ue=t(79916),Me="spotify:playlist:37i9dQZF1EYkqdzj48dyYq",Ve=function(e){var n=(0,i.useRef)(),t=(0,i.useRef)(),r=(0,i.useRef)(!1),o=(0,Be.z)(),a=(0,Te.e)(),c=(0,De.Z)(),l=(0,H.NC)(Ue.vF),u=(0,w.r)(Pe.w,{}),d=u.spec,v=u.logger,f=(0,i.useRef)(null),p=(0,i.useCallback)((function(){v.logInteraction(d.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[d,v]),g=(0,i.useCallback)((function(e){e&&f.current!==e&&v.logImpression(d.djVoiceUnsupportedNudgeFactory().impression()),f.current=e}),[d,v]),m=(0,i.useCallback)((function(){var e,n=o.getState();if(l){var t=c.getActiveDevice();return!function(e){var n;return null!==(n=null==e?void 0:e.isLocal)&&void 0!==n&&n}(t)&&(0,Le.yc)(n,Me)!==Fe.i.NOT_ACTIVE&&!Oe(null!=t?t:void 0)}var i=a.getState();return!function(e){return(null==e?void 0:e.connectionStatus)===N.zP.NOT_CONNECTED}(i)&&(0,Le.yc)(n,Me)!==Fe.i.NOT_ACTIVE&&!Oe(null!==(e=null==i?void 0:i.activeDevice)&&void 0!==e?e:void 0)}),[o,l,a,c]),b=(0,i.useCallback)((function(){m()&&e({nudgeType:"message-only-nudge",message:s.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:p,impressionCallback:g})}),[e,m,p,g]),h=(0,i.useCallback)((function(e){e.data.action===Re.Ik.PLAY&&(r.current=!0)}),[]);(0,_e.p)(Re.gd.ACTION,h);var y=(0,i.useCallback)((function(e){var t;r.current&&(0,Le.uW)(e.data)===Fe.i.PLAYING&&(n.current=null===(t=e.data)||void 0===t?void 0:t.context.uri,b(),n.current=void 0,r.current=!1)}),[b]);(0,_e.p)(Re.gd.UPDATE,y);var k=(0,i.useCallback)((function(e){var n,i=null===(n=e.data)||void 0===n?void 0:n.activeDevice;i&&!i.isLocal&&t.current!==i.connectStateId&&b(),t.current=null==i?void 0:i.connectStateId}),[b]);(0,Ee.W)(Se.P.UPDATE,k)},He=(t(60184),t(68216),t(28430),t(9582),t(87250)),ze=function(e){switch(e.type){case N.bq.AUDIO_DONGLE:case N.bq.AVR:case N.bq.CAST_AUDIO:case N.bq.CAST_VIDEO:case N.bq.GAME_CONSOLE:case N.bq.SPEAKER:case N.bq.STB:case N.bq.TV:return!0;default:return!1}},Qe=function(e){return!e||!(e.terminalType===He.FI.HEADPHONES||e.terminalType===He.FI.SPEAKERS&&(e.transportType===He.Yg.BLUETOOTH||e.transportType===He.Yg.USB))},qe=t(89737),Ke=t(73729),Ze=t(34300),Ye=new Date(0).toISOString(),We=["shift+alt+f10"],Ge=function(e){var n=(0,i.useRef)(),t=(0,i.useRef)(!1),o=(0,i.useRef)(!1),a=(0,r.Pj)(),c=(0,Be.z)(),l=(0,Te.e)(),u=(0,De.Z)(),d=(0,Ke.V)(),v=(0,Ze.x)("connect-nudge-triggered-at",Ye),f=(0,ae.A)(v,2),p=f[0],g=f[1],m=(0,i.useRef)(null),b=(0,w.r)(Pe.w,{}),h=b.spec,y=b.logger,k=(0,H.NC)(Ue.vF),x=(0,i.useCallback)((function(){y.logInteraction(h.connectFromDevicePickerNudgeFactory().hitNoAction())}),[h,y]),j=(0,i.useCallback)((function(){y.logInteraction(h.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[h,y]),C=(0,i.useCallback)((function(e){e&&m.current!==e&&y.logImpression(h.connectFromDevicePickerNudgeFactory().impression()),m.current=e}),[h,y]);(0,qe.f)(We,(0,Q.A)(K().mark((function e(){var n,t;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.getState(),n.platform.isDeveloperMode&&((t=new Date).setHours(t.getHours()-8),g(t.toISOString()));case 2:case"end":return e.stop()}}),e)}))));var A=(0,i.useCallback)((function(){var e=c.getState(),n=l.getState(),t=u.getActiveDevice(),i=u.getDevices(),r=d.getDefaultDevice(),o=new Date(p);o.setHours(o.getHours()+8);var a=o<=new Date;return k?a&&function(e){var n;return null!==(n=null==e?void 0:e.isLocal)&&void 0!==n&&n}(t)&&!(0,Le.A3)(e)&&function(e){return e.some((function(e){return e.isLocalNetwork&&!e.isDisabled&&ze(e)}))}(i)&&Qe(r):a&&function(e){return(null==e?void 0:e.connectionStatus)===N.zP.NOT_CONNECTED}(n)&&!(0,Le.A3)(e)&&function(e){return!(null==e||!e.devices.length)&&e.devices.some((function(e){return e.isLocalNetwork&&!e.isDisabled&&ze(e)}))}(n)&&Qe(r)}),[c,l,d,p,k,u]),I=(0,i.useCallback)((function(){if(A()){e({nudgeType:"message-only-nudge",message:s.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:C,onClick:x,onClose:j});var n=(new Date).toISOString();g(n)}}),[e,A,g,x,j,C]),P=(0,i.useCallback)((function(e){e.data.action===Re.Ik.PLAY?t.current=!0:e.data.action===Re.Ik.RESUME&&(o.current=!0)}),[]);(0,_e.p)(Re.gd.ACTION,P);var O=(0,i.useCallback)((function(e){var i,r;if(t.current&&(0,Le.uW)(e.data)===Fe.i.PLAYING)n.current=null===(r=e.data)||void 0===r?void 0:r.context.uri,I(),n.current=void 0,t.current=!1;else if(o.current&&!1===(null===(i=e.data)||void 0===i?void 0:i.isPaused)){var a;n.current=null===(a=e.data)||void 0===a?void 0:a.context.uri,I(),n.current=void 0,o.current=!1}}),[I]);(0,_e.p)(Re.gd.UPDATE,O)},Xe=(t(184),t(42486),t(40065),t(25550),t(4865),t(15342),t(30595)),Je=t(80366),$e=t(85726),en=t(38043),nn=t(86e3),tn=t(55771),rn=t(33983),on=t(85093),an=(t(83234),t(78551),t(82467),t(21167)),cn=t(47281),ln=t(72637),sn=t(88258),un=function(e){Ge(e),Ve(e),function(e){var n=(0,nn.d)(),t=(0,R.D)(),r=t.getSessionInfo,o=t.joinSession,a=t.currentSession,c=(0,$e.vh)(),l=(0,i.useCallback)(function(){var e=(0,Q.A)(K().mark((function e(n,t){var i,r,a;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="IN_PERSON",r=rn.JO.DISCOVERED_DEVICE,e.prev=2,e.next=5,o(n,r,i);case 5:(a=e.sent)&&c.send((0,Xe.X)({session_id:t,join_type:r,join_url:a.joinSessionUri,participation_mode:i})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),e.t0 instanceof Error&&c.send((0,Xe.X)({session_id:t,error_category:e.t0.name,error_data:e.t0.message}));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n,t){return e.apply(this,arguments)}}(),[c,o]),u=(0,i.useCallback)(function(){var n=(0,Q.A)(K().mark((function n(t,i){var r,o,a,c,u,d;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=i.sessionMembers,o=i.sessionOwnerId,a=i.sessionId,c=i.isSessionOwner,(u=r.find((function(e){return e.id===o})))&&!c){n.next=4;break}return n.abrupt("return");case 4:d=r.map((function(e){return{uri:(0,Je.Qj)(e.username).toURI(),displayName:e.displayName,username:e.username,images:e.imageUrl?[{url:e.imageUrl}]:[]}})),e({nudgeType:"join-listening-session-nudge",title:s.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-title",{host:u.displayName,device:t.title}),message:s.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-text"),onClose:function(){},onActionButtonClick:function(){l(t.token,a)},users:d});case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),[l,e]);(0,tn.c)(en.P.SCAN_UPDATE,(function(){var e=function(){var e=(0,Q.A)(K().mark((function e(t){var i,o;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.token);case 2:if(!(i=e.sent)){e.next=8;break}return e.next=6,n.getLocalNetSesssionDeviceVisibility(i.sessionId);case 6:(o=e.sent)!==rn.MS.UNSPECIFIED&&o!==rn.MS.NOTIFY||u(t,i);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();if(null==a||!a.active){var t=n.getLocalNetSessionDevices(),i=null==t?void 0:t.devices.find((function(e){return e.isNew}));i&&e(i)}}))}(e),function(e){var n=(0,an.AI)(ln.Z.DevicePicker,ln.Z.DevicePickerOverlay).panelSend,t=(0,Ze.x)("session-broadcast-nudge-shown",[]),r=(0,ae.A)(t,2),o=r[0],a=r[1],c=(0,i.useCallback)((function(e){var n=[].concat((0,on.A)(o),[e]);n.length>10&&n.shift(),a(n)}),[o,a]);(0,tn.c)(en.P.BROADCAST_NUDGE,(function(t){var i=t.data,r=i.deviceId;i.broadcastStatus===sn.ez.BROADCAST_ON&&r&&!o.includes(r)&&(c(r),e({nudgeType:"session-is-being-broadcasted-nudge",message:s.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-text"),onClose:function(){},onActionButtonClick:function(){n({type:cn.$S.DEVICE_PICKER_BUTTON_CLICK})}}))}))}(e)},dn=(t(60287),function(){var e=(0,i.useRef)(),n=(0,i.useRef)(!1),t=(0,i.useRef)(!1),o=(0,r.wA)(),a=(0,r.d4)((function(e){return e.ui.connectNudge.isOpen})),c=(0,r.d4)((function(e){return e.ui.connectDevicePicker.isOpen})),l=(0,i.useCallback)((function(){t.current&&(clearTimeout(e.current),t.current=!1),o((0,Y.Yp)())}),[o]),s=(0,i.useCallback)((function(){t.current=!1,n.current||l()}),[l]),u=(0,i.useCallback)((function(){e.current=window.setTimeout(s,8e3),o((0,Y.dK)()),t.current=!0}),[o,s]),d=(0,i.useCallback)((function(e){n.current=e,e||t.current||l()}),[l]);return(0,i.useEffect)((function(){c&&l()}),[c,l]),(0,i.useMemo)((function(){return{hideNudge:l,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:a}}),[l,u,d,a])});function vn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function fn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?vn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var pn=function(e){var n=e.children,t=e.useNudgeTriggers,r=void 0===t?un:t,o=e.useToggleNudgeWithTimer,a=void 0===o?dn:o,c=e.useCanShowNudge,l=void 0===c?Ie:c,s=e.disabled,u=void 0!==s&&s,d=a(),v=d.showNudge,f=d.hideNudge,g=d.setShouldKeepShowingNudge,m=d.isNudgeVisible,b=(0,i.useState)(null),h=(0,ae.A)(b,2),y=h[0],k=h[1],x=l();(0,i.useEffect)((function(){m&&!x&&f()}),[x,f,m]),r((function(e){return!(m||!x)&&(k(e),v(),!0)}));var j=(0,i.useCallback)((function(e){if(!e)return(0,p.jsx)(p.Fragment,{});var n=function(){var n;null==e||null===(n=e.onClose)||void 0===n||n.call(e),f()};if("join-listening-session-nudge"===e.nudgeType){return(0,p.jsx)(me,fn(fn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n,onActionButtonClick:function(){var n;null===(n=e.onActionButtonClick)||void 0===n||n.call(e),f()}}))}return"session-is-being-broadcasted-nudge"===e.nudgeType?(0,p.jsx)(Ne,fn(fn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n})):(0,p.jsx)(ye,fn(fn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n}))}),[f,g]);return(0,p.jsx)(ce.W,{maxWidth:"join-listening-session-nudge"===(null==y?void 0:y.nudgeType)?450:void 0,placement:"top",visible:Boolean(null==y?void 0:y.message)&&m&&!u,overlay:j(y),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:function(){},fadeOut:!0,useLazyMounting:!0,children:n})},gn=function(){var e=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{remoteDeviceType:null===(n=i.remoteDevice)||void 0===n?void 0:n.type,remoteDeviceIsGroup:null===(t=i.remoteDevice)||void 0===t?void 0:t.isGroup,connectionStatus:i.connectionStatus}}),B.a),n=e.remoteDeviceType,t=e.remoteDeviceIsGroup,r=e.connectionStatus,o=(0,ie.g)(),a=(0,oe.C)(),c=a.canTogglePanel,l=a.isActive,u=a.togglePanel,d=(0,w.r)(te.p,{}),v=d.spec,f=d.logger,g=(0,i.useCallback)((function(){var e=f.logInteraction(function(e,n,t){return {interactionId:null,pageInstanceId:null};var i;return i=n===N.zP.CONNECTING?e.connectingButtonFactory():n===N.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),t?i.hitUiHide():i.hitUiReveal()}(v,r,l)),n=e.interactionId;u(n)}),[r,u,l,v,f]),m=(0,re.l)().currentDevice.isLocal,b=(0,i.useMemo)((function(){return(0,C.tf)(n,t,m?o:null)}),[o,m,t,n]);return(0,p.jsx)(pn,{children:(0,p.jsx)(X.f,{isActive:l,disabled:!c,onToggle:g,label:s.Ru.get("playback-control.connect-picker"),icon:b})})},mn=t(70187),bn=t(45925),hn=t(21381),yn=t(76547);const kn="A8ETvbaffbfWsxJDy_OW",xn="yQQ8ZWvoqRXw2oHD1OJR";var jn=function(e){var n=e.children;return(0,p.jsx)("div",{className:kn,children:n})},Cn=function(e){var n=e.onHide,t=(0,an._Y)();return(0,p.jsxs)(jn,{children:[(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones")}),(0,p.jsxs)("div",{className:xn,children:[(0,p.jsx)(le.H,{semanticColor:"textSubdued",onClick:n,condensedAll:!0,size:"small",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones.cancel")}),(0,p.jsx)(l.$,{colorSet:"invertedLight",onClick:function(){t(cn.$S.PUFFIN_START_ACTIVATION),n()},size:"small",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")})]})]})},Nn=t(40970),wn=function(){var e=(0,Nn.j)().deviceFilterState.audioDevice;if(!e)return null;var n=e.transportType===He.Yg.BLUETOOTH?e.name:s.Ru.get("web-player.puffin.wired-connection");return(0,p.jsx)(jn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.optimized-for",n)})})},An=function(e){var n=e.hasDevice;return(0,D.l)()?(0,p.jsx)(jn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhanced-listening")})}):n?(0,p.jsx)(jn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhanced-headphones")})}):(0,p.jsx)(jn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.lossless-listening")})})},In=t(82704),Pn=function(e){var n=e.state,t=e.hasDevice,i=e.onHide;switch(n){case"detection":return(0,p.jsx)(Cn,{onHide:i});case"initial":return(0,p.jsx)(An,{hasDevice:t});case"filters_applied":return(0,p.jsx)(wn,{});default:(0,In.k)(n)}return null},On=t(68822),Sn=t(47420);function Tn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Dn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Tn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Tn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var En=function(e){var n=e.children,t=e.onVisibilityChange,r=(0,Sn.c)().isPuffinPanelActive,o=(0,i.useState)("none"),a=(0,ae.A)(o,2),c=a[0],l=a[1],s=(0,Ze.x)("onboarding-dismissed:puffin",{}),u=(0,ae.A)(s,2),d=u[0],v=u[1],f=(0,Nn.j)(),g=f.deviceFilterState,b=f.isMaybeHeadphoneDevice,h=(0,i.useRef)(g.audioDevice),y=(0,On.N)().getSavedDevices().length>0;(0,i.useEffect)((function(){var e;if(g.audioDevice&&(null===(e=h.current)||void 0===e?void 0:e.id)!==g.audioDevice.id){if(h.current=g.audioDevice,r||g.audioDevice.terminalType!==He.FI.HEADPHONES)return;d[g.audioDevice.id]&&!(d[g.audioDevice.id]<3)||g.isOnboarded?(g.currentState.externalizationEnabled||g.currentState.specificEnabled)&&l("filters_applied"):(d[g.audioDevice.id]||v(Dn(Dn({},d),{},(0,m.A)({},g.audioDevice.id,0))),l("detection"))}}),[g,d,r,h,v]);var k=(0,i.useCallback)((function(){l("none")}),[]),x=(0,i.useCallback)((function(){if(null!==g.audioDevice){var e,n=g.audioDevice.id;v(Dn(Dn({},d),{},(0,m.A)({},n,(null!==(e=d[n])&&void 0!==e?e:0)+1)))}}),[g.audioDevice,d,v]);(0,i.useEffect)((function(){if("detection"!==c){var e=setTimeout(k,5e3);return function(){return clearTimeout(e)}}return function(){}}),[k,c]),(0,i.useEffect)((function(){y||d||l("initial")}),[y,d,l]),(0,i.useEffect)((function(){!r&&b||k()}),[k,r,v,b]);var j="none"!==c;return(0,i.useEffect)((function(){t(j)}),[j,t]),(0,p.jsx)(hn.E,{isVisible:j,placement:"top-start",content:j?(0,p.jsx)(bn.z,{onClose:k,maxWidth:287,header:(0,p.jsx)(yn.s,{variant:"bodyMediumBold"}),children:(0,p.jsx)(Pn,{state:c,hasDevice:b,onHide:function(){x(),k()}})}):null,children:n})},Rn=t(78651),Bn=cn.$S.PUFFIN_BUTTON_CLICK,_n=cn.$S.DEVICE_PICKER_BUTTON_CLICK,Fn=function(){var e,n=(0,Rn.c)().isPuffinPanelActive,t=(0,an.AI)(ln.Z.DevicePicker,ln.Z.DevicePickerOverlay),r=t.isActive,o=t.panelSend,a=(0,i.useState)(!1),c=(0,ae.A)(a,2),l=c[0],u=c[1],d=(0,an.Ev)(Bn),v=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{remoteDeviceType:null===(n=i.remoteDevice)||void 0===n?void 0:n.type,remoteDeviceisGroup:null===(t=i.remoteDevice)||void 0===t?void 0:t.isGroup}}),B.a),f=v.remoteDeviceType,g=v.remoteDeviceisGroup,m=(0,ie.g)(),b=(null==m?void 0:m.audioDevice.terminalType)===He.FI.HEADPHONES,h=(e=(0,Nn.j)().deviceFilterState).currentState.externalizationEnabled||e.currentState.specificEnabled,y=r||n,k=h||b,j=(0,re.l)().currentDevice.isLocal,N=(0,i.useMemo)((function(){return h?mn.C:(0,C.tf)(f,g,j?m:null)}),[m,h,g,f,j]);return(0,p.jsx)(pn,{disabled:l,children:(0,p.jsx)(En,{onVisibilityChange:u,children:(0,p.jsx)(X.f,{isActive:y,isActiveNoIndicator:k,onToggle:function(){var e=r;o(_n),e||(0,x.I)("DEVICE-PICKER")},label:s.Ru.get("playback-control.connect-picker"),icon:N,disabled:!d,restoreFocusKey:n?ln.Z.Puffin:ln.Z.DevicePicker})})})},Ln=t(9301),Un=t(65249),Mn=function(){var e=(0,r.d4)(Un.Ht).isAnonymous,n=(0,Ln.v)();return e?null:n?(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(Fn,{})}):(0,p.jsx)(gn,{})},Vn=t(26839),Hn=t(90991),zn=t(73668),Qn=t(90576),qn=t(58114);function Kn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Zn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Kn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Kn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Yn=i.memo((function(e){var n=e.onClick,t=e.className,i=e.isActive,r=e.isEnabled,o=r?s.Ru.get("web-player.lyrics.title"):s.Ru.get("web-player.lyrics.noLyrics1"),a=r?n:void 0;return(0,p.jsx)(X.f,{className:t,isActive:i,onToggle:a,disabled:!r,label:o,testId:"lyrics-button",icon:Vn.q})})),Wn=i.memo((function(e){var n,t=Boolean(null===(n=(0,Qn.J)().data)||void 0===n?void 0:n.hasLyrics);return(0,p.jsx)(Yn,Zn(Zn({},e),{},{isEnabled:t,isActive:!1}))})),Gn=i.memo((function(e){var n=(0,$.o)((function(e){var n;return null==e||null===(n=e.item)||void 0===n?void 0:n.uri})),t=Boolean((0,zn.f)(n).hasLyrics);return(0,p.jsx)(Yn,Zn(Zn({},e),{},{isEnabled:t,isActive:!1}))})),Xn=i.memo((function(e){var n=(0,Hn.$)().isActive,t=(0,r.d4)(Un.Ht).isAnonymous,i=(0,H.NC)(qn.khs),o=(0,$.o)((function(e){var n,t,i;return!(null==e||null===(n=e.item)||void 0===n||!n.uri||!(0,Je.U_)(null==e||null===(t=e.item)||void 0===t?void 0:t.uri))&&!Boolean(null==e||null===(i=e.item)||void 0===i||null===(i=i.metadata)||void 0===i?void 0:i["segment.index"])}));return t||!o?null:n?(0,p.jsx)(Yn,Zn(Zn({},e),{},{isActive:!0,isEnabled:!0})):i?(0,p.jsx)(Wn,Zn({},e)):(0,p.jsx)(Gn,Zn({},e))})),Jn=t(59523),$n=function(e){var n=e.onClick,t=e.className,i=(0,Jn.A)({onChange:n,referrer:"now_playing_bar"}).toggleLyrics;return(0,p.jsx)(Xn,{onClick:i,className:t})},et=t(58832),nt=t(3284),tt=(t(77905),t(6936)),it=t.n(tt),rt=t(57581);const ot="Cffu0OWzcoGaMWSXoGsq",at="L5PLOiBhdFNjs4FEu8ln";var ct=Date.now()-6912e5,lt=i.memo((function(e){var n=e.children,t=(0,i.useState)(!1),r=(0,ae.A)(t,2),o=r[0],a=r[1],l=(0,Ze.x)("npv-onboarding-dismissed-time",ct),u=(0,ae.A)(l,2),d=(u[0],u[1]),v=(0,Ze.x)("npv-onboarding-never-show-again",!1),f=(0,ae.A)(v,2),g=(f[0],f[1]),m=(0,i.useCallback)((function(){rt.h.set((function(){return{triggerId:null,triggerAction:null}})),d(Date.now()),g(o)}),[o,d,g]),b=(0,i.useCallback)((function(e){var n=e.currentTarget.checked;a(n)}),[]),h=it()(s.Ru.get("web-player.now-playing-view.onboarding.description"),{transform:{b:function(e){return(0,p.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:e.children})}}});return(0,p.jsx)(rt.U,{id:"npv-onboarding",className:ot,options:{isCTA:!0,getTitle:function(){return s.Ru.get("web-player.now-playing-view.onboarding.title")},getDescription:function(){return h},primaryButtonText:function(){return s.Ru.get("web-player.now-playing-view.onboarding.dismiss")},checkboxText:function(){return s.Ru.get("web-player.now-playing-view.onboarding.do-not-show-again")},placement:"top-end",tippyWrapperClassName:at,shouldHideOnOutsideClick:function(){return!1}},onPrimaryButtonClick:m,onCheckboxClick:b,children:n})})),st=t(20735),ut=cn.$S.NPV_BUTTON_CLICK,dt=function(e){var n=e.onClick,t=(0,an.AI)(ln.Z.NowPlayingView),i=t.isActive,r=t.panelSend,o=(0,an.Ev)(ut),a=(0,nt.r)(),c=a.mode,l=a.setMode,u=!(0,$.o)((function(e){return{item:null==e?void 0:e.item}}),(function(e,n){var t,i;return(null===(t=e.item)||void 0===t?void 0:t.uri)===(null===(i=n.item)||void 0===i?void 0:i.uri)})).item||!o;return(0,p.jsx)(lt,{children:(0,p.jsx)(X.f,{isActive:i,disabled:u,onToggle:function(){null==n||n(!i),r(ut),c===st.YU.cinema&&l(st.YU.npv)},icon:et.d,label:s.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:ln.Z.NowPlayingView})})},vt=(t(75380),t(79024),t(96794),t(70750),t(93577),t(44286)),ft=t(1762),pt=(t(86746),t(97460),t(96334)),gt=t(33388),mt=t(26596),bt=t(85755),ht=t(57279);var yt=function(e){var n=e.uri,t=e.to,o=e.children,a=e.onDrop,c=e.onNavigate,l=e.className,s=(0,i.useState)(!1),u=(0,ae.A)(s,2),d=u[0],v=u[1],f=(0,i.useRef)(null),g=(0,vt.Zp)(),m=(0,r.wA)(),b=(0,bt.f)(),h=(0,ht.g)(),y=(0,Be.z)(),k=function(e){var n=(0,Je.o_)(e),t=(0,r.d4)(Un.F6);switch(null==n?void 0:n.type){case Je.NQ.PLAYLIST:case Je.NQ.PLAYLIST_V2:var i;if((0,Je.iw)(n)&&(i=n.username),t&&i===t)return[mt.Ay[Je.NQ.TRACK],mt.Ay[Je.NQ.LOCAL],mt.Ay[Je.NQ.ALBUM]];break;case Je.NQ.COLLECTION:return[mt.Ay[Je.NQ.TRACK],mt.Ay[Je.NQ.ALBUM],mt.Ay[Je.NQ.ARTIST],mt.Ay[Je.NQ.PLAYLIST],mt.Ay[Je.NQ.PLAYLIST_V2],mt.Ay[Je.NQ.SHOW]];case Je.NQ.QUEUE:return[mt.Ay[Je.NQ.TRACK],mt.Ay[Je.NQ.LOCAL],mt.Ay[Je.NQ.EPISODE]];default:return[]}return[]}(n),x=!!k.length;return(0,i.useEffect)((function(){return d?f.current=window.setTimeout((function(){(0,Je.U_)(n)||(null==c||c(),g(t||(0,Je.o_)(n).toURLPath(!0)))}),1e3):!d&&f.current&&clearTimeout(f.current),function(){f.current&&clearTimeout(f.current)}}),[d,n,t,c,g]),x?(0,p.jsx)(gt.A,{types:k,onDrop:function(e){var t=(0,Je.o_)(n),i=Array.from(e.dataTransfer.types).find((function(e){return k.includes(e)})),r=i&&e.dataTransfer.getData(i),o=r&&r.split("\n")[0],c=(0,Je.o_)(o);if(c&&t)switch(null==a||a(c.toURI()),t.type){case Je.NQ.PLAYLIST:case Je.NQ.PLAYLIST_V2:m((0,pt.io)(n,[c.toURI()]));break;case Je.NQ.COLLECTION:(0,Je._T)(c)||(0,Je.ec)(c)||(0,Je.U_)(c)?b.add({uris:[c.toURI()]}):(0,Je.tb)(c)?h.add([c.toURI()],{before:"start"}):(0,Je.WB)(c)&&b.add({uris:[c.toURI()]});break;case Je.NQ.QUEUE:y.addToQueue([{uri:c.toURI(),uid:null}])}},onDragEnter:function(){v(!0)},onDragLeave:function(){v(!1)},className:l,children:o}):(0,p.jsx)("div",{children:o})},kt=t(8574);function xt(e){var n=e.style,t=e.active,r=e.disabled,o=e.intent,a=e.label,c=e.labelActive,l=e.icon,s=e.iconActive,u=e.className,d=e.onClick,v=(0,i.useState)(!1),f=(0,ae.A)(v,2),g=f[0],m=f[1],b=(0,kt.W)(),h=t&&c?c:a,y=t&&s?s:l;return(0,p.jsx)(X.f,{style:n,className:u,isActive:t,disabled:r,onToggle:function(e){null==d||d(),g||e.target.blur(),m(!1),o&&b({type:"click",intent:o,targetUri:""})},onKeyDown:function(e){"enter"===e.key.toLowerCase()&&m(!0)},label:h,icon:y,testId:"control-button-".concat(o)})}var jt=t(30647),Ct=t(36906),Nt=t(77709),wt=function(){var e=(0,r.d4)(Un.Ht).isAnonymous,n=(0,Ct.d)().videoPlayerMode;return e||"cinema"===n?{isVisible:!1}:{isVisible:!0,isEnabled:!0}},At=function(e){var n=e.onClick,t=wt(),r=t.isEnabled,o=t.isVisible,a=(0,vt.zy)(),c=(0,Nt.J)(),l=(0,vt.Zp)(),u=(0,i.useMemo)((function(){return"/queue"===a.pathname||"/history"===a.pathname}),[a.pathname]),d=(0,i.useCallback)((function(){var e,t=null===(e=c.entries)||void 0===e||null===(e=e.slice(0,c.index+1))||void 0===e||null===(e=e.reverse())||void 0===e?void 0:e.findIndex((function(e){var n=e.pathname;return"/queue"!==n&&"/history"!==n}));n({mode:"main",route:null}),l(-1===t?"/":t>=0?-t:-1)}),[l,c,n]),v=(0,i.useCallback)((function(){n({mode:"main",route:"/queue"}),l("/queue",{state:{referrer:"now_playing_bar"}})}),[n,l]),f=(0,i.useCallback)((function(){r&&(u?d():v())}),[r,u,d,v]);return o?(0,p.jsx)(yt,{uri:"spotify:queue",children:(0,p.jsx)(xt,{intent:"queue",icon:ft.j,label:s.Ru.get("playback-control.queue"),onClick:f,active:u,disabled:!r})}):null},It=cn.$S.QUEUE_BUTTON_CLICK,Pt=function(e){var n=e.onClick,t=wt(),r=t.isEnabled,o=t.isVisible,a=(0,an.Ev)(It),c=(0,an.AI)(ln.Z.Queue,ln.Z.QueueOverlay).isActive,l=(0,jt.R)().toggleQueue,u=(0,i.useCallback)((function(){r&&(n({mode:"panel",aboutToShow:!c}),l())}),[r,n,c,l]);return o?(0,p.jsx)(yt,{uri:"spotify:queue",children:(0,p.jsx)(X.f,{icon:ft.j,label:s.Ru.get("playback-control.queue"),onToggle:u,isActive:c,disabled:!r||!a,testId:"control-button-queue",restoreFocusKey:ln.Z.Queue})}):null},Ot=function(e){var n=e.onClick;return(0,H.NC)(qn.eWj)?(0,p.jsx)(Pt,{onClick:n}):(0,p.jsx)(At,{onClick:n})},St=t(26500),Tt=t(25562),Dt=t(36955),Et=function(e){var n,t=e.onClick,i=(null!==(n=(0,Tt.L)())&&void 0!==n?n:{}).item,r=(0,Dt.D)({item:i,onClick:t}),o=r.isActive,a=r.onClick,c=r.showButton;return i&&c?(0,p.jsx)(X.f,{isActive:o,onToggle:a,label:o?s.Ru.get("miniplayer.close"):s.Ru.get("miniplayer.open"),icon:St.F,testId:"pip-toggle-button"}):null},Rt=t(94849),Bt=t(54294),_t=t(67);const Ft="main-nowPlayingBar-extraControls",Lt="main-nowPlayingBar-lyricsButton",Ut="main-nowPlayingBar-volumeBar";var Mt=function(){var e=(0,H.NC)(qn.yux),n=(0,Ct.d)(),t=n.setVideoPlayerUIFlag,r=n.videoPlayerMode,o=(0,w.r)(z.h9,{data:{identifier:r===Bt.K.cinema?z.gw.CINEMA:z.gw.DESKTOP}}),a=o.spec,c=o.logger,l=o.UBIFragment,s=(0,V.YQ)((function(e){c.logInteraction(a.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),u=(0,i.useCallback)((function(e){e&&t(Bt.n.cinema,!1)}),[t]);return(0,p.jsx)(l,{spec:a,children:(0,p.jsxs)("div",{className:Ft,children:[(0,p.jsx)(_t.mA,{onClick:function(){c.logInteraction(a.djJumpButtonFactory().hitRefreshContent())}}),(0,p.jsx)(dt,{onClick:function(e){e?c.logInteraction(a.npvButtonFactory().hitUiReveal()):c.logInteraction(a.npvButtonFactory().hitUiHide())}}),!e&&(0,p.jsx)($n,{className:Lt,onClick:function(e){e?c.logInteraction(a.lyricsButtonFactory().hitUiNavigate({destination:e})):c.logInteraction(a.lyricsButtonFactory().hitUiNavigateBack())}}),(0,p.jsx)(Ot,{onClick:function(e){"main"===e.mode?e.route?c.logInteraction(a.queueButtonFactory().hitUiNavigate({destination:e.route})):c.logInteraction(a.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?c.logInteraction(a.queueButtonFactory().hitUiReveal()):c.logInteraction(a.queueButtonFactory().hitUiHide())}}),(0,p.jsx)(Mn,{}),(0,p.jsx)(Rt.M,{className:Ut,onVolumeBarClick:function(e){c.logInteraction(a.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:function(e){"muted"===e?c.logInteraction(a.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&c.logInteraction(a.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:s}),(0,p.jsx)(Et,{onClick:u}),(0,p.jsx)(ne,{className:"control-button",disabledClassName:"control-button--disabled",onClick:function(e){e&&c.logInteraction(a.fullscreenButtonFactory().hitUiReveal())}})]})})},Vt=t(12864),Ht=t(41499),zt=t(16920);const Qt="yyrJTUPMeLS8qs1a0YJr";var qt=function(e){var n=e.logoUrl;return n?(0,p.jsx)("div",{className:Qt,"data-testid":"context-ad-logo",children:(0,p.jsx)(Ht.N,{loading:"eager",imgSrc:n,width:56,height:56,type:zt.c.AD})}):null},Kt=t(22399),Zt=t(95873),Yt=t(88306),Wt=function(e){var n=e.item,t=e.context,i=e.index,r=(0,Kt.iz)(n).logoImage;return(0,p.jsx)(Yt.e,{item:n,context:t,index:i,"aria-label":s.Ru.get("ad-formats.advertisement"),adEventReason:Zt.c.AD_LOGO,isVisible:!1,children:(0,p.jsx)(qt,{logoUrl:r})})},Gt=t(39994),Xt=t(78988),Jt=t(99888),$t=i.memo((function(e){var n=e.uri,t=e.className,r=e.onClick,o=e.size,a=void 0===o?Xt.t.xs:o,c=(0,Jt.A)(n),l=(0,ae.A)(c,2),s=l[0],u=l[1],d=(0,kt.W)(),v=(0,i.useCallback)((function(e){e.preventDefault(),d({targetUri:n,intent:s?"remove-from-library":"add-to-library",type:"click"}),r&&r(!s),u(!s)}),[d,n,s,r,u]);return(0,p.jsx)(Xt.M,{className:t,size:a,onClick:v,isAdded:!!s,isAudiobook:!0,condensed:!0})})),ei=t(15317),ni=t(51055),ti=t(86628),ii=function(e){var n=e.uri,t=e.isBook,r=void 0!==t&&t,o=e.size,a=void 0===o?Xt.t.xs:o,c=e.className,l=e.onClick,s=(0,ti.w)({uri:n,isBook:r}),u=s.isPreSaved,d=s.addPresave,v=s.removePresave,f=(0,i.useCallback)((function(){u?v():d(),null==l||l(!u)}),[u,l,v,d]);return(0,p.jsx)(Xt.M,{className:c,size:a,onClick:f,isAdded:!!u,isAudiobook:!0,condensed:!0})},ri=t(43023),oi=t(54129),ai=t(9933),ci=t(95495),li=t(83643),si=t(97432),ui=t(45548),di=t(10942),vi=t(17924),fi=t(39850),pi=t(93892);function gi(e){return(0,pi.v)(e)||(0,fi.p)(e)}var mi=t(8016);const bi="main-nowPlayingWidget-nowPlaying",hi="main-coverSlotCollapsed-navAltContainer",yi="main-nowPlayingWidget-coverArt",ki="main-nowPlayingWidget-trackInfo",xi="HD9s7U5E1RLSWKpXmrqx";var ji=function(e){var n,t=e.onClick,i=(0,Tt.L)(),r=(0,mi.P)(),o=r.draggable,a=r.onDragStart,c=(0,an.AI)(ln.Z.NowPlayingView),l=c.isActive,u=c.panelSend;if(null===i)return null;var d=i.context,v=i.item,f=cn.$S.NPV_BUTTON_CLICK;return(0,p.jsx)(li.h,{menu:(0,p.jsx)(ui.W,{context:d,item:v}),children:(0,p.jsx)("div",{draggable:o&&gi(v),onDragStart:function(e){a(e,{itemUris:[v.uri],dragLabelText:(0,vi.r)(v)})},children:(0,p.jsx)(di.R,{uri:d.uri,owner:null===(n=d.metadata)||void 0===n?void 0:n.context_owner,children:(0,p.jsx)("button",{type:"button","data-testid":"cover-art-button",className:xi,"aria-label":s.Ru.get("web-player.now-playing-view.label"),onClick:function(){u(f),null==t||t(l)},children:(0,p.jsx)(si.b,{item:v,size:56,maxSize:56,className:yi})})})})})},Ci=t(87349),Ni=t(38946),wi=t(17011);const Ai="main-coverSlotCollapsed-container",Ii="main-coverSlotCollapsed-expandButton";var Pi=cn.$S.NPV_BUTTON_CLICK,Oi=function(e){var n=e.children,t=e.className,r=(0,an.Ev)(Pi),o=(0,an.AI)(ln.Z.NowPlayingView).isActive,a=(0,an._Y)(),c=(0,i.useMemo)((function(){return o?{label:s.Ru.get("npb.collapseCoverArt"),Icon:Ni.r}:{label:s.Ru.get("npb.expandCoverArt"),Icon:Ci.o}}),[o]);return(0,p.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:h()(Ai,t),children:[n,(0,p.jsx)(wi.Zp,{label:c.label,children:(0,p.jsx)("button",{className:h()(Ii),disabled:!r,onClick:function(){a(Pi)},"aria-label":s.Ru.get("web-player.now-playing-view.label"),"aria-pressed":o,children:(0,p.jsx)(c.Icon,{iconSize:16})})})]})},Si=t(89016),Ti=t(81588),Di=t(6593);var Ei=t(8514),Ri=t(54688),Bi=t(65476),_i=t(77970),Fi=t(51126),Li=t(64044),Ui=t(76026),Mi=function(e){var n,t,i,r,o,a=e.context,c=e.item,l=e.onLike,s=(0,Bi.X)(),u=(0,oi.v)(c);return s&&(0,Ri.N)(c)?(0,p.jsx)(Ei.o,{contextUri:null!==(n=null===(t=c.metadata)||void 0===t?void 0:t.context_uri)&&void 0!==n?n:a.uri,id:null!==(i=c.uid)&&void 0!==i?i:void 0,uri:c.uri,isActive:!0}):u?(0,p.jsx)(ri.g,{uri:c.uri,condensed:!1}):(0,pi.v)(c)?c.isLocal?null:(0,p.jsx)(ni.b,{uri:c.uri,className:"control-button control-button-heart",onClick:l}):(0,fi.p)(c)?(0,p.jsx)(ei.b,{uri:c.uri,className:"control-button control-button-heart",onClick:l,condensed:!0}):(0,Fi.d)(c)?"trailer"===(null==c||null===(r=c.metadata)||void 0===r?void 0:r.type)&&"true"===(null==c||null===(o=c.metadata)||void 0===o?void 0:o.is_pre_release)?(0,p.jsx)(ii,{uri:c.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:l}):(0,p.jsx)($t,{uri:c.book.uri,className:"control-button control-button-heart",onClick:l}):(0,_i.N)(c)||(0,Li.v)(c)?null:(0,In.d)(c)},Vi=function(e){var n=e.state,t=n.item,r=n.context,o=n.index;!function(e){var n=(0,Di.i)(),t=(0,Ti.X)(e);(0,i.useEffect)((function(){t&&n.say(t)}),[t,n])}(t);var a=(0,Ct.d)(),c=a.videoPlayerMode,l=a.setVideoPlayerUIFlag,s=(0,w.r)(Vt.p6,{data:{identifier:c===Bt.K.cinema?Vt.gw.CINEMA:Vt.gw.DESKTOP}}),u=s.spec,d=s.logger,v=(0,Ti.P)(t),f=(0,H.NC)(qn.WAA),g=(0,Gt.w)(t);(0,i.useEffect)((function(){l(Bt.n.nowPlayingBar,f)}),[f,l]);var m=c===Bt.K.nowPlayingBar&&f;return(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsxs)("div",{"data-testid":"now-playing-widget",className:bi,role:"contentinfo","aria-label":v,children:[g?(0,p.jsx)(Wt,{item:t,context:r,index:o}):(0,p.jsxs)(Oi,{className:hi,children:[!m&&(0,p.jsx)(ji,{onClick:function(e){e?d.logInteraction(u.coverartFactory({uri:t.uri}).hitUiReveal()):d.logInteraction(u.coverartFactory({uri:t.uri}).hitUiHide())}}),f&&(0,p.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,p.jsx)(ai.d,{context:r,className:ki,item:t,size:"xsmall",enableVideoButton:!0,onTitleClick:function(e){d.logInteraction(u.titleFactory({uri:t.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:function(e){d.logInteraction(u.subtitleFactory({uri:t.uri}).hitUiNavigate({destination:e||""}))},referrer:ci.G.NPB}),(0,p.jsx)(Si.a,{context:r,item:t,onClick:function(){d.logInteraction(u.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:r.uri}))}}),(0,p.jsx)(Ui.r,{spec:u,children:(0,p.jsx)(Mi,{item:t,onLike:function(e){d.logInteraction(e?u.likeButtonFactory({uri:t.uri}).hitLike({itemToBeLiked:t.uri}):u.likeButtonFactory({uri:t.uri}).hitRemoveLike({itemNoLongerLiked:t.uri}))},context:r})})]})})},Hi=function(){var e=(0,Tt.L)();return null===e?(0,p.jsx)("div",{className:h()("now-playing")}):(0,p.jsx)(Vi,{state:e})},zi=t(25617),Qi=t(92200);const qi="aguQsGoZR9wZeawKGdDh",Ki="ieqOSqJb6kk3bG5XDOHk";var Zi=function(e){var n=e.paused,t=e.fromSeconds,r=(0,i.useState)(t),o=(0,ae.A)(r,2),a=o[0],c=o[1];return(0,Qi.$)((function(e){c((function(t){return n?t:t>0?t-1:(e(),t)}))}),1e3),(0,p.jsxs)("div",{className:qi,children:[s.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,p.jsx)("span",{className:Ki,children:a})]})},Yi=t(91424),Wi=function(e){var n,t=e.children,i=(0,$.o)((function(e){return e}),(function(e,n){var t,i;return(0,B.a)(null==e?void 0:e.restrictions,null==n?void 0:n.restrictions)&&(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===(null==n||null===(i=n.item)||void 0===i?void 0:i.uri)&&(null==e?void 0:e.isPaused)===(null==n?void 0:n.isPaused)})),o=null==i?void 0:i.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),a=null!==(n=null==i?void 0:i.isPaused)&&void 0!==n&&n,c=(0,Yi.qc)(i),l=(0,Yi.Tv)(i),s=(0,r.d4)((function(e){var n,t;return c?null==e||null===(n=e.ads)||void 0===n||null===(n=n.audio)||void 0===n||null===(n=n.info)||void 0===n?void 0:n.skippableAdDelaySeconds:l?null==e||null===(t=e.ads)||void 0===t||null===(t=t.vto)||void 0===t||null===(t=t.info)||void 0===t?void 0:t.skippableAdDelaySeconds:void 0}));return o&&s?(0,p.jsx)(Zi,{paused:!!a,fromSeconds:s}):(0,p.jsx)(p.Fragment,{children:t})},Gi=t(15374),Xi=t(223),Ji=t(10877),$i=t(63186),er=t(70648),nr=t(78080),tr=t(59400),ir=t(20110),rr=t(81347);const or="player-controls",ar="player-controls__buttons",cr="player-controls__left",lr="player-controls__right";var sr=(0,i.memo)((function(e){var n=e.item,t=n.isPodcastAd;return(0,p.jsxs)("div",{"data-testid":"ad-controls",className:ar,children:[(0,p.jsxs)("div",{className:cr,children:[t&&(0,p.jsx)(rr.w,{}),(0,p.jsx)(Ji.T,{item:n}),t?(0,p.jsx)(er.h,{}):(0,p.jsx)(tr.d,{})]}),(0,p.jsx)($i.x,{}),(0,p.jsxs)("div",{className:lr,children:[t?(0,p.jsx)(nr.v,{}):(0,p.jsx)(Wi,{children:(0,p.jsx)(ir.$,{})}),(0,p.jsx)(Xi.t,{item:n})]})]})})),ur=t(64233),dr=t(58060),vr=t(14910),fr=t(4005),pr=t(8283),gr=t(53724),mr=t(19807),br=(0,i.memo)((function(e){var n=e.isPreview,t=(0,Be.z)(),r=(0,Ct.d)().videoPlayerMode,o=(0,w.r)(zi.kD,{data:{identifier:r===Bt.K.cinema?zi.gw.CINEMA:zi.gw.DESKTOP}}),a=o.spec,c=o.logger,l=(0,$.o)((function(e){var n;return null!==(n=null==e?void 0:e.item)&&void 0!==n?n:void 0}),(function(e,n){return(null==e?void 0:e.uri)===(null==n?void 0:n.uri)})),u=(0,Gt.w)(l),d=(0,vr.p)(),v=(0,i.useCallback)((function(e,n){switch(n){case"drag":return c.logInteraction(a.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return c.logInteraction(a.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,In.k)(n)}}),[c,a]);return(0,p.jsxs)("div",{className:or,"data-testid":"player-controls",dir:"ltr","aria-label":s.Ru.get("playback-control.a11y.landmark-label"),children:[u?(0,p.jsx)(sr,{item:l}):(0,p.jsxs)("div",{className:ar,"data-testid":"general-controls",children:[(0,p.jsxs)("div",{className:cr,children:[d&&(0,p.jsx)(rr.w,{onClick:function(e){var n=t.getState();null!=n&&n.item&&c.logInteraction(a.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:n.item.uri,playbackSpeed:e}))}})," ",!d&&(0,p.jsx)(pr.w,{renderEnabled:function(){return(0,p.jsx)(Ui.r,{spec:a,children:(0,p.jsx)(fr.a,{size:"small"})})},renderDisabled:function(){return(0,p.jsx)(dr.u,{onClick:function(e){c.logInteraction(e?a.shuffleButtonFactory().hitShuffleEnable():a.shuffleButtonFactory().hitShuffleDisable())}})}}),d&&(0,p.jsx)(er.h,{onClick:function(e){c.logInteraction(a.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}}),(0,p.jsx)(tr.d,{onClick:function(){var e,n,i,r=t.getState();r&&c.logInteraction(a.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:(null===(e=r.item)||void 0===e?void 0:e.uri)||"",positionMs:null!==(n=(0,mr.s)(r))&&void 0!==n?n:-1,totalContentMs:null!==(i=r.duration)&&void 0!==i?i:-1}))}})]}),(0,p.jsx)($i.x,{onClick:function(e){var n=t.getState();null!=n&&n.item&&("resume"===e?c.logInteraction(null==a?void 0:a.playPauseButtonFactory().hitResume({itemToBeResumed:n.item.uri})):"pause"===e&&c.logInteraction(null==a?void 0:a.playPauseButtonFactory().hitPause({itemToBePaused:n.item.uri})))}}),(0,p.jsxs)("div",{className:lr,children:[(0,p.jsx)(Wi,{children:(0,p.jsx)(ir.$,{onClick:function(){var e,n,i=t.getState();null!=i&&i.item&&c.logInteraction(a.nextButtonFactory().hitSkipToNext({itemToBeSkipped:i.item.uri,positionMs:null!==(e=(0,mr.s)(i))&&void 0!==e?e:-1,totalContentMs:null!==(n=i.duration)&&void 0!==n?n:-1}))}})}),d&&(0,p.jsx)(nr.v,{onClick:function(e){c.logInteraction(a.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}}),!d&&(0,p.jsx)(ur.s,{onClick:function(e){var n=(0,m.A)((0,m.A)((0,m.A)({},gr.p.REPEAT_NONE,a.repeatButtonFactory().hitRepeatDisable()),gr.p.REPEAT_TRACK,a.repeatButtonFactory().hitRepeatOneEnable()),gr.p.REPEAT_CONTEXT,a.repeatButtonFactory().hitRepeatEnable());c.logInteraction(n[e])}})]})]}),(0,p.jsx)(Gi.x,{isPreview:n,onChange:v})]})})),hr=t(53607),yr=t(496),kr=t(78121),xr=t(75142);const jr="main-nowPlayingBar-container",Cr="main-nowPlayingBar-nowPlayingBar",Nr="MWD1i_CSJ5N9wRBDpZmX",wr="k3NVrHXkbfflNdAxpT1_",Ar="m8UPWsNtWbdkvBNvqgBN",Ir="aepuRyT82biv_XmkH1eS",Pr="main-nowPlayingBar-left",Or="main-nowPlayingBar-center",Sr="main-nowPlayingBar-right";var Tr=function(){var e,n=(0,r.d4)(Un.Ht).isAnonymous,t=(0,r.wA)(),c=(0,kt.W)(),l=(0,$.o)((function(e){return e}),(function(e,n){var t,i;return(null==e?void 0:e.hasContext)===(null==n?void 0:n.hasContext)&&(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===(null==n||null===(i=n.item)||void 0===i?void 0:i.uri)})),s=(0,$.o)((function(e){var n;return(0,_i.N)(null!==(n=null==e?void 0:e.item)&&void 0!==n?n:void 0)})),u=(0,i.useCallback)((function(e){e.stopPropagation(),t((0,a.Ai)()),c({intent:"signup",type:"click"})}),[t,c]),d=function(){return(0,p.jsx)(yr.ql.Provider,{value:"now_playing_bar",children:(0,p.jsxs)("div",{className:n?Nr:Cr,children:[(0,p.jsx)("div",{className:Pr,children:(0,p.jsx)(Hi,{})}),(0,p.jsx)("div",{className:Or,children:(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(br,{isPreview:n})})}),(0,p.jsx)("div",{className:Sr,children:(0,p.jsx)(Mt,{})})]})})};return(0,p.jsx)(xr.P,{surface:kr.u.NOW_PLAYING,children:(0,p.jsx)(hr.pZ,{value:"now-playing-bar",children:(0,p.jsxs)("footer",{className:jr,"data-testid":"now-playing-bar","data-testadtype":"ad-type-".concat(s?"ad":"none"),children:[n?(0,p.jsx)(hr.pZ,{value:"preview-bar",children:(0,p.jsx)(g,{handleClick:u})}):null,n?(0,p.jsx)(o.A,{in:null!==(e=null==l?void 0:l.hasContext)&&void 0!==e&&e,timeout:200,classNames:{enter:wr,enterActive:Ar,enterDone:Ir},children:d()}):d(),(0,p.jsx)(M,{})]})})})}},45613:(e,n,t)=>{t.d(n,{L:()=>a});var i=t(4953),r=t(3099),o=t(85726),a=function(e){var n=(0,r.dY)(),t=(0,o.vh)(),a=n.getInStreamAd();return{logAdFeedback:function(n){var r,o;t.send((0,i.F)({ad_id:e.id,advertiser:e.advertiser,creative_id:(null==a?void 0:a.adId)===e.id?null==a||null===(r=a.metadata)||void 0===r?void 0:r.creative_id:void 0,format:e.mediaType,line_item_id:(null==a?void 0:a.adId)===e.id?null==a||null===(o=a.metadata)||void 0===o?void 0:o.lineitem_id:void 0,event:n}))}}}},86222:(e,n,t)=>{t.d(n,{N2:()=>a,Tt:()=>o});var i=t(42551),r=function(e){return e.ads.adFeedback},o=(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return!(!n||e.adId!==n)&&e.liked})),a=(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return!(!n||e.adId!==n)&&e.disliked}));(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return n&&e.adId===n?e.feedback:null}))},86628:(e,n,t)=>{t.d(n,{w:()=>f});var i=t(62822),r=t(93091),o=t.n(r),a=(t(16347),t(18653),t(30758)),c=t(74002),l=t(92107),s=t(62774),u=t(57261),d=t(5958),v=t(12574),f=function(e){var n=e.uri,t=e.isBook,r=(0,d.p)("prerelease"),f=r.add,p=r.remove,g=(0,u.o)("prerelease",[n]).at(0),m=(0,s.d)().enqueueSnackbar,b=(0,v.r)(c.k,{data:{uri:n}}),h=b.spec,y=b.logger;return{isPreSaved:g,addPresave:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.logInteraction(h.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:n,itemToBePresaved:n,contextUri:n})),e.next=3,f(n);case 3:m(t?l.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):l.Ru.get("web-player.prerelease.album_feedback_presaved"));case 4:case"end":return e.stop()}}),e)}))),[f,m,t,y,h,n]),removePresave:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.logInteraction(h.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:n,itemToBeRemovedFromPresaved:n,contextUri:n})),e.next=3,p(n);case 3:case"end":return e.stop()}}),e)}))),[y,p,h,n])}}},43755:(e,n,t)=>{t.d(n,{s:()=>r,u:()=>i});var i=function(e){return e.ui.lyrics.mode},r=function(e){return e.ui.lyrics.translationLanguage}},59523:(e,n,t)=>{t.d(n,{A:()=>c});var i=t(44286),r=t(51295),o=t(36906),a=t(54294);function c(e){var n=e.referrer,t=e.onChange,c=(0,i.Zp)(),l=(0,r.$)(),s=l.isActive,u=l.routeDestination,d=(0,o.d)().setVideoPlayerUIFlag,v=function(){s||(d(a.n.cinema,!1),c(u,{state:{referrer:n}}),null==t||t(u))},f=function(){s&&(c(-1),null==t||t(null))};return{isActive:s,showLyrics:v,hideLyrics:f,toggleLyrics:function(){s?f():v()}}}},65476:(e,n,t)=>{t.d(n,{X:()=>i.XR});var i=t(76535)},36955:(e,n,t)=>{t.d(n,{D:()=>u});var i=t(30758),r=t(49213),o=(t(60287),t(36906)),a=t(54294),c=t(8574),l=t(70643),s=t(12574),u=function(e){var n=e.item,t=e.onClick,u=(0,c.W)(),d=(0,l.H)(),v=d.capabilities.isEnabled,f=d.isOpen,p=d.close,g=d.open,m=d.canOpen,b=(0,o.d)().videoPlayerMode,h=(0,s.r)(r.h9,{data:{identifier:b===a.K.cinema?r.gw.CINEMA:r.gw.DESKTOP}}),y=h.spec,k=h.logger,x=(0,i.useCallback)((function(){var e;v&&(f?(p(),null!=n&&n.uri&&k.logInteraction(y.pipButtonFactory({uri:n.uri}).hitUiHide()),e="close-picture-in-picture"):(g(),null!=n&&n.uri&&function(e){var n=e.spec,t=e.logger,i=e.uri,r=window.documentPictureInPicture;if(r){var o=function(e){setTimeout((function(){var r,o,a=null===(r=e.window)||void 0===r?void 0:r.innerWidth,c=null===(o=e.window)||void 0===o?void 0:o.innerHeight;if(a&&c){var l=n.pipButtonFactory({uri:i}).hitUiOpenWindow({widthPx:a,heightPx:c});t.logInteraction(l)}}),100),r.removeEventListener("enter",o)};r.addEventListener("enter",o)}}({spec:y,logger:k,uri:n.uri}),e="show-picture-in-picture"),null==t||t(!f,null==n?void 0:n.uri),u({type:"click",intent:e,targetUri:null==n?void 0:n.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[p,v,f,null==n?void 0:n.uri,k,t,u,g,y]);return{showButton:m,isActive:f,onClick:x}}},75146:(e,n,t)=>{t.d(n,{I:()=>p});var i=t(62822),r=t(93091),o=t.n(r),a=t(30758),c=t(75844),l=(t(2823),t(4672),t(82316)),s=function(e,n,t){var i=n.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",t);return e.build().withMethod("POST").withHost(l.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()},u=function(e,n,t){var i=n.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",t);return e.build().withMethod("DELETE").withHost(l.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()},d=t(64869),v=t(45017),f=t(11404),p=function(e){var n=e.uri,t=e.setFeedbackPath,r=e.removeFeedbackPath,l=e.contextUri,p=(0,d.z)(),g=(0,v.m)(),m=(0,f.te)(n).isPlaying,b=(0,a.useCallback)((function(){l&&g.resync(l)}),[l,g]);return{setDislikeFeedback:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,s(c.n.getInstance(),t,n);case 4:b(),m&&p.skipToNext();case 6:case"end":return e.stop()}}),e)}))),[t,n,b,m,p]),removeDislikeFeedback:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u(c.n.getInstance(),r,n);case 4:b();case 5:case"end":return e.stop()}}),e)}))),[r,b,n])}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map