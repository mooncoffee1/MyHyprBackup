"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[448],{13742:(e,r,n)=>{n.d(r,{x:()=>j});n(25550),n(15342);var t=n(30758),i=n(94822),a=n(7852),u=n(99),c=n(51488),s=n(97500),o=n.n(s),l=n(21743);const d="lyrics-lyricsContent-lyric",v="lyrics-lyricsContent-active",f="lyrics-lyricsContent-highlight",p="lyrics-lyricsContent-unsynced",y="lyrics-lyricsContent-isInteractive",h="lyrics-lyricsContent-text",m="Zg6tXwNaAAopLykLK7Cw",b="lyrics-lyricsContent-provider";var g=n(86070),L=t.memo((function(e){var r=e.onObserve,n=e.text,i=e.lineNumber,a=e.activeLineIndex,u=e.isTimeSynced,s=e.translationText,b=e.onClick,L=e.onActiveLineChange,x=e.windowIsVisible,k=(0,l.Wx)({threshold:0}),w=k.ref,A=k.inView,S=(0,t.useRef)(!1);(0,t.useEffect)((function(){S.current||A&&x&&(r(n),S.current=!0)}),[A,r,n,x]);var I=(0,t.useRef)(),T=(0,t.useRef)(!0);(0,t.useEffect)((function(){L(I,T.current),T.current=!1}),[a,L]);var O=(0,t.useCallback)((function(e){w(e),I.current=e||void 0}),[w]);return(0,g.jsxs)("div",{dir:"auto",className:o()(d,(0,c.A)((0,c.A)((0,c.A)((0,c.A)({},y,!!b),v,a===i),f,a>i),p,!u)),"data-testid":"fullscreen-lyric",ref:O,onClick:b,children:[(0,g.jsx)("div",{className:h,children:n}),s&&(0,g.jsx)("div",{className:m,children:s})]})})),x=n(22507),k=n(71523),w=(n(7651),n(83234),n(58795),n(30456),n(40065),n(75380),n(26701),n(37417),n(11737),n(51691),n(702),n(5672),n(43379),n(34192),n(88856),n(4865),n(51565),n(18316),n(38547));function A(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function S(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?A(Object(n),!0).forEach((function(r){(0,c.A)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var I={start:0,end:1,text:""},T=(n(60287),n(27465)),O=n(1131),E=n(18621);var C=n(39370),N=n(56650),j=t.memo((function(e){var r=e.trackUri,n=e.data,c=e.format,s=e.onLineClick,o=e.onActiveLineChange,l=e.isSnippet,d=n.provider,v=n.providerLyricsId,f=n.providerDisplayName,p=n.syncType,y=n.isTimeSynced,h=function(e,r,n){var i,a=(0,t.useRef)(0),u=r.lyrics,c=void 0===u?[]:u,s=r.isTimeSynced,o=r.alternatives,l=(0,t.useRef)(0),d=(0,w.f)(500,(function(r){var n;return(null==r||null===(n=r.item)||void 0===n?void 0:n.uri)===e})),v=(0,k.A)(d,1)[0],f=n?null==o||null===(i=o.find((function(e){return e.language.substring(0,2)===n.substring(0,2)})))||void 0===i?void 0:i.lines:null,p=(0,t.useMemo)((function(){return[].concat((0,x.A)(new Array(2).fill(I)),(0,x.A)(c)).map((function(e,r){return S(S({},e),{},{lineNumber:r,translationText:null==f?void 0:f[r-2]})}))}),[c,f]),y=s?p.findIndex((function(e){var r=e.start,n=e.end;return v>=r&&v<n})):-1,h=l.current;l.current=y;var m=Math.abs(y-h)<=4,b=Math.abs(v-a.current)>2e3;return a.current=v,{lyricWithEmptyLines:p,activeLineIndex:y,prevActiveLineIndex:h,lineIndexDiff:y-h,shouldAnimateScroll:m,hasSkipped:b}}(r,n,(0,i.d4)(C.s)),m=h.lyricWithEmptyLines,A=h.activeLineIndex,j=h.hasSkipped,R=h.shouldAnimateScroll,_=function(e){var r=e.trackUri,n=e.format,i=e.provider,a=e.providerLyricsId,u=e.syncType,c=e.isSnippet,s=(0,t.useState)(!1),o=(0,k.A)(s,2),l=o[0],d=o[1],v=(0,t.useState)(0),f=(0,k.A)(v,2),p=f[0],y=f[1],h=(0,t.useState)(!1),m=(0,k.A)(h,2),b=m[0],g=m[1],L=(0,E.o)((function(e){var r;return null!==(r=null==e?void 0:e.playbackId)&&void 0!==r?r:void 0})),x=(0,t.useMemo)((function(){return(0,T.W)({lyrics_format:n,track_uri:r,provider:i,provider_lyrics_id:a,sync_type:u,playback_id:L,is_snippet:c})}),[n,r,i,a,u,L,c]);(0,t.useEffect)((function(){d(!1),y(0),g(!1);var e=setTimeout((function(){g(!0)}),1500);return function(){clearTimeout(e)}}),[x]);var w=(0,O.vh)();return(0,t.useEffect)((function(){l||p>=140&&b&&(w.send(x),d(!0))}),[p,l,x,w,b]),(0,t.useCallback)((function(e){e.length>1&&y((function(r){return r+e.length}))}),[y])}({trackUri:r,format:c,provider:d,providerLyricsId:v,syncType:p,isSnippet:l}),U=(0,N.g)();return(0,g.jsxs)(g.Fragment,{children:[m.map((function(e){var r=e.text,n=e.lineNumber,t=e.translationText;return(0,g.jsx)(L,{text:r,translationText:t,lineNumber:n,activeLineIndex:A,isTimeSynced:y,onObserve:_,onClick:s&&function(e){return s(e,m[n].start)},onActiveLineChange:function(e,r){return o({lineRef:e,firstUpdate:r,isFirstLine:y&&0===n,isActiveLine:y&&A===n,activeLineIndex:A,hasSkipped:j,shouldAnimateScroll:R})},windowIsVisible:"visible"===U},n)})),!l&&f&&(0,g.jsx)("div",{className:b,children:(0,g.jsx)(a.E,{as:"p",variant:"bodySmall",dir:"auto",children:u.Ru.get("web-player.lyrics.providedBy",f)})})]})}))},23029:(e,r,n)=>{n.d(r,{H:()=>i,k:()=>t});var t=18e5,i=6e5},89648:(e,r,n)=>{n.d(r,{I:()=>w});var t=n(5904),i=n(51488),a=n(64501),u=n.n(a),c=n(44671),s=n(65277),o=n(23029),l=n(92609),d=n(59765),v=(n(25550),n(15342),n(2190)),f=n(89526),p=n(86710),y=n(6843);function h(e,r){return m.apply(this,arguments)}function m(){return m=(0,t.A)(u().mark((function e(r,n){var t,i,a,c,s,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>2&&void 0!==o[2]&&o[2],i=o.length>3?o[3]:void 0,e.prev=2,e.next=5,(0,v.S)(r,n,t,i);case 5:return s=e.sent,e.abrupt("return",{hasLyrics:!0,isTimeSynced:(l=s.lyrics.syncType,"LINE_SYNCED"===l||"SYLLABLE_SYNCED"===l),syncType:s.lyrics.syncType,lyrics:s.lyrics.lines.map(b),colors:(u=s.colors,{text:g(u.text),activeText:g(u.highlightText),background:g(u.background)}),provider:s.lyrics.provider,providerDisplayName:s.lyrics.providerDisplayName,providerLyricsId:s.lyrics.providerLyricsId,hasVocalRemoval:null!==(a=s.hasVocalRemoval)&&void 0!==a&&a,showUpsell:null!==(c=s.lyrics.showUpsell)&&void 0!==c&&c,alternatives:s.lyrics.alternatives});case 9:if(e.prev=9,e.t0=e.catch(2),!(e.t0 instanceof f.O&&404===e.t0.status)){e.next=13;break}return e.abrupt("return",{hasLyrics:!1});case 13:throw e.t0;case 14:case"end":return e.stop()}var u,l}),e,null,[[2,9]])}))),m.apply(this,arguments)}function b(e,r,n){var t=e.startTimeMs,i=e.words,a=n[r+1];return{start:t||0,end:a&&a.startTimeMs?a.startTimeMs:1/0,text:i}}function g(e){return p.Q.fromInt(e).toCSS(y.a.RGB)}var L=n(41527),x=n(35489),k={hasLyrics:!1},w=function(e,r){var n,a,v,f,p=null!==(n=null!==(a=(0,L.h)(r||void 0,{desiredLabel:"large",desiredSize:600}))&&void 0!==a?a:null==r||null===(v=r[0])||void 0===v?void 0:v.url)&&void 0!==n?n:"",y=(0,d.X)(),m=(0,s.NC)(x.Tc,{loadingValue:x.LZ.CONTROL}),b=(0,i.A)((0,i.A)((0,i.A)({},x.LZ.CONTROL,void 0),x.LZ.SYSTEM_LANGUAGE,navigator.language),x.LZ.ALL_LANGUAGES,"all")[m],g=["lyrics",{uri:e,image:p,vocalRemoval:y}],w=(0,l.f)(e),A=w.hasLyrics,S=w.isLoading,I=(0,c.I)({queryKey:g,queryFn:(f=(0,t.A)(u().mark((function r(){var n;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e&&p){r.next=2;break}return r.abrupt("return",k);case 2:return r.next=4,h(e,p,y,b);case 4:return n=r.sent,r.abrupt("return",n);case 6:case"end":return r.stop()}}),r)}))),function(){return f.apply(this,arguments)}),gcTime:o.k,staleTime:o.H,enabled:A}),T=I.data,O=I.isLoading,E=I.isError,C=S||O,N=null;return C||(N=A?null!=T?T:null:k),{data:N,loading:C,error:E}}},92609:(e,r,n)=>{n.d(r,{f:()=>f});var t=n(5904),i=n(64501),a=n.n(i),u=n(44671),c=n(66606),s=n(65277),o=n(2860),l=n(23029),d=n(2190),v=n(49093),f=function(e){var r,n=!!e&&(0,o.U_m)(e),i=(0,s.NC)(v.s6w)&&n,f=(0,u.I)({queryKey:["useLyricsAvailability",e],queryFn:(r=(0,t.A)(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}return r.next=3,(0,d.z)(e);case 3:r.t0=r.sent,r.next=7;break;case 6:r.t0=!1;case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}}),r)}))),function(){return r.apply(this,arguments)}),gcTime:l.k,staleTime:l.H,enabled:i,placeholderData:c.rX}),p=f.data;return{isLoading:f.isLoading,hasLyrics:!!i&&(null!=p&&p)}}},6669:(e,r,n)=>{n.d(r,{J:()=>a});var t=n(89648),i=n(18621),a=function(){var e=(0,i.o)((function(e){return null==e?void 0:e.item}),(function(e,r){return(null==e?void 0:e.uri)===(null==r?void 0:r.uri)}));return(0,t.I)(null==e?void 0:e.uri,null==e?void 0:e.images)}},59765:(e,r,n)=>{n.d(r,{X:()=>u});var t=n(65277),i=n(49093),a=n(20833),u=function(){var e=(0,a.S)().getCapabilities().isSupported;return(0,t.NC)(i.OBX,{loadingValue:!1})&&e}},39370:(e,r,n)=>{n.d(r,{s:()=>i,u:()=>t});var t=function(e){return e.ui.lyrics.mode},i=function(e){return e.ui.lyrics.translationLanguage}},2190:(e,r,n)=>{n.d(r,{S:()=>o,z:()=>l});var t=n(5904),i=n(64501),a=n.n(i),u=(n(83234),n(2860)),c=n(46908),s=n(71007),o=function(){var e=(0,t.A)(a().mark((function e(r,n,t,i){var o,l,d,v,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,u.o_h)(r),l=o.id,d=c.n.getInstance(),v={format:"json",vocalRemoval:t},i&&(v.clientLanguage=i),e.next=7,d.build().withHost(s.Hj).withPath("/track/".concat(encodeURIComponent(l),"/image/").concat(encodeURIComponent(n))).withQueryParameters(v).withEndpointIdentifier("/track/{trackId}").send();case 7:return f=e.sent,e.abrupt("return",f.body);case 9:case"end":return e.stop()}}),e)})));return function(r,n,t,i){return e.apply(this,arguments)}}(),l=function(){var e=(0,t.A)(a().mark((function e(r){var n,t,i,o,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,u.Y8v)(null===(n=(0,u.o_h)(r))||void 0===n?void 0:n.id)){e.next=3;break}return e.abrupt("return",!1);case 3:return o=c.n.getInstance(),e.next=6,o.build().withHost(s.XE).withPath("/track/".concat(encodeURIComponent(i))).withEndpointIdentifier("/track/{trackId}").send();case 6:return l=e.sent,e.abrupt("return",(null===(t=l.body)||void 0===t?void 0:t.has_lyrics)||!1);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},56650:(e,r,n)=>{n.d(r,{g:()=>a});var t=n(71523),i=n(30758);function a(){var e=(0,i.useState)(document.visibilityState),r=(0,t.A)(e,2),n=r[0],a=r[1];return(0,i.useEffect)((function(){var e=function(){return a(document.visibilityState)};return document.addEventListener("visibilitychange",e),function(){return document.removeEventListener("visibilitychange",e)}}),[]),n}},41987:(e,r,n)=>{n.d(r,{f:()=>c,z:()=>u});var t=n(30758),i=n(51646),a=n(11575);function u(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.l0o,n=(0,a.as)();return(0,t.useEffect)((function(){return e&&n((0,a.Mo)(e)),function(){n((0,a.Hf)())}}),[e,n]),e||r}var c=function(e){return u(e.color,e.fallbackColor),null}}}]);
//# sourceMappingURL=448.js.map