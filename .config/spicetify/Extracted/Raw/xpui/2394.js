"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2394],{43678:(e,t,n)=>{n.d(t,{R:()=>a});var r=n(12341),i=n(30758),l=n(57467),a=function(){var e=(0,i.useState)(!1),t=(0,r.A)(e,2),n=t[0],a=t[1],o=(0,l.K)(l.X.CollaborativePlaylists);return(0,i.useEffect)((function(){o&&a(!0)}),[o,a]),{toggleActivationVisible:n,setToggleActivationVisible:a}}},60558:(e,t,n)=>{n.d(t,{u:()=>se,Y:()=>ce});var r=n(12341),i=n(52542),l=(n(7651),n(30456),n(26701),n(78551),n(37417),n(11737),n(51691),n(702),n(5672),n(43379),n(82467),n(34192),n(88856),n(51565),n(18316),n(30758)),a=n(97500),o=n.n(a),u=n(88677),s=n(2648),c=n(75914),f=n(92107),d=n(80021),h=n(17011),b=(n(47994),n(13534)),v=n(780),m=n(35085),g=n(85673),p=n(67963),y=n(2881),S=n(42210),j=n(37718);const O="zNnlcxsmnV1RiWXSd4IA",A="a3sk2brhAAMoZderfRfg";var w=n(86070),F=function(e){var t=e.icon,n=e.name,r=e.isActive,i=e.onClick,l=e.isDsaRestricted,a=r?"textBrightAccent":void 0;return(0,w.jsx)(p.D,{role:"menuitemradio",leadingIcon:(0,w.jsx)(t,{iconSize:16,semanticColor:a}),onClick:i,"aria-checked":r,disabled:l,children:(0,w.jsx)(b.E,{variant:"bodySmall",semanticColor:a,children:n})})},R=function(e){var t=e.shuffleMode,n=e.onClick,r=e.spec,i=e.logger,a=e.isDsaRestricted,o=(0,u.wA)(),c=(0,l.useCallback)((function(){o(y.cI.actions.open())}),[o]),d=(0,l.useCallback)((function(){n(j.j.ON,(function(e){r&&(e?i.logInteraction(null==r?void 0:r.toggleShuffleButtonFactory().hitShuffleDisable()):i.logInteraction(null==r?void 0:r.toggleShuffleButtonFactory().hitShuffleEnable()))}))}),[i,n,r]),h=(0,l.useCallback)((function(){a||n(j.j.SMART_SHUFFLE,(function(e){r&&(e?i.logInteraction(null==r?void 0:r.toggleSmartShuffleButtonFactory().hitSelectShuffleMode({previousMode:"smart_shuffle",selectedMode:"linear"})):i.logInteraction(null==r?void 0:r.toggleSmartShuffleButtonFactory().hitSelectShuffleMode({previousMode:"linear",selectedMode:"smart_shuffle"})))}))}),[a,i,n,r]),p=a?f.Ru.get("web-player.smart-shuffle.dsa-message"):f.Ru.get("web-player.smart-shuffle.menu-text");return(0,w.jsxs)(g.W,{getInitialFocusElement:function(e){return null==e?void 0:e.querySelector('[aria-checked="true"]')},children:[(0,w.jsx)(F,{icon:v.p,name:f.Ru.get("web-player.smart-shuffle.shuffle"),isActive:t===j.j.ON,onClick:d}),(0,w.jsx)(F,{icon:m.k,name:f.Ru.get("web-player.smart-shuffle.smart-shuffle"),isActive:t===j.j.SMART_SHUFFLE,onClick:h,isDsaRestricted:a}),(0,w.jsx)(b.E,{className:O,variant:"bodySmall",semanticColor:"textSubdued",as:"p",children:p}),!a&&(0,w.jsx)(S.u,{children:(0,w.jsx)(s.H,{role:"menuitem",className:A,semanticColor:"textSubdued",onClick:c,size:"small",children:f.Ru.get("web-player.smart-shuffle.menu-button")})})]})},E=(0,i.A)((0,i.A)((0,i.A)({},j.j.OFF,{icon:v.p,label:function(e){return e?f.Ru.get("web-player.smart-shuffle.button-disable-shuffle-specific",e):f.Ru.get("web-player.smart-shuffle.button-disable-shuffle-generic")}}),j.j.ON,{icon:v.p,semanticColor:"textBrightAccent",label:function(e){return e?f.Ru.get("web-player.smart-shuffle.button-enable-shuffle-specific",e):f.Ru.get("web-player.smart-shuffle.button-enable-shuffle-generic")}}),j.j.SMART_SHUFFLE,{icon:m.k,semanticColor:"textBrightAccent",label:function(e){return e?f.Ru.get("web-player.smart-shuffle.button-enable-smart-shuffle-specific",e):f.Ru.get("web-player.smart-shuffle.button-enable-smart-shuffle-generic")}}),D=n(32824),M=n(53902),x=n(7097),C=n(34241);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={bottomEnd:x.dw.topStart,top:x.dw.bottom},T=function(e){var t=e.placement,n=e.onHide,r=e.label;return(0,C.g)(n),(0,w.jsx)("div",{children:(0,w.jsx)(D.A,{arrow:L[t],colorSet:"announcement",onClose:n,children:r})})},B=function(e){var t=e.placement,n=e.visible,r=e.children;return(0,w.jsx)(M.W,{placement:t,withPortal:!0,overlay:n&&(0,w.jsx)(T,P({},e)),children:r})},H=(n(53276),n(28925)),I=n(89923),N=n(23212),U=n(3376);function _(){return(0,U.N)(N.X)}var q=n(14267),z=n(62822),V=(n(60287),n(93091)),K=n.n(V),X=n(11656),Q=n(19417),Z=n(5248),W=n(12110),G=n(11404),Y=n(15057),J=function(e){return["use-shuffle",e,"shuffle-mode"]};var $=function(e){var t=function(e){var t=_(),n=!(0,I.n)(),r=(0,H.I)({queryKey:["use-shuffle",e,"can-smart-shuffle"],queryFn:function(){return t.getAvailableShuffleModes(e)},staleTime:36e5,gcTime:72e5}).data;return n&&(r=[j.j.OFF,j.j.ON]),r}(e),n=function(e){var t,n=_(),i=(0,X.jE)(),a=(0,l.useRef)(null),o=(0,G.l_)(e).isActive,u=(0,Z.o)(W.l),s=(0,Y.d7)(u,1e3),c=(0,r.A)(s,1)[0],f=(0,H.I)({queryKey:J(e),queryFn:(t=(0,z.A)(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getShuffle(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)}),staleTime:0,gcTime:72e5}).data;(0,l.useEffect)((function(){i.invalidateQueries({queryKey:J(e)})}),[e,c,i]);var d=(0,l.useCallback)((function(t){var r=J(e);if(a.current&&clearTimeout(a.current),t!==j.j.SMART_SHUFFLE)return n.setShuffle(e,t);i.setQueryData(r,j.j.SMART_SHUFFLE),a.current=setTimeout((function(){return n.setShuffle(e,t)}),1e3)}),[e,i,n]);return(0,l.useEffect)((function(){var t=n.getEvents(),r=J(e),l=t.addListener(Q.S.UPDATE,(function(t){var n=t.data;n.contextURI===e&&i.setQueryData(r,n.shuffleMode)})),a=t.addListener(Q.S.UPDATE_COMPLETE,(function(t){t.data.contextURI!==e||o||i.invalidateQueries({queryKey:r})})),u=t.addListener(Q.S.UPDATE_ERROR,(function(){i.invalidateQueries({queryKey:r})}));return function(){l(),a(),u()}}),[e,o,c,i,n]),[null!=f?f:j.j.OFF,d]}(e),i=(0,r.A)(n,2),a=i[0],o=i[1],u=(0,q.p)(),s=(0,l.useMemo)((function(){if(t){var e=void 0!==a?t.indexOf(a):-1,n=t[(e+1)%t.length];return u||n!==j.j.SMART_SHUFFLE||(n=t[(e+2)%t.length]),n}}),[a,t,u]),c=(0,l.useCallback)((function(){if(void 0!==s)return o(s),s}),[s,o]);return{shuffleMode:a,nextShuffleMode:s,availableShuffleModes:t,setShuffleMode:o,cycleShuffleMode:c,isDsaRestricted:!u}},ee=n(13459),te=n(62774),ne=n(34300),re=n(70566),ie=n(12574);const le="E1ikFpkPVaoLplbQdrTP",ae="nozebc1PGSbzmePU25qY";function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=function(e){var t=e.label,n=e.shuffleModeConfig,r=e.size,a=void 0===r?"large":r,u=e.onClick,c=e.disabled,f=void 0!==c&&c,d=e.activationVisible,b=void 0!==d&&d,v=e.shuffleIsOn,m=e.focusOnRender,g=void 0!==m&&m,p=e.offsetDotDistance,y=void 0===p||p,S=e.withPadding,j=void 0!==S&&S,O=e.className,A=e.showDelayOnHover,F=(0,l.useRef)(null);return(0,l.useEffect)((function(){var e;g&&(null===(e=F.current)||void 0===e||e.focus())}),[g]),(0,w.jsx)(h.Zp,{label:t,showDelay:A,children:(0,w.jsx)(s.H,{onClick:f?void 0:u,iconOnly:n.icon,semanticColor:n.semanticColor,size:a,"aria-describedby":b?"smartShuffleActivationDescription":void 0,"aria-label":t,"aria-disabled":f,condensedAll:!j,className:o()((0,i.A)((0,i.A)({},le,v),ae,y),O),ref:F})})},ce=function(e){var t,n,i=e.entityName,a=e.contextUri,o=e.activationPlacement,s=e.size,h=e.isActive,b=void 0!==h&&h,v=e.offsetDotDistance,m=void 0===v||v,g=e.withPadding,p=void 0!==g&&g,y=e.disabled,S=void 0!==y&&y,O=e.shuffleContext,A=e.withActivation,F=void 0===A||A,D=e.withSnackbar,M=void 0===D||D,x=e.className,C=e.showDelayOnHover,k=$(a),P=k.shuffleMode,L=k.nextShuffleMode,T=k.availableShuffleModes,H=k.setShuffleMode,I=k.cycleShuffleMode,N=k.isDsaRestricted,U=(0,ie.r)(c.a,{data:{uri:a}}).spec,_=(0,l.useMemo)((function(){return U.menuShuffleButtonFactory()}),[U]),z=(0,re.s)(),V=(0,te.d)().enqueueSnackbar,K=(0,l.useState)(!1),X=(0,r.A)(K,2),Q=X[0],Z=X[1],W=(0,u.d4)((function(e){return e.ui.introducingSmartShuffleModal})).isOpen,G=E[P],Y=void 0!==L?E[L]:void 0,J=null==T?void 0:T.includes(j.j.SMART_SHUFFLE),le=(0,ee.Z)(T,O,F,P),ae=(0,r.A)(le,4),oe=ae[0],ce=ae[1],fe=ae[2],de=ae[3],he=(0,l.useCallback)((function(e){e===j.j.SMART_SHUFFLE?V(b?f.Ru.get("web-player.smart-shuffle.enabled-smart-shuffle"):f.Ru.get("web-player.smart-shuffle.enabled-smart-shuffle-not-active-playlist")):P===j.j.SMART_SHUFFLE&&V(f.Ru.get("web-player.smart-shuffle.disabled-smart-shuffle"))}),[P,V,b]),be=function(){de(!1),ce(!1)},ve=(0,l.useCallback)((function(e){return e===j.j.SMART_SHUFFLE?"smart_shuffle":e===j.j.ON?"shuffle":"linear"}),[]),me=(0,ne.x)("smart-shuffle-menu",0),ge=(0,r.A)(me,2),pe=ge[0],ye=ge[1],Se=(0,q.p)(),je=pe>=3||!J,Oe={label:null!==(t=null==Y||null===(n=Y.label)||void 0===n?void 0:n.call(Y,i,!!J&&Se))&&void 0!==t?t:f.Ru.get("web-player.smart-shuffle.smart-shuffle"),shuffleModeConfig:G,size:s,activationVisible:oe,shuffleIsOn:P!==j.j.OFF,offsetDotDistance:m,withPadding:p,disabled:S,className:x};return je?(0,w.jsx)(B,{visible:fe,onHide:be,placement:o,label:f.Ru.get("web-player.smart-shuffle.activation-text"),children:(0,w.jsx)(se,ue(ue({},Oe),{},{onClick:function(){var e=P,t=I();be(),M&&he(t),J?z.logInteraction(U.regularShuffleButtonFactory().hitSelectShuffleMode({previousMode:ve(e),selectedMode:ve(t)})):z.logInteraction(t===j.j.ON?U.regularShuffleButtonFactory().hitShuffleEnable():U.regularShuffleButtonFactory().hitShuffleDisable())},focusOnRender:Q,showDelayOnHover:C}))}):(0,w.jsx)(B,{visible:oe,onHide:be,placement:o,label:f.Ru.get("web-player.smart-shuffle.activation-message"),children:(0,w.jsx)(d.b,{menu:(0,w.jsx)(R,{shuffleMode:P,onClick:function(e,t){var n=e===P?j.j.OFF:e;H(n),he(n),t(n===j.j.OFF)},spec:_,logger:z,isDsaRestricted:N}),onHide:function(){pe+1===3&&(Z(!0),z.logImpression(U.tristateOnboardingTooltipFactory().impression())),ye(pe+1)},onShow:function(){be(),z.logInteraction(U.menuShuffleButtonFactory().hitUiReveal())},onClickOutside:function(e){W||e()},children:function(e,t){return(0,w.jsx)(se,ue(ue({},Oe),{},{onClick:function(e){t(e)},showDelayOnHover:C}))}})})}},57467:(e,t,n)=>{n.d(t,{X:()=>l.X,K:()=>i});n(79024),n(43379),n(2823),n(97460),n(29426),n(93577),n(54520),n(91531),n(93678),n(34145);var r=n(44286);function i(e){var t=(0,r.zy)().search;return new URLSearchParams(t).get("feature-activation")===e}var l=n(20316)},20316:(e,t,n)=>{n.d(t,{X:()=>r});var r=function(e){return e.SmartShuffle="smart-shuffle",e.GroupSessions="group-sessions",e.Blend="blend",e.CollaborativePlaylists="collaborative-playlists",e.Dj="dj",e.VeryHighQualityAudio="very-high-quality-audio",e.LiveEvents="live-events",e}({})},13459:(e,t,n)=>{n.d(t,{b:()=>s,Z:()=>c});var r=n(12341),i=(n(78551),n(82467),n(30758)),l=n(57467),a=n(43678),o=n(9157),u=n(37718),s={playlistActionBar:"playlist-action-bar"},c=function(e,t,n,c){var f=(0,o.i)(),d=f.seen,h=f.setSeen,b=(0,i.useState)(!d),v=(0,r.A)(b,2),m=v[0],g=v[1],p=(0,i.useState)(!1),y=(0,r.A)(p,2),S=y[0],j=y[1],O=(0,a.R)().toggleActivationVisible,A=(0,l.K)(l.X.SmartShuffle),w=m&&!(null==e||!e.includes(u.j.SMART_SHUFFLE))&&!O&&n;return(0,i.useLayoutEffect)((function(){w&&h(!0),A&&t===s.playlistActionBar&&c===u.j.OFF&&j(!0)}),[w,h,A,t,j,c]),[w,g,S,j]}},76535:(e,t,n)=>{n.d(t,{XR:()=>a});var r=n(93493),i=n(79916),l=function(e){return e[e.DISABLED=0]="DISABLED",e[e.ENABLED=1]="ENABLED",e}({}),a=function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,r.NC)(i.uy,e?void 0:{loadingValue:!1})?l.ENABLED:l.DISABLED}(arguments.length>0&&void 0!==arguments[0]&&arguments[0])===l.ENABLED}},9157:(e,t,n)=>{n.d(t,{i:()=>l});var r=n(12341),i=n(34300),l=function(){var e=(0,i.x)("smart-shuffle-seen",!1),t=(0,r.A)(e,2);return{seen:t[0],setSeen:t[1]}}}}]);
//# sourceMappingURL=2394.js.map