"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9528],{18060:(e,t,i)=>{i.d(t,{o:()=>_});var n=i(51488),r=i(5904),a=i(71523),s=i(64501),o=i.n(s),l=(i(7651),i(30456),i(26701),i(25550),i(47994),i(37417),i(11737),i(51691),i(702),i(5672),i(43379),i(34192),i(88856),i(51565),i(15342),i(18316),i(30758)),c=i(7852),d=i(72300),u=i(72071),p=i(6046),h=i(99),v=i(80080),m=i(10659),f=i(47973),g=i(9434),x=i(36734),y=i(95707),b=i(63130);const j="c5Ml9BbBuUEHjNkcSwZA";var k=i(86070),P="70px",C=function(e){var t=e.adId,i=e.advertiser,n=e.tagline,r=e.displayImage,a=e.buttonMessage,s=e.cardOnClick,o=e.buttonOnClick,l=e.clickthroughUrl;return(0,k.jsx)(b.N,{to:(0,y.H)(l),className:j,"data-testid":"leavebehind",children:(0,k.jsx)(v.v,{onClick:s,onClickHint:h.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:t,size:"xl",title:(0,k.jsx)(m.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:i}),subtitle:(0,k.jsx)(f.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:n}),media:(0,k.jsx)(g.C,{"data-testid":"leavebehind-image",src:r.src,alt:r.alt,imageHeight:P,imageWidth:P,size:"xl"}),trailing:(0,k.jsx)(x.$,{onClick:function(){o&&o()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":h.Ru.get("ad-formats.learnMore"),children:a})})})},w=i(8430),I=i(80267),T=i(19451),E=i(1131);const S="zlUJfROzFEOsEDWL7ucP",A="Fxvq1Fw7XQdGRDvYokRg";function O(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function R(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?O(Object(i),!0).forEach((function(t){(0,n.A)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var _=function(e){var t=e.leavebehinds,i=e.seeAllButton,n=e.surface,s=e.uri,v=(0,E.vh)(),m=(0,T.w)(T.P),f=(0,l.useState)(void 0),g=(0,a.A)(f,2),x=g[0],y=g[1];(0,l.useEffect)((function(){t&&t.length>0&&x!==t[0].requestId&&s&&(t.forEach((function(e,t){var i;e.uri===s&&(null===(i=e.trackingEvents)||void 0===i||i.viewed.forEach(function(){var t=(0,r.A)(o().mark((function t(i){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m(i);case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),r=t.t0,v.send((0,u.G)({error_type:"trackingURLFailure",error_message:r.message,http_error_code:422,surface:(0,w.Fh)(n),request_url:i,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,I.Zl)(n)}));case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()),v.send((0,p.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:"viewed_on_".concat((0,w.Fh)(n).toLowerCase()),surface:(0,w.Fh)(n),surface_position:t+1,uri:s})))})),y(t[0].requestId))}),[v,m,t,s,n,x]);var b=function(e){var t=e.eventReason,i=e.lineitemId,a=e.requestId,l=e.trackingEvents,c=e.surfacePosition;!function(e,t){null==t||t.forEach(function(){var t=(0,r.A)(o().mark((function t(i){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m(i);case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),r=t.t0,v.send((0,u.G)({error_type:"trackingURLFailure",error_message:r.name,http_error_code:422,surface:(0,w.Fh)(n),request_url:i,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,I.Zl)(n)}));case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}())}(i,l),v.send((0,p.x)({leavebehind_lineitem_id:i,leavebehind_request_id:a,event:"event_clicked",event_reason:t,surface:(0,w.Fh)(n),surface_position:c,uri:s}))};return(0,k.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,k.jsxs)("div",{className:A,children:[(0,k.jsx)(c.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,d.po)("tighter"),"data-testid":"leavebehinds-title",children:h.Ru.get("podcast-ads.recent_ads")}),i]}),(0,k.jsx)("div",{className:S,"data-testid":"leavebehinds-list-wrapper",children:t.map((function(e,t){return(0,k.jsx)(C,R(R({},e),{},{buttonOnClick:function(){var i;b({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:null===(i=e.trackingEvents)||void 0===i?void 0:i.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:function(){var i;b({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:null===(i=e.trackingEvents)||void 0===i?void 0:i.clicked,requestId:e.requestId,surfacePosition:t+1})}}),e.adId)}))})]})}},27724:(e,t,i)=>{i.d(t,{J:()=>u});i(83234);var n=i(1201),r=i(84701),a=i(6046),s=i(99),o=i(8430),l=i(80267),c=i(1131),d=i(86070),u=function(e){var t=e.leavebehinds,i=e.surface,u=e.uri,p=e.pathname,h=e.state,v=(0,c.vh)(),m="".concat(s.Ru.get("view.see-all")," (").concat(t.length<=l.E9?s.Ru.formatNumber(t.length):s.Ru.formatNumber(l.E9),")");return(0,d.jsx)(n.N_,{to:p,state:h,children:(0,d.jsx)(r.H,{"data-testid":"leavebehinds-see-all",size:"small",onClick:function(){v.send((0,a.x)({leavebehind_request_id:t[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:(0,o.Fh)(i),uri:u}))},children:m})})}},10903:(e,t,i)=>{i.d(t,{g:()=>g});i(47994);var n=i(30758),r=i(97500),a=i.n(r),s=i(7852),o=i(2860),l=i(59414),c=i(26132),d=i(39342),u=i(98538),p=i(63130),h=i(35605),v=i(68113),m=i(76599),f=i(86070),g=function(e){var t=e.children,i=e.uri,r=e.name,g=e.nonInteractive,x=void 0!==g&&g,y=e.creatorUri,b=e.spec,j=null,k=(0,h.P)({itemUris:[i],dragLabelText:r}),P=k.draggable,C=k.onDragStart,w=(0,v.s)(),I=(0,n.useCallback)((function(){b&&w.logInteraction(b.albumLinkFactory({uri:i}).hitUiNavigate({destination:i}))}),[w,b,i]);return x?(0,f.jsx)("span",{className:a()("standalone-ellipsis-one-line",m.A.text),children:t}):((0,o._Tv)(i)&&(j=(0,f.jsx)(c.h,{uri:i,artistUri:y})),(0,o.WB1)(i)&&(j=(0,f.jsx)(d.H,{uri:i})),(0,f.jsx)(l.h,{menu:j,children:(0,f.jsx)(s.E,{variant:"bodySmall",children:(0,f.jsx)(u.Zp,{label:r,showDelay:u.uF,children:(0,f.jsx)(p.N,{draggable:P,onDragStart:C,className:a()("standalone-ellipsis-one-line"),to:i,dir:"auto",onClick:I,children:t})})})}))}},12573:(e,t,i)=>{i.d(t,{P:()=>n.P});var n=i(89749)},2006:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ji});var n=i(51488),r=i(71523),a=(i(7651),i(14551),i(16347),i(30456),i(26701),i(25550),i(47994),i(37417),i(11737),i(51691),i(702),i(5672),i(43379),i(72636),i(18653),i(34192),i(88856),i(51565),i(15342),i(18316),i(30758)),s=i(1201),o=i(90543),l=i(79509),c=i(52818),d=i(2860),u=i(99),p=i(17781),h=i(74230),v=i(16489),m=i(96974),f=i(19662),g=i(94822),x=i(38546),y=i(32849),b=i(17636),j=i(1958),k=i(76428),P=i(72365),C=i(94910),w=i(10806),I=i(54363),T=i(99116),E=i(68130),S=i(77928),A=i(41888),O=i(81713),R=i(42761),_=i(67124),L=i(15190),D=i(86070),N="activation-trigger-mme",U=function(e){var t=e.episodeUri,i=e.showUri,n=e.isLocked,r=e.isPlaying,a=e.isPlayDisabled,s=e.playButtonPlayLabel,o=e.playButtonPauseLabel,l=e.onClick,c=e.size,u=void 0===c?"large":c,p=(0,L.c)();if((0,_.V)())return(0,D.jsx)(R.R,{size:u,onClick:l,isPlaying:r,disabled:a,locked:n,ariaPlayLabel:s,ariaPauseLabel:o});var h=(0,D.jsx)(O.f,{showUri:i,enabled:n,renderInline:!1,children:(0,D.jsx)(R.R,{size:u,onClick:l,isPlaying:r,disabled:a,locked:n,ariaPlayLabel:s,ariaPauseLabel:o})});return p?(0,D.jsx)(A.k,{id:N,targetURI:(0,d.o_h)(t),fadeOut:!0,children:h}):h};i(2823),i(4672);function F(e){return(null==e?void 0:e.replace(/T.*/,""))||""}var B=i(12573),M=i(22424),q=i(58237),H=i(88273),z=i(38547),K=i(18621),G=i(68113),W=i(57965),Q=i(67527),Y=i(4254);const Z="KY_tGmIGPqs9GPaaPqL1",$="ZDeijYE6qPzPqT9vG_2w",J="qEoBuparvnBwiHsPzwEj",X="azmMKgbEFsGjSUnw2Knc",V="oDljdc6tgUKxTeQMyh0D",ee="eCpSFybAW4xJNfuGDJY3",te="aTeXTpJi_WmakpodeGxX",ie="kZWs1d_TjX2JQgmtx90y",ne="JCSifKpPc54eqcTYBj5Q",re="FlK1APGRiu5DTwm_0kix",ae="ahQLeD18bYXcFRWkL_vg",se="l6peddfW1BiAnd1a_mF3",oe="Xkg0O12dNVwomjL8dzm4",le="OexEjZt7Kf7pFUW701v8",ce="jAY3diSzPfk19oswf8_y",de="F3BJWbXwGSqNOwZHInLz",ue="YjVCpFaOT3LCR64t8jTN",pe="Q7HlO_WHb9N8aK8bgOjG",he="xTENSk0_RmQ8qEeEuhnE";var ve=function(e){var t,i,n,s,o=e.episode,l=e.onPlayEpisode,c=e.isPlaying,d=e.isActive,p=e.isFullyPlayed,h=e.setIsFullyPlayed,v=e.backgroundColor,m=e.isLocked,f=e.spec,A=o.uri,O=o.playedState,R=o.contentRating,_=o.playability,L=(0,G.s)(),N=(0,g.wA)(),Z=(0,z.S)(1e4,(function(e){var t;return(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===A})),$=(0,r.A)(Z,1)[0],J=(0,K.o)((function(e){return null==e?void 0:e.duration})),X=(0,Y.b)({contentRating:null==R?void 0:R.label}).badges,V=(0,a.useCallback)((function(e){!_.playable&&X.nineteen&&(e.stopPropagation(),N((0,y.Tf)(A||"")))}),[A,_.playable,X.nineteen,N]),te=(0,a.useCallback)((function(){var e=f.contextMenuButtonFactory().hitUiReveal();L.logInteraction(e)}),[L,f]),ie=(0,a.useCallback)((function(e,t){(0,q.Qv)(t,f.downloadButtonFactory(),L,A)}),[L,f,A]),ne=(0,S.d$)(),re=(0,W.r)(x.e,{data:{uri:A}}),ae=re.spec,se=re.logger;(0,a.useEffect)((function(){ne&&se.logImpression(ae.impression())}),[ne,se,ae]);var oe=(0,a.useCallback)((function(e){var t=f.saveButtonFactory();L.logInteraction(e?t.hitLike({itemToBeLiked:A}):t.hitRemoveLike({itemNoLongerLiked:A})),e&&ne&&se.logInteraction(ae.hitAddToPlaylist({itemToBeAdded:A,playlist:H.Xn}))}),[L,f,A,ne,se,ae]),le=!m&&!o.playability.playable,ce=u.Ru.get("tracklist.a11y.play",o.name,null===(t=o.podcast)||void 0===t?void 0:t.name),de=u.Ru.get("tracklist.a11y.pause",o.name,null===(i=o.podcast)||void 0===i?void 0:i.name),ue=null===(n=o.podcast)||void 0===n?void 0:n.uri,pe=(0,M.j)(),he=(0,E.v)(o.uri),ve=!m;return(0,D.jsxs)(b.E,{backgroundColor:v,children:[(0,D.jsxs)("div",{className:ee,children:[(0,D.jsx)(B.P,{episode:o}),(0,D.jsx)(Q.j,{fullyPlayed:p,durationMs:d&&J?J:o.duration.milliseconds,releaseDate:F(null===(s=o.releaseDate)||void 0===s?void 0:s.isoString),resumePositionMs:O.playPositionMilliseconds,isPlaying:c,position:d&&$||void 0})]}),(0,D.jsxs)(j.S,{children:[(0,D.jsx)("div",{onClick:V,children:(0,D.jsx)(U,{episodeUri:o.uri,showUri:ue,isLocked:m,onClick:function(){l(O.playPositionMilliseconds)},isPlaying:c,isPlayDisabled:le,playButtonPlayLabel:ce,playButtonPauseLabel:de,size:pe})}),(0,D.jsx)(k.e,{uri:o.uri,onClick:ie,size:pe,canDownload:ve,condensed:!0}),he?(0,D.jsx)(T.g,{uri:o.uri,size:pe}):(0,D.jsx)(C.b,{uri:o.uri,size:pe,onClick:oe,condensed:!0}),(0,D.jsx)(w.b,{onShow:te,menu:(0,D.jsx)(I.b,{uri:o.uri,sharingInfo:o.sharingInfo,showUri:ue,contextUri:o.uri,isPlayed:p,onMarkAsPlayed:h}),children:(0,D.jsx)(P.e,{label:u.Ru.get("more.label.context",o.name),size:pe})})]})]})},me=i(5904),fe=i(64501),ge=i.n(fe),xe=i(86173),ye=(i(70750),i(18060)),be=i(27724),je=i(8430),ke=i(61836),Pe=i(90521),Ce=i(80267),we=i(87449),Ie=i(24462),Te=i(97579),Ee=je.ui.EPISODE_PAGE,Se=function(e){var t=e.leavebehinds,i=e.uri,n=e.seeAllPath,r=(0,a.useMemo)((function(){return t.slice(0,Ce.un)}),[t]);return(0,D.jsx)(ye.o,{leavebehinds:r,surface:Ee,uri:i,seeAllButton:t.length>Ce.un?(0,D.jsx)(be.J,{leavebehinds:t,surface:Ee,uri:i,pathname:n,state:{uri:i}}):null})};function Ae(e){var t,i,n=(0,we.L)(),r=null===(t=(0,d.o_h)(e.uri))||void 0===t?void 0:t.id,s=(0,Pe.c)(r),o=(0,ke.A)({surface:Ee,uri:e.uri}),l=o.data,c=o.error,u=o.getLeavebehinds,p=(i=null==n?void 0:n.item.type,(0,Ie.Z)(i)===Te.c.AD&&i===Te.c.EPISODE);(0,a.useEffect)((function(){u()}),[u]),(0,a.useEffect)((function(){p&&u()}),[p]);var h=(0,a.useMemo)((function(){return l?(0,Ce.iT)(l,e.uri):[]}),[null==l?void 0:l.requestId]);return h.length<1||c?null:(0,D.jsx)(Se,{uri:e.uri,leavebehinds:h,seeAllPath:s})}var Oe=i(42),Re=(i(79210),i(7852)),_e=i(65277),Le=i(83270),De=i(36734),Ne=i(49093),Ue=function(e){var t=e.cardHeaderText,i=e.cardBodyText,n=e.buttonText,r=e.buttonTarget;return(0,_e.NC)(Ne._Nj)?(0,D.jsxs)("div",{className:ne,children:[(0,D.jsxs)("div",{className:re,children:[(0,D.jsx)(Re.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:t}),(0,D.jsx)(Re.E,{semanticColor:"textBase",children:i})]}),(0,D.jsx)(De.$,{size:"small",colorSet:"invertedLight",href:(0,d.o_h)(r).toURLPath(!0),component:Oe.v,children:n})]}):null},Fe=function(e){var t=e.areHTMLDescriptionsEnabled,i=e.contentInformation,n=e.description,r=e.hasDescription,s=e.htmlDescription,o=e.onExpanded,l=e.onTimeStampClick,c=e.playability,d=e.showHeader,p=void 0===d||d,h=e.spec,v=(0,G.s)(),m=(r||i)&&p,f=(0,a.useCallback)((function(e){var t=h.readMoreButtonFactory();v.logInteraction(e?t.hitUiReveal():t.hitUiHide()),null==o||o()}),[h,v,o]),g=(0,_e.NC)(Ne.ZK8,{loadingValue:!1});return(0,D.jsxs)(D.Fragment,{children:[m&&(0,D.jsx)(Re.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",className:X,children:u.Ru.get("episode.description-title")}),i&&(0,D.jsx)(Ue,{cardHeaderText:i.cardHeaderText,cardBodyText:i.cardBodyText,buttonText:i.buttonText,buttonTarget:i.buttonTarget}),r&&(0,D.jsx)(Le.N,{className:J,onTimeStampClick:l,maxLines:4,onExpanded:f,content:(n||"").trim(),htmlContent:t&&s?s:void 0,enableTimestamps:c.playable,enableAutomaticLinkification:g&&t&&!!s})]})},Be=i(97500),Me=i.n(Be),qe=i(21743),He=i(7955),ze=i(90555),Ke=i(75406),Ge=i(81001),We=i(99299),Qe=function(e){return e.DESCRIPTION="description",e.TRANSCRIPT="transcript",e}(Qe||{}),Ye=a.memo((function(e){var t=e.transcriptSections,i=e.descriptionContent,s=e.transcriptContent,o=e.spec,l=(0,G.s)(),c=(0,a.useState)(Qe.DESCRIPTION),d=(0,r.A)(c,2),p=d[0],h=d[1],v=(0,We.v7)(),m=(0,qe.Wx)({threshold:[1],root:v.current,rootMargin:"-".concat(Ge.uC+1,"px 100000px 0px 100000px")}),f=m.ref,g=m.inView,x=(0,a.useRef)(null),y=(0,a.useCallback)((function(e){x.current=e,f(e)}),[f]);return(0,a.useEffect)((function(){var e,t=null===(e=x.current)||void 0===e||null===(e=e.parentElement)||void 0===e?void 0:e.offsetTop,i=null==v?void 0:v.current;if(t&&i){var n=t-Ge.uC;i.scrollTop>n&&i.scrollTo({top:n})}}),[v,p]),(0,D.jsx)(He.j,{list:(0,D.jsxs)(ze.L,{className:Me()(ue,(0,n.A)({},pe,!g)),ref:y,children:[(0,D.jsx)(Ke.Y,{label:u.Ru.get("web-player.episode.description"),sentenceCase:!0,active:p===Qe.DESCRIPTION,onClick:function(){var e=o.tabsFactory().descriptionTabButtonFactory().hitUiReveal();l.logInteraction(e),h(Qe.DESCRIPTION)},className:Me()(he,(0,n.A)({},ae,p===Qe.DESCRIPTION))}),(0,D.jsx)(Ke.Y,{label:u.Ru.get("web-player.episode.transcript"),sentenceCase:!0,disabled:null===t,active:p===Qe.TRANSCRIPT,onClick:function(){var e=o.tabsFactory().transcriptTabButtonFactory().hitUiReveal();l.logInteraction(e),h(Qe.TRANSCRIPT)},className:Me()(he,(0,n.A)({},ae,p===Qe.TRANSCRIPT))})]}),children:null===t||p===Qe.DESCRIPTION?i:s})})),Ze=i(52699),$e=i(74484),Je=i(41527),Xe=(0,a.memo)((function(e){var t=e.transcriptSections,i=e.onTimeStampClick,n=e.episodeUri,r=(0,W.r)(Ze.c,{data:{uri:n}}),a=r.spec,s=r.logger,o=(0,$e.P)({uri:n},{featureIdentifier:"episode"}).isPlaying,l=a.timestampLinkFactory();return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:oe,children:(0,D.jsx)(Re.E,{variant:"bodySmall",semanticColor:"textBase",children:u.Ru.get("web-player.episode.transcript.disclaimer")})}),t.map((function(e,t){var r="transcript-section-".concat(t);return(0,D.jsxs)("div",{className:se,children:[(0,D.jsx)("button",{className:le,onClick:function(){i(e.startMs,r),s.logInteraction(o?l.hitSeekToTime({msToSeekTo:e.startMs}):l.hitPlay({itemToBePlayed:n}))},children:(0,D.jsx)(A.k,{id:r,targetURI:(0,d.o_h)(n),fadeOut:!0,children:(0,D.jsx)(Re.E,{variant:"marginalBold",semanticColor:"textSubdued",className:ce,children:(0,Je.f)(e.startMs)})})}),e.content.map((function(e,t){return(0,D.jsx)(Re.E,{variant:"bodySmall",semanticColor:"textBase",className:de,dir:"auto",children:e},"transcript-text-".concat(t))}))]},r)}))]})})),Ve=(i(83234),i(38408),i(80456),i(29083)),et=i(4819),tt=i(84850),it=i(10903),nt=i(52999),rt=i(41065),at=i(30383),st=i(25751),ot=i(40055),lt=i(76783),ct=i(34567),dt=i(80795),ut=i(9685),pt=(i(78551),i(15057)),ht=i(40521),vt=i(76070),mt=i(33786),ft=i(75739),gt=i(76599),xt=function(e){var t=e.children,i=e.index,r=e.ariaRowIndex,s=e.onTriggerPlay,o=e.isActive,l=e.uri,c=e.spec,d=(0,G.s)(),u=(0,a.useContext)(vt.m),p=u.pushPopSelected,h=u.toggleSelected,v=u.isSelected,m=(0,a.useRef)(null),f=(0,mt.W)(),g=(0,pt.YQ)((function(e){f({intent:"play",type:"double-click"});var t=d.logInteraction(c.doubleHitPlay({itemToBePlayed:l}));s(e,t)}),ft.d,{leading:!0,trailing:!1}),x=(0,a.useCallback)((function(e){h(i,e.shiftKey,e.ctrlKey||e.metaKey)}),[h,i]),y=(0,a.useCallback)((function(e){var t;if(null!==(t=m.current)&&void 0!==t&&t.contains(e.target)){var n="ArrowUp"===e.key?-1:1;["ArrowUp","ArrowDown"].includes(e.key)&&(e.shiftKey?p(i,n):h(i+n,!1,!1))}}),[p,h,i]),b=v(i),j=b&&v(i-1),k=b&&v(i+1);return(0,D.jsx)(ht.$,{rowIndex:r,"aria-selected":b,children:(0,D.jsx)("div",{"data-testid":"tracklist-row",className:Me()(gt.A.trackListRow,gt.A.trackListRowGrid,(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},gt.A.active,o),gt.A.selected,b),gt.A.isPreviousRowSelected,j),gt.A.isNextRowSelected,k)),onDoubleClick:g,onClick:x,onKeyDown:y,ref:m,children:t})})},yt=i(70359),bt=i(14816),jt=function(e){var t=e.uri,i=e.title,n=void 0===i?"":i,r=e.index,s=e.subtitle,o=void 0===s?"":s,l=e.showName,c=void 0===l?"":l,d=e.showUri,p=void 0===d?"":d,h=e.duration,v=void 0===h?0:h,m=e.start,f=e.stop,g=(0,yt.L)({episodeUri:t,start:m,stop:f}),x=g.isActive,y=g.isPlaying,b=g.onClick,j=(0,a.useCallback)((function(e,t){b(t)}),[b]),k=(0,W.r)(tt.i,{data:{position:r,reason:"",uri:t}}).spec;return(0,D.jsx)(bt.pZ,{value:"row",index:r,children:(0,D.jsxs)(xt,{index:r,ariaRowIndex:r+1,onTriggerPlay:j,isActive:x,spec:k,uri:t,children:[(0,D.jsxs)(lt.U,{ariaColIndex:0,children:[(0,D.jsx)(at.$,{uri:t,playAriaLabel:u.Ru.get("tracklist.a11y.play",o,c),onClick:j,isPlaying:y,isActive:x,spec:k,children:(0,D.jsx)(st.a,{children:(0,D.jsx)(et.M,{className:gt.A.talkIcon,"aria-hidden":!0})})}),(0,D.jsxs)(rt.l,{children:[(0,D.jsx)(ut.p,{titleText:n,children:n}),(0,D.jsx)(dt.p,{children:o})]})]}),(0,D.jsx)(ct.o,{ariaColIndex:1,children:(0,D.jsx)(it.g,{uri:p,name:c,spec:k,children:(0,D.jsx)("span",{dir:"auto",children:c})})}),(0,D.jsx)(ot.l,{ariaColIndex:2,children:(0,D.jsx)(nt.P,{duration:v,className:gt.A.talkSegmentDuration})})]})})},kt=i(97608),Pt=i(57674),Ct=i(48824),wt=i(80553),It=i(51393),Tt=i(30651),Et=i(7446),St=i(71049);const At="HRApv65revEcL42QzRjJ",Ot="HbJqPqSmOY5H3lLnQVzD",Rt="DBcCnhHVt7coNqp3wMB4";var _t=function(e){var t,i=e.episodeUri,n=e.index,r=e.duration,s=e.start,o=e.stop,l=e.name,c=e.uri,d=e.artists,p=e.album,h=e.playable,v=(0,yt.L)({episodeUri:i,start:s,stop:o}),m=v.isActive,f=v.isPlaying,g=v.onClick,x=(0,a.useCallback)((function(e,t){g(t)}),[g]),y=(0,W.r)(tt.i,{data:{position:n,reason:"",uri:c}}).spec;return(0,D.jsx)(bt.pZ,{value:"row",index:n,children:(0,D.jsx)(Ct.t,{trigger:"right-click",action:"open",menu:(0,D.jsx)(wt.P,{uri:c}),children:(0,D.jsxs)(Et.w,{uri:c,index:n,ariaRowIndex:n+1,dragMetadata:{name:l,createdBy:null!==(t=null==d?void 0:d[0].name)&&void 0!==t?t:""},onTriggerPlay:x,isActive:m,isPlayable:h,spec:y,children:[(0,D.jsxs)(lt.U,{ariaColIndex:0,children:[(0,D.jsx)(at.$,{uri:c,playAriaLabel:u.Ru.get("tracklist.a11y.play",l,null==d?void 0:d[0].name),onClick:x,isPlaying:f,isActive:m,spec:y,children:(0,D.jsx)(st.a,{children:(0,D.jsx)("img",{className:Ot,src:p.image,alt:p.name})})}),(0,D.jsxs)(rt.l,{children:[(0,D.jsx)(ut.p,{titleText:l,children:l}),(0,D.jsx)(dt.p,{children:(0,D.jsx)(It.l,{artists:d,spec:y})})]})]}),(0,D.jsx)(ct.o,{ariaColIndex:1,children:(0,D.jsx)(it.g,{uri:p.uri,name:p.name,spec:y,children:p.name})}),(0,D.jsxs)(ot.l,{ariaColIndex:2,children:[(0,D.jsx)(St.d,{uri:c,spec:y}),(0,D.jsx)(nt.P,{duration:r}),(0,D.jsx)(Tt.Y,{spec:y,menu:(0,D.jsx)(wt.P,{uri:c,artists:d}),label:u.Ru.get("more.label.track",l,null==d?void 0:d[0].name)})]})]})})})},Lt=i(28002),Dt=i(89907);function Nt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ut(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(i),!0).forEach((function(t){(0,n.A)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Nt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ft(e,t,i){return e.reduce((function(e,n,r){return(r>0||t>0)&&e.push({type:"SPACER",id:"spacer-".concat(e.length)}),"MUSIC"===n.type?e.push(function(e,t,i){return{type:"MUSIC",index:t,uri:i.uri,episodeUri:e,start:i.start,stop:i.stop,duration:i.duration,name:i.track.name,artists:i.track.artists,album:i.track.album,playable:i.track.playable}}(i,r,n)):"TALK"===n.type&&e.push(function(e,t,i){return{type:"TALK",index:t,uri:e,title:i.title,subtitle:i.subtitle,start:i.start,stop:i.stop,duration:i.duration,showUri:i.show.uri,showName:i.show.name}}(i,r,n)),e}),[])}const Bt=function(e){var t=e.uri,i=e.segmentCount,n=(0,Lt.o)(),r=(0,a.useCallback)(function(){var e=(0,me.A)(ge().mark((function e(r,a){var s,o;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.ceil(r/2),e.prev=1,e.next=4,n.getSegments(t,s,a);case 4:return o=e.sent,e.abrupt("return",{items:Ft(o,s,t),totalLength:2*i-1});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{items:[],totalLength:0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,i){return e.apply(this,arguments)}}(),[i,n,t]),s=(0,a.useCallback)((function(e){switch(e.type){case"SPACER":return(0,D.jsx)("div",{className:Rt},e.id);case"MUSIC":return(0,D.jsx)(_t,Ut({},e),"".concat(t,"-").concat(e.index));case"TALK":return(0,D.jsx)(jt,Ut({},e),"".concat(t,"-").concat(e.index));default:return(0,Dt.d)(e)}}),[t]),o=(0,a.useCallback)((function(e){return{uri:"MUSIC"===e.type?e.uri:""}}),[]),l=u.Ru.get("music_and_talk.in_this_episode");return(0,D.jsxs)("div",{children:[(0,D.jsx)(Re.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",className:At,children:l}),(0,D.jsx)(kt.S4,{ariaLabel:l,hasHeaderRow:!0,rowPlaceholder:Ve.qq,columns:[Pt.$.TITLE_AND_ARTIST,Pt.$.ALBUM_OR_SHOW,Pt.$.DURATION],renderRow:s,fetchTracks:r,resolveItem:o,limit:50,nrTracks:2*i-1,testID:"music-and-talk-tracklist"})]})};var Mt=i(10134),qt=i(84959),Ht=function(e){var t=e.areHTMLDescriptionsEnabled,i=e.contentInformation,n=e.description,s=e.hasDescription,o=e.hasMusicAndTalkSegments,l=e.htmlDescription,c=e.onExpanded,d=e.onDescriptionTimestampClick,p=e.onTranscriptTimestampClick,h=e.playability,v=e.segmentCount,m=e.showUrl,f=e.transcript,g=e.uri,x=e.spec,y=(0,G.s)(),b=(0,a.useMemo)((function(){return x.descriptionSectionFactory()}),[x]),j=(0,a.useMemo)((function(){return b.trackListFactory()}),[b]),k=(0,a.useState)(null),P=(0,r.A)(k,2),C=P[0],w=P[1],I=(0,a.useCallback)(function(){var e=(0,me.A)(ge().mark((function e(t){var i;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Mt.Q)(t);case 2:i=e.sent,w(i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);(0,a.useEffect)((function(){f&&f.length>0&&I(f[0].cdnUrl)}),[I,f]);var T=function(e){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Fe,{hasDescription:s,contentInformation:i,onTimeStampClick:d,onExpanded:c,description:n,areHTMLDescriptionsEnabled:t,htmlDescription:l,playability:h,showHeader:e,spec:b}),o&&(0,D.jsx)(qt.r,{spec:j,children:(0,D.jsx)(Bt,{segmentCount:v,uri:g})}),m&&(0,D.jsx)(xe.n,{size:"small",className:V,href:m,component:Oe.v,onClick:function(){y.logInteraction(b.allEpisodesLinkFactory().hitUiNavigate({destination:m}))},children:u.Ru.get("episode.see_all_episodes")}),(0,D.jsx)(Ae,{uri:g})]})},E=f&&(null==f?void 0:f.length)>0&&h.playable;return(0,D.jsx)(D.Fragment,{children:E?(0,D.jsx)(Ye,{transcriptSections:C,descriptionContent:T(!1),transcriptContent:(0,D.jsx)(Xe,{transcriptSections:C||[],onTimeStampClick:p,episodeUri:g}),spec:x}):T(!0)})},zt=(i(42703),i(463),i(59414)),Kt=i(65082),Gt=i(72138),Wt=i(55431),Qt=i(74078),Yt=i(27550),Zt=i(91010),$t=i(77238),Jt=i(70859),Xt=i(23294),Vt=i(63130),ei=i(9462),ti=i(75599),ii=i(22872),ni=i(47832),ri=i(56122),ai=function(e){var t=e.coverArt,i=e.name,n=(0,ri.y)(),r=n===ni.E.SMALL||n===ni.E.XSMALL;return(0,D.jsx)(ti.b,{images:t,type:Te.c.EPISODE,shape:ti.u.ROUNDED_CORNERS,title:i,size:r?ii.Qe.SIZE_20:ii.Qe.SIZE_24,className:te})},si=i(70525);var oi=function(e){var t,i,n,r=e.episode,s=e.isFullyPlayed,o=e.setIsFullyPlayed,l=e.backgroundColor,c=e.spec,p=r.uri,h=r.name,v=r.sharingInfo,m=r.playedState,f=r.episodeType,g=r.releaseDate,x=r.coverArt,y=(0,G.s)(),b=function(e,t,i,n,r){var a=t===si.I_.Episode;return(0,ei.hD)(e,n,i,r)?(0,D.jsx)(ei.Ih,{isMusicAndTalk:a}):a?u.Ru.get("type.showEpisode"):u.Ru.get("type.podcastEpisode")}(p,f||si.I_.Unknown,m.playPositionMilliseconds,F(null==g?void 0:g.isoString),m.state===si._w.Completed),j=null===(t=r.podcast)||void 0===t?void 0:t.uri,k=function(e){var t=(0,d.o_h)(e),i=(0,d.cEw)((null==t?void 0:t.id)||"");return"/show/".concat(i)}(j),P=(0,a.useCallback)((function(){y.logInteraction(c.podcastLinkFactory().hitUiNavigate({destination:k}))}),[y,k,c]),C=null===(i=r.podcast)||void 0===i?void 0:i.coverArt,w=!!(C&&C.length===x.length&&x.every((function(e,t){return e.url===C[t].url}))),T=(0,D.jsx)(I.b,{uri:p,sharingInfo:v,showUri:j,contextUri:p,isPlayed:s,onMarkAsPlayed:o});return(0,D.jsxs)(Kt.z,{backgroundColor:l,children:[(0,D.jsx)(Qt.h,{children:(0,D.jsx)(zt.h,{menu:T,children:(0,D.jsx)(Yt.X,{text:h,dragUri:p,dragLabel:h})})}),!w&&(0,D.jsx)(Gt.X,{children:(0,D.jsx)(zt.h,{menu:T,children:(0,D.jsx)(Zt.b,{loading:"eager",name:h,images:x,placeholderType:"episode",shape:Zt.u.SQUARE})})}),(0,D.jsxs)(Wt.Y,{children:[(0,D.jsx)($t.B,{children:b}),(0,D.jsx)(zt.h,{menu:T,children:(0,D.jsx)(Xt.mm,{dragUri:p,dragLabel:h,scaleAtMinWidth:Xt.tw,className:$,children:(0,D.jsx)("span",{"data-testid":"episodeTitle",children:h})})}),(0,D.jsx)(zt.h,{menu:T,children:(0,D.jsxs)(Vt.N,{to:k,onClick:P,className:ie,children:[w&&(0,D.jsx)(ai,{name:h,coverArt:x}),(0,D.jsx)(Jt.g,{children:(0,D.jsx)("span",{"data-testid":"showTitle",children:null===(n=r.podcast)||void 0===n?void 0:n.name})})]})})]})]})},li=i(29213),ci=i(64926),di=i(96254),ui=i(40494),pi=i(30021),hi=i(3105),vi=i(64654),mi=i(34871),fi=i(11776),gi=i(41511),xi=i(86634);function yi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var bi=function(e){var t,i,o,c,u,m,g=e.episode,x=g.uri,y=g.episodeType,b=g.description,j=g.htmlDescription,k=g.podcastSubscription,P=g.segmentsCount,C=g.podcast,w=g.contentInformation,I=g.playedState,T=g.coverArt,E=(0,W.r)(l.g,{data:{uri:x}}),S=E.spec,A=E.logger,O=(0,ui.n)(),R=(0,a.useMemo)((function(){return S.headerFactory()}),[S]),U=(0,a.useMemo)((function(){return S.actionBarFactory()}),[S]),F=(0,a.useState)(I.state===si._w.Completed),B=(0,r.A)(F,2),M=B[0],q=B[1],H=(0,vi.z)(),z=(0,mt.W)(),G=void 0!==P&&P>0,Q=(0,_.V)(),Y=(0,$e.P)(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(i),!0).forEach((function(t){(0,n.A)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({uri:x},O?{}:{pages:[{items:[{type:Te.c.EPISODE,uri:x,uid:null,provider:null}]}]}),{featureIdentifier:"episode"}),$=Y.triggerPlay,J=Y.togglePlay,X=Y.isActive,V=(0,mi.te)(x),ee=V.isActive,te=V.isPlaying,ie=null===(t=T.at(0))||void 0===t?void 0:t.url,ne=(0,hi.H)(ie||null),re=(0,K.o)((function(e){var t;return null!==(t=null==e?void 0:e.isPaused)&&void 0!==t?t:void 0})),ae=(0,L.c)(),se=k.isPaywalled&&!k.isUserSubscribed,oe=ee||X,le=g?{name:g.name,uri:g.uri,mediaTypes:g.mediaTypes,audio:{items:g.audio.items.map((function(e){return{url:e.url}}))}}:null,ce=C?{name:C.name,uri:C.uri,trailer:C.trailer,showTypes:C.showTypes}:null,de=(0,pi.C)(le,ce),ue=(0,a.useCallback)((function(e,t,i,n){var r=function(){re?(null==n||n("resume"),H.resume()):(null==n||n("pause"),H.pause())};if(!se){var a="play";if(!te||0!==e&&t||(a="pause"),z({intent:a,targetUri:x,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),y===si.I_.Episode&&ae)h.h.set((function(){return{triggerId:i||N,triggerAction:null}}));else if(X&&!t)Q?r():J({loggingParams:null==n?void 0:n()});else if(ee&&!t)r();else{var s=null==n?void 0:n("play");Q?de({seekTo:e,loggingParams:s}):$({seekTo:e,loggingParams:s})}}}),[se,te,z,x,y,ae,ee,X,Q,re,H,J,de,$]),pe=(0,a.useCallback)((function(e){ue(e,!1,void 0,(function(e){var t,i=S.actionBarFactory().playButtonFactory();return t="pause"===e||te?i.hitPause({itemToBePaused:x}):"resume"===e||oe?i.hitResume({itemToBeResumed:x}):i.hitPlay({itemToBePlayed:x}),A.logInteraction(t)}))}),[ue,oe,te,A,S,x]),he=(0,a.useCallback)((function(e){ue(e,!0,void 0,(function(){return A.logInteraction(S.descriptionSectionFactory().timestampLinkFactory().hitPlay({itemToBePlayed:x}))}))}),[ue,A,S,x]),me=(0,a.useCallback)((function(e,t){ue(e,!0,t)}),[ue]),fe=(0,a.useCallback)((function(){z({intent:"expand-description",type:"click"})}),[z]),ge=(0,s.ok)(),xe=(0,r.A)(ge,2),ye=xe[0],be=xe[1];(0,a.useEffect)((function(){if(g&&!oe&&ye.has("t")){var e=ye.get("t")||"0",t=1e3*parseInt(e,10);t<=g.duration.milliseconds&&(ye.delete("t"),be(ye,{replace:!0}),ue(t,!0))}}),[g,ue,oe,ye,be]);var je=!!b||!!j,ke=null===(i=g.podcast)||void 0===i?void 0:i.uri,Pe=null===(o=(0,d.o_h)(ke))||void 0===o?void 0:o.toURLPath(!0);return(0,D.jsxs)("section",{"data-testid":"episode",className:Z,children:[(0,D.jsx)(p.Q,{children:(0,xi.L$)({episodeOrChapterName:g.name,showOrAudiobookName:null!==(c=null===(u=g.podcast)||void 0===u?void 0:u.name)&&void 0!==c?c:"",type:"Podcast"})}),(0,D.jsx)(f.c,{artistOrShow:null===(m=g.podcast)||void 0===m?void 0:m.name,title:g.name,uri:x,entityType:f.p.EPISODE}),(0,D.jsx)(oi,{episode:g,isFullyPlayed:M,setIsFullyPlayed:q,backgroundColor:ne,spec:R}),(0,D.jsx)(ve,{episode:g,onPlayEpisode:pe,isPlaying:te,isActive:oe,isFullyPlayed:M,setIsFullyPlayed:q,backgroundColor:ne,isLocked:se,spec:U}),(0,D.jsxs)("div",{className:"contentSpacing",children:[(0,D.jsx)(li.q,{gatedEntityRelations:g.gatedEntityRelations,upsellExplanation:g.upsellExplanation,hasAccess:g.hasGatedEntityRelationAccess}),(0,D.jsx)(Ht,{transcript:g.transcript,hasDescription:je,contentInformation:w,onDescriptionTimestampClick:he,onTranscriptTimestampClick:me,onExpanded:fe,description:g.description,areHTMLDescriptionsEnabled:!0,htmlDescription:g.htmlDescription,playability:g.playability,hasMusicAndTalkSegments:G,segmentCount:P,uri:g.uri,showUrl:Pe,spec:S}),ae&&(0,D.jsx)(v.W,{uri:x})]})]})};const ji=a.memo((function(){var e,t=(0,o.g)().episodeId,i=void 0===t?"":t,n=(0,d.iMK)(i).toURI(),r=(0,fi.d)(n);return null!=r&&r.isError||null==r||!r.episodeOrChapter?(0,D.jsx)(m.LoadingPage,{hasError:(null==r?void 0:r.isError)||!1,errorMessage:u.Ru.get("error.not_found.title.podcast")}):(0,gi.Gr)(r.episodeOrChapter)?(0,D.jsx)(ci.$,{to:(0,d.o_h)(null===(e=r.episodeOrChapter.book)||void 0===e?void 0:e.uri).toURLPath(!0)}):(0,D.jsx)(a.Suspense,{fallback:null,children:(0,D.jsx)(di.u,{pageId:c.$h.PODCAST_EPISODE,uri:n,children:(0,D.jsx)(bi,{episode:r.episodeOrChapter})})})}))}}]);
//# sourceMappingURL=xpui-routes-episode.js.map