"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{61095:(e,n,t)=>{t.d(n,{n:()=>d});var i=t(51488),r=t(48),o=(t(7651),t(83234),t(30456),t(26701),t(37417),t(11737),t(51691),t(702),t(5672),t(43379),t(34192),t(88856),t(51565),t(18316),t(84701)),a=t(98538),c=t(86070),l=["icon","activeIcon","label","isActive"];function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var d=function(e){var n=e.icon,t=e.activeIcon,i=e.label,s=e.isActive,d=(0,r.A)(e,l);return(0,c.jsx)(a.Zp,{label:i,children:(0,c.jsx)(o.H,u({"aria-label":"".concat(i,", ").concat(s?"selected":"unselected",", button"),"aria-pressed":s,semanticColor:s?"textBrightAccent":"textSubdued",iconOnly:s?t:n,"aria-haspopup":"menu",size:"small"},d))})}},16150:(e,n,t)=>{t.d(n,{t:()=>y});var i=t(94822),r=t(26346),o=t(11900),a=t(99),c=t(61095),l=t(94980),s=t(70850),u=t(97787),d=t(10806),v=t(71523),f=(t(86746),t(79024),t(25550),t(71425),t(43379),t(97460),t(15342),t(93577),t(30758)),p=t(56818),g=t(46400),m=t(14816),b=t(86070),h=(0,f.memo)((function(e){var n=e.onFeedbackReasonSelect,t=new Map([["not_relevant",a.Ru.get("ad-formats.ad-feedback.dislike.not-relevant")],["too_often",a.Ru.get("ad-formats.ad-feedback.dislike.too-often")],["unpleasant",a.Ru.get("ad-formats.ad-feedback.dislike.unpleasant-content")],["offensive",a.Ru.get("ad-formats.ad-feedback.dislike.offensive-content")],["do_not_like",a.Ru.get("ad-formats.ad-feedback.dislike.do-not-like")]]);return(0,b.jsx)(m.pZ,{value:"dislike-ad",children:(0,b.jsx)(p.W,{children:Array.from(t).map((function(e){var t=(0,v.A)(e,2),i=t[0],r=t[1];return(0,b.jsx)(m.pZ,{value:r,children:(0,b.jsx)(g.D,{role:"menuitem","aria-label":r,onClick:function(){return n(i,r)},children:r})},i)}))})})})),y=function(e){var n=e.item,t=(0,i.wA)(),v=(0,l.L)(n).logAdFeedback,f=(0,i.d4)((function(e){return(0,u.N2)(e,n.id)}));return(0,b.jsx)(d.b,{menu:(0,b.jsx)(h,{onFeedbackReasonSelect:function(e,i){n.id&&(t((0,s.NI)({adId:n.id,reason:i})),v("dislike_".concat(e)))}}),children:(0,b.jsx)(c.n,{item:n,icon:r.P,activeIcon:o.X,label:a.Ru.get("ad-formats.ad-feedback.dislike"),isActive:f,"data-testid":"button-dislike-ad",onClick:function(){if(n.id){if(f)return t((0,s.vA)({adId:n.id})),void v("cancel_dislike");t((0,s.NI)({adId:n.id})),v("dislike_menu")}}})})}},12046:(e,n,t)=>{t.d(n,{T:()=>y});var i=t(94822),r=t(52605),o=t(6159),a=t(99),c=t(61095),l=t(94980),s=t(70850),u=t(97787),d=t(10806),v=t(71523),f=(t(86746),t(79024),t(25550),t(71425),t(43379),t(97460),t(15342),t(93577),t(30758)),p=t(56818),g=t(46400),m=t(14816),b=t(86070),h=(0,f.memo)((function(e){var n=e.onFeedbackReasonSelect,t=new Map([["relevant",a.Ru.get("ad-formats.ad-feedback.like.relevant")],["interested_in_brand",a.Ru.get("ad-formats.ad-feedback.like.interested-in-brand")],["interested_in_product",a.Ru.get("ad-formats.ad-feedback.like.interested-in-product")],["enjoyable",a.Ru.get("ad-formats.ad-feedback.like.enjoyable-content")],["discovered_new",a.Ru.get("ad-formats.ad-feedback.like.discovered-new")]]);return(0,b.jsx)(m.pZ,{value:"like-ad",children:(0,b.jsx)(p.W,{children:Array.from(t).map((function(e){var t=(0,v.A)(e,2),i=t[0],r=t[1];return(0,b.jsx)(m.pZ,{value:r,children:(0,b.jsx)(g.D,{role:"menuitem","aria-label":r,onClick:function(){return n(i,r)},children:r})},i)}))})})})),y=function(e){var n=e.item,t=(0,i.wA)(),v=(0,l.L)(n).logAdFeedback,f=(0,i.d4)((function(e){return(0,u.Tt)(e,n.id)}));return(0,b.jsx)(d.b,{menu:(0,b.jsx)(h,{onFeedbackReasonSelect:function(e,i){n.id&&(t((0,s.F$)({adId:n.id,reason:i})),v("like_".concat(e)))}}),children:(0,b.jsx)(c.n,{item:n,icon:r.G,activeIcon:o.q,label:a.Ru.get("ad-formats.ad-feedback.like"),isActive:f,"data-testid":"button-like-ad",onClick:function(){if(n.id){if(f)return t((0,s.D$)({adId:n.id})),void v("cancel_like");t((0,s.F$)({adId:n.id})),v("like_menu")}}})})}},66415:(e,n,t)=>{t.d(n,{O:()=>u});var i=t(84701),r=t(32520),o=t(99),a=t(98538),c=t(47832),l=t(56122),s=t(86070),u=function(e){var n=e.isDisliked,t=void 0!==n&&n,u=e.onClick,d=void 0===u?function(){}:u,v=e.className,f=e.size,p=void 0===f?"medium":f,g=e.label,m=void 0===g?o.Ru.get("playback-control.ban"):g,b=(0,l.y)();return(0,s.jsx)(a.Zp,{label:m,children:(0,s.jsx)(i.H,{role:"switch","aria-label":m,"aria-checked":t,className:v,onClick:d,iconOnly:r.P,size:b===c.E.MEDIUM?p:"small"})})}},41099:(e,n,t)=>{t.d(n,{z:()=>r});var i=t(25965),r=function(){var e=(0,i.C)(),n=e.togglePanel;return{isPickerOpen:e.isActive,triggerRef:{current:null},toggleDevicePicker:function(e){n(e)}}}},40808:(e,n,t)=>{t.r(n),t.d(n,{NowPlayingBar:()=>Ar});var i=t(30758),r=t(94822),o=t(94079),a=t(57923),c=t(7852),l=t(36734),s=t(99),u=t(7383);const d="dz_h98rH9nZCwfPdnKgr",v="rAfV2jB_HMM9Xtr0Rqvn",f="XkXPpDRWozMF6G8_GlLQ";var p=t(86070),g=i.memo((function(e){var n=e.handleClick,t=(0,r.d4)(u.q),i=s.Ru.get("pta.bottom-bar.title"),o=s.Ru.get("fta.bottom-bar.subtitle"),a=s.Ru.get("fta.sign-up-free");return(0,p.jsxs)("div",{className:d,onClick:n,"data-testid":"signup-bar",children:[(0,p.jsxs)("div",{className:v,children:[(0,p.jsx)(c.E,{as:"p",variant:"bodySmallBold",children:i}),(0,p.jsx)(c.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:t?s.Ru.get("fta.bottom-bar.subtitle-two"):o}})]}),(0,p.jsx)(l.$,{colorSet:"invertedLight",onClick:n,className:f,children:t?s.Ru.get("mwp.d2p.modal.cta"):a})]})})),m=t(51488),b=(t(47994),t(97500)),h=t.n(b),y=t(92600),k=t(1404),x=t(73364),j=t(41099),C=t(28678),N=t(41349),A=t(57965);const w="gqYYMz8DkhaT3e44LcHQ",I="VX33mI2V_jRA7hRBI9_0";var P=function(e){var n=e.remoteDeviceName,t=e.remoteDeviceType,i=e.connectionStatus,r=e.omitConnectionStateText,o=void 0!==r&&r,a=(0,A.r)(k.s,{}),l=a.spec,u=a.logger,d=(0,j.z)(),v=d.triggerRef,f=d.toggleDevicePicker,g=d.isPickerOpen,m=(0,C.$A)(t,i),b=i===N.zP.CONNECTED?s.Ru.get("web-player.connect.bar.connected-state",{device_name:n}):s.Ru.get("web-player.connect.bar.connecting-state",{device_name:n});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m,{size:"small",className:I,role:"presentation",semanticColor:"essentialBase"}),(0,p.jsx)(y.Y,{component:"button",onClick:function(){var e=l.activeDeviceButtonFactory(),n=u.logInteraction(g?e.hitUiHide():e.hitUiReveal()).interactionId,t=g;f(n),t||(0,x.I)("DEVICE-PICKER")},ref:v,className:w,children:(0,p.jsx)(c.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:o&&i===N.zP.CONNECTED?n:b})})]})};const S="nQSM_BrSHJ4Cp3XSuLOF";var O=function(){return(0,p.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:S,children:[(0,p.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,p.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,p.jsx)("defs",{children:(0,p.jsx)("clipPath",{id:"clip0_491_88335",children:(0,p.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]})},T=t(34365),D=t(93061),E=t(76293),R=t(68221),B=t(38618);const _="main-connectBar-connectBar",F="main-connectBar-connected",L="main-connectBar-connecting";var U=function(){var e=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{isPlayingRemotely:i.isPlayingRemotely,connectionStatus:i.connectionStatus,remoteDeviceName:null===(n=i.remoteDevice)||void 0===n?void 0:n.name,remoteDeviceType:null===(t=i.remoteDevice)||void 0===t?void 0:t.type}}),B.a),n=e.isPlayingRemotely,t=e.connectionStatus,i=e.remoteDeviceName,r=e.remoteDeviceType,o=(0,R.D)().currentSession,a=Boolean(null==o?void 0:o.active),c=n&&i&&r;if(!c&&!a)return null;var l=t===N.zP.CONNECTED||a,s=t===N.zP.CONNECTING&&!a;return(0,p.jsxs)("div",{className:h()(_,(0,m.A)((0,m.A)({"encore-bright-accent-set":l},F,l),L,s)),children:[a&&(0,p.jsx)(T.K,{}),a&&c&&(0,p.jsx)(O,{}),c&&(0,p.jsx)(P,{connectionStatus:t,remoteDeviceName:i,remoteDeviceType:r,omitConnectionStateText:a})]})},M=function(){return(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(U,{})})},V=t(15057),H=t(65277),z=t(9516),Q=t(5904),q=t(64501),G=t.n(q),K=t(60994),Z=t(65941),W=t(4547),Y=t(5287),X=t(71384),J=t(25649),$=t(18621),ee=function(e){var n=e.className,t=void 0===n?"":n,o=e.disabledClassName,a=void 0===o?"":o,c=e.onClick,l=(0,Y.lZ)(),u=(0,i.useContext)(W.s),d=(0,$.o)((function(e){var n;return null!==(n=null==e?void 0:e.hasContext)&&void 0!==n&&n})),v=(0,r.wA)(),f=!d,g=(0,i.useCallback)((0,Q.A)(G().mark((function e(){return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=u&&u.current){e.next=2;break}return e.abrupt("return");case 2:null==c||c(!0),v((0,Z.f)()),(0,J.X8)(u.current);case 5:case"end":return e.stop()}}),e)}))),[v,u,c]),b=h()(t,(0,m.A)({},a,f));return l?(0,p.jsx)(X.f,{onToggle:g,className:b,icon:K.L,label:s.Ru.get("npv.full-screen"),disabled:f,testId:"fullscreen-mode-button"}):null},ne=(0,i.memo)(ee),te=t(29722),ie=t(87281),re=t(7585),oe=t(25965);t(7651),t(30456),t(26701),t(37417),t(11737),t(51691),t(702),t(5672),t(43379),t(34192),t(88856),t(51565),t(18316);var ae=t(71523),ce=t(91714),le=t(84701),se=t(68757);const ue="xP7v0EBcbJMj1xIJxywg",de="zJU_lLLzQL6oKvMA0c5b";var ve=function(e){var n=e.onClose,t=e.onMouseEnter,i=e.onMouseLeave,r=e.onClick,o=e.impressionCallback,a=e.message;return(0,p.jsxs)("div",{className:ue,onMouseEnter:t,onMouseLeave:i,ref:o,onClick:r,children:[(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:a}),(0,p.jsx)(le.H,{iconOnly:se.M,size:"small",semanticColor:"textBase",onClick:function(e){e.stopPropagation(),null==n||n()},"aria-label":s.Ru.get("close"),className:de})]})},fe=t(30912),pe=t(84155),ge=function(){var e,n,t,i,o,a,c,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe.C,s=(0,r.Pj)(),u=l().isActive,d=(0,pe.h)();return document.hasFocus()&&!u&&(e=s.getState(),n=d.current.length>0,a=e.ui,c=e.ads,!(a.blockUserDialog.isOpen||a.connectDevicePicker.isOpen||a.deleteFolderDialog.isOpen||a.deletePlaylistDialog.isOpen||a.fullscreenMode.isOpen||a.improvedSignupPromptDialog.isOpen||a.keyboardShortcutsHelpModal.isOpen||a.leavePlaylistDialog.isOpen||a.loginToListenDialog.isOpen||a.offlineDeviceLimitReachedDialog.isOpen||a.playbackNotSupportedErrorDialog.isOpen||a.premiumDialog.isOpen||a.signupToListenDialog.isOpen||!0===(null===(t=c.billboard)||void 0===t?void 0:t.isOpen)&&!c.billboard.isMinimized||!1===(null===(i=c.vto)||void 0===i?void 0:i.isHidden)&&!1===(null===(o=c.vto)||void 0===o?void 0:o.isMinimized)||n))},me=t(61304),be=function(e){return Boolean(null==e?void 0:e.supportsDJNarration)},he=t(87440),ye=t(59766),ke=t(97449),xe=t(27614),je=t(48296),Ce=t(64654),Ne=t(60246),Ae=t(48747),we=t(2949),Ie=t(35489),Pe="spotify:playlist:37i9dQZF1EYkqdzj48dyYq",Se=function(e){var n=(0,i.useRef)(),t=(0,i.useRef)(),r=(0,i.useRef)(!1),o=(0,Ce.z)(),a=(0,ye.e)(),c=(0,ke.Z)(),l=(0,H.NC)(Ie.vF),u=(0,A.r)(me.w,{}),d=u.spec,v=u.logger,f=(0,i.useRef)(null),p=(0,i.useCallback)((function(){v.logInteraction(d.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[d,v]),g=(0,i.useCallback)((function(e){e&&f.current!==e&&v.logImpression(d.djVoiceUnsupportedNudgeFactory().impression()),f.current=e}),[d,v]),m=(0,i.useCallback)((function(){var e,n=o.getState();if(l){var t=c.getActiveDevice();return!function(e){var n;return null!==(n=null==e?void 0:e.isLocal)&&void 0!==n&&n}(t)&&(0,we.yc)(n,Pe)!==Ae.i.NOT_ACTIVE&&!be(null!=t?t:void 0)}var i=a.getState();return!function(e){return(null==e?void 0:e.connectionStatus)===N.zP.NOT_CONNECTED}(i)&&(0,we.yc)(n,Pe)!==Ae.i.NOT_ACTIVE&&!be(null!==(e=null==i?void 0:i.activeDevice)&&void 0!==e?e:void 0)}),[o,l,a,c]),b=(0,i.useCallback)((function(){m()&&e({nudgeType:"message-only-nudge",message:s.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:p,impressionCallback:g})}),[e,m,p,g]),h=(0,i.useCallback)((function(e){e.data.action===je.Ik.PLAY&&(r.current=!0)}),[]);(0,Ne.p)(je.gd.ACTION,h);var y=(0,i.useCallback)((function(e){var t;r.current&&(0,we.uW)(e.data)===Ae.i.PLAYING&&(n.current=null===(t=e.data)||void 0===t?void 0:t.context.uri,b(),n.current=void 0,r.current=!1)}),[b]);(0,Ne.p)(je.gd.UPDATE,y);var k=(0,i.useCallback)((function(e){var n,i=null===(n=e.data)||void 0===n?void 0:n.activeDevice;i&&!i.isLocal&&t.current!==i.connectStateId&&b(),t.current=null==i?void 0:i.connectStateId}),[b]);(0,xe.W)(he.P.UPDATE,k)},Oe=(t(60184),t(68216),t(28430),t(9582),t(76027)),Te=function(e){switch(e.type){case N.bq.AUDIO_DONGLE:case N.bq.AVR:case N.bq.CAST_AUDIO:case N.bq.CAST_VIDEO:case N.bq.GAME_CONSOLE:case N.bq.SPEAKER:case N.bq.STB:case N.bq.TV:return!0;default:return!1}},De=function(e){return!e||!(e.terminalType===Oe.FI.HEADPHONES||e.terminalType===Oe.FI.SPEAKERS&&(e.transportType===Oe.Yg.BLUETOOTH||e.transportType===Oe.Yg.USB))},Ee=t(55198),Re=t(46712),Be=t(73413),_e=new Date(0).toISOString(),Fe=["shift+alt+f10"],Le=function(e){var n=(0,i.useRef)(),t=(0,i.useRef)(!1),o=(0,i.useRef)(!1),a=(0,r.Pj)(),c=(0,Ce.z)(),l=(0,ye.e)(),u=(0,ke.Z)(),d=(0,Re.V)(),v=(0,Be.x)("connect-nudge-triggered-at",_e),f=(0,ae.A)(v,2),p=f[0],g=f[1],m=(0,i.useRef)(null),b=(0,A.r)(me.w,{}),h=b.spec,y=b.logger,k=(0,H.NC)(Ie.vF),x=(0,i.useCallback)((function(){y.logInteraction(h.connectFromDevicePickerNudgeFactory().hitNoAction())}),[h,y]),j=(0,i.useCallback)((function(){y.logInteraction(h.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[h,y]),C=(0,i.useCallback)((function(e){e&&m.current!==e&&y.logImpression(h.connectFromDevicePickerNudgeFactory().impression()),m.current=e}),[h,y]);(0,Ee.f)(Fe,(0,Q.A)(G().mark((function e(){var n,t;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.getState(),n.platform.isDeveloperMode&&((t=new Date).setHours(t.getHours()-8),g(t.toISOString()));case 2:case"end":return e.stop()}}),e)}))));var w=(0,i.useCallback)((function(){var e=c.getState(),n=l.getState(),t=u.getActiveDevice(),i=u.getDevices(),r=d.getDefaultDevice(),o=new Date(p);o.setHours(o.getHours()+8);var a=o<=new Date;return k?a&&function(e){var n;return null!==(n=null==e?void 0:e.isLocal)&&void 0!==n&&n}(t)&&!(0,we.A3)(e)&&function(e){return e.some((function(e){return e.isLocalNetwork&&!e.isDisabled&&Te(e)}))}(i)&&De(r):a&&function(e){return(null==e?void 0:e.connectionStatus)===N.zP.NOT_CONNECTED}(n)&&!(0,we.A3)(e)&&function(e){return!(null==e||!e.devices.length)&&e.devices.some((function(e){return e.isLocalNetwork&&!e.isDisabled&&Te(e)}))}(n)&&De(r)}),[c,l,d,p,k,u]),I=(0,i.useCallback)((function(){if(w()){e({nudgeType:"message-only-nudge",message:s.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:C,onClick:x,onClose:j});var n=(new Date).toISOString();g(n)}}),[e,w,g,x,j,C]),P=(0,i.useCallback)((function(e){e.data.action===je.Ik.PLAY?t.current=!0:e.data.action===je.Ik.RESUME&&(o.current=!0)}),[]);(0,Ne.p)(je.gd.ACTION,P);var S=(0,i.useCallback)((function(e){var i,r;if(t.current&&(0,we.uW)(e.data)===Ae.i.PLAYING)n.current=null===(r=e.data)||void 0===r?void 0:r.context.uri,I(),n.current=void 0,t.current=!1;else if(o.current&&!1===(null===(i=e.data)||void 0===i?void 0:i.isPaused)){var a;n.current=null===(a=e.data)||void 0===a?void 0:a.context.uri,I(),n.current=void 0,o.current=!1}}),[I]);(0,Ne.p)(je.gd.UPDATE,S)},Ue=(t(184),t(42486),t(40065),t(79024),t(25550),t(59255),t(85130),t(55636),t(28509),t(97332),t(46555),t(13296),t(24594),t(97460),t(4865),t(15342),t(93577),t(23336)),Me=t(2860),Ve=t(1131),He=t(27681),ze=t(65258),Qe=t(37221),qe=t(97506),Ge=t(21122),Ke=t(22507),Ze=(t(83234),t(78551),t(82467),t(79655)),We=t(36560),Ye=t(73996),Xe=t(68042),Je=function(e){Le(e),Se(e),function(e){var n=(0,Qe.d)(),t=(0,R.D)(),r=t.getSessionInfo,o=t.joinSession,a=t.currentSession,c=(0,Ve.vh)(),l=(0,He.b)(),u=(0,Oe.lS)(l),d=(0,i.useRef)(new Set),v=(0,i.useCallback)(function(){var e=(0,Q.A)(G().mark((function e(n,t){var i,r,a;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.current.add(t),i="IN_PERSON",r=Ge.JO.DISCOVERED_DEVICE,e.prev=3,e.next=6,o(n,r,i);case 6:(a=e.sent)&&c.send((0,Ue.X)({session_id:t,join_type:r,join_url:a.joinSessionUri,participation_mode:i})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),e.t0 instanceof Error&&c.send((0,Ue.X)({session_id:t,error_category:e.t0.name,error_data:e.t0.message}));case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n,t){return e.apply(this,arguments)}}(),[c,o]),f=(0,Ce.z)(),p=(0,i.useCallback)((function(){return(0,we.uW)(f.getState())!==Ae.i.PLAYING}),[f]),g=(0,i.useCallback)(function(){var n=(0,Q.A)(G().mark((function n(t,i){var r,o,a,c,l,u;return G().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=i.sessionMembers,o=i.sessionOwnerId,a=i.sessionId,c=i.isSessionOwner,(l=r.find((function(e){return e.id===o})))&&!c){n.next=4;break}return n.abrupt("return");case 4:u=r.map((function(e){return{uri:(0,Me.Qjr)(e.username).toURI(),displayName:e.displayName,username:e.username,images:e.imageUrl?[{url:e.imageUrl}]:[]}})),p()&&e({nudgeType:"join-listening-session-nudge",title:s.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-title",{host:l.displayName,device:t.title}),message:s.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-text"),onClose:function(){},onActionButtonClick:function(){v(t.token,a)},users:u});case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),[p,v,e]);(0,qe.c)(ze.P.SCAN_UPDATE,(function(){var e=function(){var e=(0,Q.A)(G().mark((function e(t){var i,o;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r(t.token);case 4:if(!(i=e.sent)){e.next=12;break}if(!d.current.has(i.sessionId)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.getLocalNetSesssionDeviceVisibility(i.sessionId);case 10:(o=e.sent)!==Ge.MS.UNSPECIFIED&&o!==Ge.MS.NOTIFY||g(t,i);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();if(null==a||!a.active){var t=n.getLocalNetSessionDevices(),i=null==t?void 0:t.devices.find((function(e){return e.isNew}));i&&e(i)}}))}(e),function(e){var n=(0,Ze.AI)(Ye.Z.DevicePicker,Ye.Z.DevicePickerOverlay).panelSend,t=(0,Be.x)("session-broadcast-nudge-shown",[]),r=(0,ae.A)(t,2),o=r[0],a=r[1],c=(0,i.useCallback)((function(e){var n=[].concat((0,Ke.A)(o),[e]);n.length>10&&n.shift(),a(n)}),[o,a]);(0,qe.c)(ze.P.BROADCAST_NUDGE,(function(t){var i=t.data,r=i.deviceId;i.broadcastStatus===Xe.ez.BROADCAST_ON&&r&&!o.includes(r)&&(c(r),e({nudgeType:"session-is-being-broadcasted-nudge",message:s.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-text"),onClose:function(){},onActionButtonClick:function(){n({type:We.$S.DEVICE_PICKER_BUTTON_CLICK})}}))}))}(e)},$e=(t(60287),function(){var e=(0,i.useRef)(),n=(0,i.useRef)(!1),t=(0,i.useRef)(!1),o=(0,r.wA)(),a=(0,r.d4)((function(e){return e.ui.connectNudge.isOpen})),c=(0,r.d4)((function(e){return e.ui.connectDevicePicker.isOpen})),l=(0,i.useCallback)((function(){t.current&&(clearTimeout(e.current),t.current=!1),o((0,Z.Yp)())}),[o]),s=(0,i.useCallback)((function(){t.current=!1,n.current||l()}),[l]),u=(0,i.useCallback)((function(){e.current=window.setTimeout(s,8e3),o((0,Z.dK)()),t.current=!0}),[o,s]),d=(0,i.useCallback)((function(e){n.current=e,e||t.current||l()}),[l]);return(0,i.useEffect)((function(){c&&l()}),[c,l]),(0,i.useMemo)((function(){return{hideNudge:l,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:a}}),[l,u,d,a])}),en=t(81342),nn=t(47419);const tn="uETBcNmdHUHF_YPLJfOx",rn="kb2DrVIixaicEzk6sEcP",on="PmEpl43j3MvwvoqnnZ6A",an="zWPenObFu5ZjWvtk_qSb";var cn=function(e){var n=e.onClose,t=e.onActionButtonClick,r=e.onMouseEnter,o=e.onMouseLeave,a=e.message,u=e.title,d=e.users,v=(0,A.r)(en.m,{}),f=v.spec,g=v.logger,m=(0,i.useCallback)((function(){g.logInteraction(f.nudgeScanningTooltipFactory().closeButtonFactory().hitUiHide()),null==n||n()}),[g,n,f]),b=(0,i.useCallback)((function(){g.logInteraction(f.nudgeScanningTooltipFactory().joinButtonFactory().hitJoinSocialListeningSession()),t()}),[g,t,f]);return(0,p.jsxs)("div",{className:tn,onMouseEnter:r,onMouseLeave:o,children:[(0,p.jsxs)("div",{className:rn,children:[d.length>0&&(0,p.jsx)(nn.g,{users:d}),(0,p.jsx)(c.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",className:on,children:u}),(0,p.jsx)(le.H,{iconOnly:se.M,size:"small",semanticColor:"textBase",onClick:m,"aria-label":s.Ru.get("close")})]}),(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:a}),(0,p.jsx)("div",{className:an,children:(0,p.jsx)(l.$,{colorSet:"invertedLight",size:"small",onClick:b,children:s.Ru.get("web-player.social-connect.join-modal.button-primary")})})]})},ln=t(48954);const sn="_eXNo3nLWPbXuTHH7K08",un="VT_giL9ITyvqFuzZsmWk",dn="m5mgkcoKawOAJIWj0JE7";var vn=function(e){var n=e.onActionButtonClick,t=e.onMouseEnter,r=e.onMouseLeave,o=e.message,a=(0,A.r)(en.m,{}),u=a.spec,d=a.logger,v=(0,i.useCallback)((function(){d.logInteraction(u.nudgeBroadcastingTooltipFactory().changeButtonFactory().hitUiReveal()),null==n||n()}),[d,n,u]);return(0,p.jsxs)("div",{className:sn,onMouseEnter:t,onMouseLeave:r,children:[(0,p.jsx)(ln.h,{size:"medium",className:un}),(0,p.jsx)(c.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:o}),(0,p.jsx)("div",{className:dn,children:(0,p.jsx)(l.$,{colorSet:"invertedLight",size:"small",onClick:v,children:s.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-button")})})]})};function fn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function pn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?fn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var gn=function(e){var n=e.children,t=e.useNudgeTriggers,r=void 0===t?Je:t,o=e.useToggleNudgeWithTimer,a=void 0===o?$e:o,c=e.useCanShowNudge,l=void 0===c?ge:c,s=e.disabled,u=void 0!==s&&s,d=a(),v=d.showNudge,f=d.hideNudge,g=d.setShouldKeepShowingNudge,m=d.isNudgeVisible,b=(0,i.useState)(null),h=(0,ae.A)(b,2),y=h[0],k=h[1],x=l();(0,i.useEffect)((function(){m&&!x&&f()}),[x,f,m]),r((function(e){return!(m||!x)&&(k(e),v(),!0)}));var j=(0,i.useCallback)((function(e){if(!e)return(0,p.jsx)(p.Fragment,{});var n=function(){var n;null==e||null===(n=e.onClose)||void 0===n||n.call(e),f()};if("join-listening-session-nudge"===e.nudgeType){return(0,p.jsx)(cn,pn(pn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n,onActionButtonClick:function(){var n;null===(n=e.onActionButtonClick)||void 0===n||n.call(e),f()}}))}return"session-is-being-broadcasted-nudge"===e.nudgeType?(0,p.jsx)(vn,pn(pn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n})):(0,p.jsx)(ve,pn(pn({onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},e),{},{onClose:n}))}),[f,g]);return(0,p.jsx)(ce.W,{maxWidth:"join-listening-session-nudge"===(null==y?void 0:y.nudgeType)?450:void 0,placement:"top",visible:Boolean(null==y?void 0:y.message)&&m&&!u,overlay:j(y),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:function(){},fadeOut:!0,useLazyMounting:!0,children:n})},mn=function(){var e=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{remoteDeviceType:null===(n=i.remoteDevice)||void 0===n?void 0:n.type,remoteDeviceIsGroup:null===(t=i.remoteDevice)||void 0===t?void 0:t.isGroup,connectionStatus:i.connectionStatus}}),B.a),n=e.remoteDeviceType,t=e.remoteDeviceIsGroup,r=e.connectionStatus,o=(0,ie.g)(),a=(0,oe.C)(),c=a.canTogglePanel,l=a.isActive,u=a.togglePanel,d=(0,A.r)(te.p,{}),v=d.spec,f=d.logger,g=(0,i.useCallback)((function(){var e=f.logInteraction(function(e,n,t){return {interactionId:null,pageInstanceId:null};var i;return i=n===N.zP.CONNECTING?e.connectingButtonFactory():n===N.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),t?i.hitUiHide():i.hitUiReveal()}(v,r,l)),n=e.interactionId;u(n)}),[r,u,l,v,f]),m=(0,re.l)().currentDevice.isLocal,b=(0,i.useMemo)((function(){return(0,C.tf)(n,t,m?o:null)}),[o,m,t,n]);return(0,p.jsx)(gn,{children:(0,p.jsx)(X.f,{isActive:l,disabled:!c,onToggle:g,label:s.Ru.get("playback-control.connect-picker"),icon:b})})},bn=t(17561),hn=t(62058),yn=t(6036),kn=t(93224);const xn="A8ETvbaffbfWsxJDy_OW",jn="yQQ8ZWvoqRXw2oHD1OJR";var Cn=function(e){var n=e.children;return(0,p.jsx)("div",{className:xn,children:n})},Nn=function(e){var n=e.onHide,t=(0,Ze._Y)();return(0,p.jsxs)(Cn,{children:[(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones")}),(0,p.jsxs)("div",{className:jn,children:[(0,p.jsx)(le.H,{semanticColor:"textSubdued",onClick:n,condensedAll:!0,size:"small",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones.cancel")}),(0,p.jsx)(l.$,{colorSet:"invertedLight",onClick:function(){t(We.$S.PUFFIN_START_ACTIVATION),n()},size:"small",children:s.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")})]})]})},An=t(90820),wn=function(){var e=(0,An.j)().deviceFilterState.audioDevice;if(!e)return null;var n=e.transportType===Oe.Yg.BLUETOOTH?e.name:s.Ru.get("web-player.puffin.wired-connection");return(0,p.jsx)(Cn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.optimized-for",n)})})},In=function(e){var n=e.hasDevice;return(0,D.l)()?(0,p.jsx)(Cn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhanced-listening")})}):n?(0,p.jsx)(Cn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.enhanced-headphones")})}):(0,p.jsx)(Cn,{children:(0,p.jsx)(c.E,{variant:"bodyMedium",children:s.Ru.get("web-player.puffin.upsell.lossless-listening")})})},Pn=t(89907),Sn=function(e){var n=e.state,t=e.hasDevice,i=e.onHide;switch(n){case"detection":return(0,p.jsx)(Nn,{onHide:i});case"initial":return(0,p.jsx)(In,{hasDevice:t});case"filters_applied":return(0,p.jsx)(wn,{});default:(0,Pn.k)(n)}return null},On=t(67837),Tn=t(69381);function Dn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function En(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Dn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Dn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Rn=function(e){var n=e.children,t=e.onVisibilityChange,r=(0,Tn.c)().isPuffinPanelActive,o=(0,i.useState)("none"),a=(0,ae.A)(o,2),c=a[0],l=a[1],s=(0,Be.x)("onboarding-dismissed:puffin",{}),u=(0,ae.A)(s,2),d=u[0],v=u[1],f=(0,An.j)(),g=f.deviceFilterState,b=f.isMaybeHeadphoneDevice,h=(0,i.useRef)(g.audioDevice),y=(0,On.N)().getSavedDevices().length>0;(0,i.useEffect)((function(){var e;if(g.audioDevice&&(null===(e=h.current)||void 0===e?void 0:e.id)!==g.audioDevice.id){if(h.current=g.audioDevice,r||g.audioDevice.terminalType!==Oe.FI.HEADPHONES)return;d[g.audioDevice.id]&&!(d[g.audioDevice.id]<3)||g.isOnboarded?(g.currentState.externalizationEnabled||g.currentState.specificEnabled)&&l("filters_applied"):(d[g.audioDevice.id]||v(En(En({},d),{},(0,m.A)({},g.audioDevice.id,0))),l("detection"))}}),[g,d,r,h,v]);var k=(0,i.useCallback)((function(){l("none")}),[]),x=(0,i.useCallback)((function(){if(null!==g.audioDevice){var e,n=g.audioDevice.id;v(En(En({},d),{},(0,m.A)({},n,(null!==(e=d[n])&&void 0!==e?e:0)+1)))}}),[g.audioDevice,d,v]);(0,i.useEffect)((function(){if("detection"!==c){var e=setTimeout(k,5e3);return function(){return clearTimeout(e)}}return function(){}}),[k,c]),(0,i.useEffect)((function(){y||d||l("initial")}),[y,d,l]),(0,i.useEffect)((function(){!r&&b||k()}),[k,r,v,b]);var j="none"!==c;return(0,i.useEffect)((function(){t(j)}),[j,t]),(0,p.jsx)(yn.E,{isVisible:j,placement:"top-start",content:j?(0,p.jsx)(hn.z,{onClose:k,maxWidth:287,header:(0,p.jsx)(kn.s,{variant:"bodyMediumBold"}),children:(0,p.jsx)(Sn,{state:c,hasDevice:b,onHide:function(){x(),k()}})}):null,children:n})},Bn=t(63564),_n=We.$S.PUFFIN_BUTTON_CLICK,Fn=We.$S.DEVICE_PICKER_BUTTON_CLICK,Ln=function(){var e,n=(0,Bn.c)().isPuffinPanelActive,t=(0,Ze.AI)(Ye.Z.DevicePicker,Ye.Z.DevicePickerOverlay),r=t.isActive,o=t.panelSend,a=(0,i.useState)(!1),c=(0,ae.A)(a,2),l=c[0],u=c[1],d=(0,Ze.Ev)(_n),v=(0,E.v)((function(e){var n,t,i=(0,D.V)(e);return{remoteDeviceType:null===(n=i.remoteDevice)||void 0===n?void 0:n.type,remoteDeviceisGroup:null===(t=i.remoteDevice)||void 0===t?void 0:t.isGroup}}),B.a),f=v.remoteDeviceType,g=v.remoteDeviceisGroup,m=(0,ie.g)(),b=(null==m?void 0:m.audioDevice.terminalType)===Oe.FI.HEADPHONES,h=(e=(0,An.j)().deviceFilterState).currentState.externalizationEnabled||e.currentState.specificEnabled,y=r||n,k=h||b,j=(0,re.l)().currentDevice.isLocal,N=(0,i.useMemo)((function(){return h?bn.C:(0,C.tf)(f,g,j?m:null)}),[m,h,g,f,j]);return(0,p.jsx)(gn,{disabled:l,children:(0,p.jsx)(Rn,{onVisibilityChange:u,children:(0,p.jsx)(X.f,{isActive:y,isActiveNoIndicator:k,onToggle:function(){var e=r;o(Fn),e||(0,x.I)("DEVICE-PICKER")},label:s.Ru.get("playback-control.connect-picker"),icon:N,disabled:!d,restoreFocusKey:n?Ye.Z.Puffin:Ye.Z.DevicePicker})})})},Un=t(86772),Mn=t(73309),Vn=function(){var e=(0,r.d4)(Mn.Ht).isAnonymous,n=(0,Un.v)();return e?null:n?(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(Ln,{})}):(0,p.jsx)(mn,{})},Hn=t(57466),zn=t(47737),Qn=t(92609),qn=t(6669),Gn=t(49093);function Kn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Zn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Kn(Object(t),!0).forEach((function(n){(0,m.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Kn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Wn=i.memo((function(e){var n=e.onClick,t=e.className,i=e.isActive,r=e.isEnabled,o=r?s.Ru.get("web-player.lyrics.title"):s.Ru.get("web-player.lyrics.noLyrics1"),a=r?n:void 0;return(0,p.jsx)(X.f,{className:t,isActive:i,onToggle:a,disabled:!r,label:o,testId:"lyrics-button",icon:Hn.q})})),Yn=i.memo((function(e){var n,t=Boolean(null===(n=(0,qn.J)().data)||void 0===n?void 0:n.hasLyrics);return(0,p.jsx)(Wn,Zn(Zn({},e),{},{isEnabled:t,isActive:!1}))})),Xn=i.memo((function(e){var n=(0,$.o)((function(e){var n;return null==e||null===(n=e.item)||void 0===n?void 0:n.uri})),t=Boolean((0,Qn.f)(n).hasLyrics);return(0,p.jsx)(Wn,Zn(Zn({},e),{},{isEnabled:t,isActive:!1}))})),Jn=i.memo((function(e){var n=(0,zn.$)().isActive,t=(0,r.d4)(Mn.Ht).isAnonymous,i=(0,H.NC)(Gn.khs),o=(0,$.o)((function(e){var n,t,i;return!(null==e||null===(n=e.item)||void 0===n||!n.uri||!(0,Me.U_m)(null==e||null===(t=e.item)||void 0===t?void 0:t.uri))&&!Boolean(null==e||null===(i=e.item)||void 0===i||null===(i=i.metadata)||void 0===i?void 0:i["segment.index"])}));return t||!o?null:n?(0,p.jsx)(Wn,Zn(Zn({},e),{},{isActive:!0,isEnabled:!0})):i?(0,p.jsx)(Yn,Zn({},e)):(0,p.jsx)(Xn,Zn({},e))})),$n=t(10364),et=function(e){var n=e.onClick,t=e.className,i=(0,$n.A)({onChange:n,referrer:"now_playing_bar"}).toggleLyrics;return(0,p.jsx)(Jn,{onClick:i,className:t})},nt=t(53002),tt=t(19726),it=t(7084),rt=We.$S.NPV_BUTTON_CLICK,ot=function(e){var n=e.onClick,t=(0,Ze.AI)(Ye.Z.NowPlayingView),i=t.isActive,r=t.panelSend,o=(0,Ze.Ev)(rt),a=(0,tt.r)(),c=a.mode,l=a.setMode,u=!(0,$.o)((function(e){return{item:null==e?void 0:e.item}}),(function(e,n){var t,i;return(null===(t=e.item)||void 0===t?void 0:t.uri)===(null===(i=n.item)||void 0===i?void 0:i.uri)})).item||!o;return(0,p.jsx)(X.f,{isActive:i,disabled:u,onToggle:function(){null==n||n(!i),r(rt),c===it.YU.cinema&&l(it.YU.npv)},icon:nt.d,label:s.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ye.Z.NowPlayingView})},at=(t(75380),t(96794),t(70750),t(90543)),ct=t(66808),lt=(t(86746),t(21011)),st=t(44843),ut=t(96635),dt=t(38672),vt=t(59370);var ft=function(e){var n=e.uri,t=e.to,o=e.children,a=e.onDrop,c=e.onNavigate,l=e.className,s=(0,i.useState)(!1),u=(0,ae.A)(s,2),d=u[0],v=u[1],f=(0,i.useRef)(null),g=(0,at.Zp)(),m=(0,r.wA)(),b=(0,dt.f)(),h=(0,vt.g)(),y=(0,Ce.z)(),k=function(e){var n=(0,Me.o_h)(e),t=(0,r.d4)(Mn.F6);switch(null==n?void 0:n.type){case Me.NQG.PLAYLIST:case Me.NQG.PLAYLIST_V2:var i;if((0,Me.iwx)(n)&&(i=n.username),t&&i===t)return[ut.Ay[Me.NQG.TRACK],ut.Ay[Me.NQG.LOCAL],ut.Ay[Me.NQG.ALBUM]];break;case Me.NQG.COLLECTION:return[ut.Ay[Me.NQG.TRACK],ut.Ay[Me.NQG.ALBUM],ut.Ay[Me.NQG.ARTIST],ut.Ay[Me.NQG.PLAYLIST],ut.Ay[Me.NQG.PLAYLIST_V2],ut.Ay[Me.NQG.SHOW]];case Me.NQG.QUEUE:return[ut.Ay[Me.NQG.TRACK],ut.Ay[Me.NQG.LOCAL],ut.Ay[Me.NQG.EPISODE]];default:return[]}return[]}(n),x=!!k.length;return(0,i.useEffect)((function(){return d?f.current=window.setTimeout((function(){(0,Me.U_m)(n)||(null==c||c(),g(t||(0,Me.o_h)(n).toURLPath(!0)))}),1e3):!d&&f.current&&clearTimeout(f.current),function(){f.current&&clearTimeout(f.current)}}),[d,n,t,c,g]),x?(0,p.jsx)(st.A,{types:k,onDrop:function(e){var t=(0,Me.o_h)(n),i=Array.from(e.dataTransfer.types).find((function(e){return k.includes(e)})),r=i&&e.dataTransfer.getData(i),o=r&&r.split("\n")[0],c=(0,Me.o_h)(o);if(c&&t)switch(null==a||a(c.toURI()),t.type){case Me.NQG.PLAYLIST:case Me.NQG.PLAYLIST_V2:m((0,lt.io)(n,[c.toURI()]));break;case Me.NQG.COLLECTION:(0,Me._Tv)(c)||(0,Me.ecE)(c)||(0,Me.U_m)(c)?b.add({uris:[c.toURI()]}):(0,Me.tbX)(c)?h.add([c.toURI()],{before:"start"}):(0,Me.WB1)(c)&&b.add({uris:[c.toURI()]});break;case Me.NQG.QUEUE:y.addToQueue([{uri:c.toURI(),uid:null}])}},onDragEnter:function(){v(!0)},onDragLeave:function(){v(!1)},className:l,children:o}):(0,p.jsx)("div",{children:o})},pt=t(33786);function gt(e){var n=e.style,t=e.active,r=e.disabled,o=e.intent,a=e.label,c=e.labelActive,l=e.icon,s=e.iconActive,u=e.className,d=e.onClick,v=(0,i.useState)(!1),f=(0,ae.A)(v,2),g=f[0],m=f[1],b=(0,pt.W)(),h=t&&c?c:a,y=t&&s?s:l;return(0,p.jsx)(X.f,{style:n,className:u,isActive:t,disabled:r,onToggle:function(e){null==d||d(),g||e.target.blur(),m(!1),o&&b({type:"click",intent:o,targetUri:""})},onKeyDown:function(e){"enter"===e.key.toLowerCase()&&m(!0)},label:h,icon:y,testId:"control-button-".concat(o)})}var mt=t(50394),bt=t(11001),ht=t(33456),yt=function(){var e=(0,r.d4)(Mn.Ht).isAnonymous,n=(0,bt.d)().videoPlayerMode;return e||"cinema"===n?{isVisible:!1}:{isVisible:!0,isEnabled:!0}},kt=function(e){var n=e.onClick,t=yt(),r=t.isEnabled,o=t.isVisible,a=(0,at.zy)(),c=(0,ht.J)(),l=(0,at.Zp)(),u=(0,i.useMemo)((function(){return"/queue"===a.pathname||"/history"===a.pathname}),[a.pathname]),d=(0,i.useCallback)((function(){var e,t=null===(e=c.entries)||void 0===e||null===(e=e.slice(0,c.index+1))||void 0===e||null===(e=e.reverse())||void 0===e?void 0:e.findIndex((function(e){var n=e.pathname;return"/queue"!==n&&"/history"!==n}));n({mode:"main",route:null}),l(-1===t?"/":t>=0?-t:-1)}),[l,c,n]),v=(0,i.useCallback)((function(){n({mode:"main",route:"/queue"}),l("/queue",{state:{referrer:"now_playing_bar"}})}),[n,l]),f=(0,i.useCallback)((function(){r&&(u?d():v())}),[r,u,d,v]);return o?(0,p.jsx)(ft,{uri:"spotify:queue",children:(0,p.jsx)(gt,{intent:"queue",icon:ct.j,label:s.Ru.get("playback-control.queue"),onClick:f,active:u,disabled:!r})}):null},xt=We.$S.QUEUE_BUTTON_CLICK,jt=function(e){var n=e.onClick,t=yt(),r=t.isEnabled,o=t.isVisible,a=(0,Ze.Ev)(xt),c=(0,Ze.AI)(Ye.Z.Queue,Ye.Z.QueueOverlay).isActive,l=(0,mt.R)().toggleQueue,u=(0,i.useCallback)((function(){r&&(n({mode:"panel",aboutToShow:!c}),l())}),[r,n,c,l]);return o?(0,p.jsx)(ft,{uri:"spotify:queue",children:(0,p.jsx)(X.f,{icon:ct.j,label:s.Ru.get("playback-control.queue"),onToggle:u,isActive:c,disabled:!r||!a,testId:"control-button-queue",restoreFocusKey:Ye.Z.Queue})}):null},Ct=function(e){var n=e.onClick;return(0,H.NC)(Gn.eWj)?(0,p.jsx)(jt,{onClick:n}):(0,p.jsx)(kt,{onClick:n})},Nt=t(39050),At=t(94333),wt=t(82245),It=function(e){var n,t=e.onClick,i=(null!==(n=(0,At.L)())&&void 0!==n?n:{}).item,r=(0,wt.D)({item:i,onClick:t}),o=r.isActive,a=r.onClick,c=r.showButton;return i&&c?(0,p.jsx)(X.f,{isActive:o,onToggle:a,label:o?s.Ru.get("miniplayer.close"):s.Ru.get("miniplayer.open"),icon:Nt.F,testId:"pip-toggle-button"}):null},Pt=t(40121),St=t(32813),Ot=t(30487);const Tt="main-nowPlayingBar-extraControls",Dt="main-nowPlayingBar-lyricsButton",Et="main-nowPlayingBar-volumeBar";var Rt=function(){var e=(0,H.NC)(Gn.yux),n=(0,bt.d)(),t=n.setVideoPlayerUIFlag,r=n.videoPlayerMode,o=(0,A.r)(z.h9,{data:{identifier:r===St.K.cinema?z.gw.CINEMA:z.gw.DESKTOP}}),a=o.spec,c=o.logger,l=o.UBIFragment,s=(0,V.YQ)((function(e){c.logInteraction(a.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),u=(0,i.useCallback)((function(e){e&&t(St.n.cinema,!1)}),[t]);return(0,p.jsx)(l,{spec:a,children:(0,p.jsxs)("div",{className:Tt,children:[(0,p.jsx)(Ot.mA,{onClick:function(){c.logInteraction(a.djJumpButtonFactory().hitRefreshContent())}}),(0,p.jsx)(ot,{onClick:function(e){e?c.logInteraction(a.npvButtonFactory().hitUiReveal()):c.logInteraction(a.npvButtonFactory().hitUiHide())}}),!e&&(0,p.jsx)(et,{className:Dt,onClick:function(e){e?c.logInteraction(a.lyricsButtonFactory().hitUiNavigate({destination:e})):c.logInteraction(a.lyricsButtonFactory().hitUiNavigateBack())}}),(0,p.jsx)(Ct,{onClick:function(e){"main"===e.mode?e.route?c.logInteraction(a.queueButtonFactory().hitUiNavigate({destination:e.route})):c.logInteraction(a.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?c.logInteraction(a.queueButtonFactory().hitUiReveal()):c.logInteraction(a.queueButtonFactory().hitUiHide())}}),(0,p.jsx)(Vn,{}),(0,p.jsx)(Pt.M,{className:Et,onVolumeBarClick:function(e){c.logInteraction(a.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:function(e){"muted"===e?c.logInteraction(a.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&c.logInteraction(a.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:s}),(0,p.jsx)(It,{onClick:u}),(0,p.jsx)(ne,{className:"control-button",disabledClassName:"control-button--disabled",onClick:function(e){e&&c.logInteraction(a.fullscreenButtonFactory().hitUiReveal())}})]})})},Bt=t(96621),_t=t(10940),Ft=t(97579);const Lt="yyrJTUPMeLS8qs1a0YJr";var Ut=function(e){var n=e.logoUrl;return n?(0,p.jsx)("div",{className:Lt,"data-testid":"context-ad-logo",children:(0,p.jsx)(_t.N,{loading:"eager",imgSrc:n,width:56,height:56,type:Ft.c.AD})}):null},Mt=t(19224),Vt=t(90044),Ht=t(31091),zt=function(e){var n=e.item,t=e.context,i=e.index,r=(0,Mt.iz)(n).logoImage;return(0,p.jsx)(Ht.e,{item:n,context:t,index:i,"aria-label":s.Ru.get("ad-formats.advertisement"),adEventReason:Vt.c.AD_LOGO,isVisible:!1,children:(0,p.jsx)(Ut,{logoUrl:r})})},Qt=t(9811),qt=t(57550),Gt=t(69146),Kt=i.memo((function(e){var n=e.uri,t=e.className,r=e.onClick,o=e.size,a=void 0===o?qt.t.xs:o,c=(0,Gt.A)(n),l=(0,ae.A)(c,2),s=l[0],u=l[1],d=(0,pt.W)(),v=(0,i.useCallback)((function(e){e.preventDefault(),d({targetUri:n,intent:s?"remove-from-library":"add-to-library",type:"click"}),r&&r(!s),u(!s)}),[d,n,s,r,u]);return(0,p.jsx)(qt.M,{className:t,size:a,onClick:v,isAdded:!!s,isAudiobook:!0,condensed:!0})})),Zt=t(94910),Wt=t(80568),Yt=t(49557),Xt=function(e){var n=e.uri,t=e.isBook,r=void 0!==t&&t,o=e.size,a=void 0===o?qt.t.xs:o,c=e.className,l=e.onClick,s=(0,Yt.w)({uri:n,isBook:r}),u=s.isPreSaved,d=s.addPresave,v=s.removePresave,f=(0,i.useCallback)((function(){u?v():d(),null==l||l(!u)}),[u,l,v,d]);return(0,p.jsx)(qt.M,{className:c,size:a,onClick:f,isAdded:!!u,isAudiobook:!0,condensed:!0})},Jt=t(99116),$t=t(68130),ei=t(54946),ni=t(97252),ti=t(59414),ii=t(40685),ri=t(58153),oi=t(43543),ai=t(25555),ci=t(30843),li=t(19533);function si(e){return(0,li.v)(e)||(0,ci.p)(e)}var ui=t(35605);const di="main-nowPlayingWidget-nowPlaying",vi="main-coverSlotCollapsed-navAltContainer",fi="main-nowPlayingWidget-coverArt",pi="main-nowPlayingWidget-trackInfo",gi="HD9s7U5E1RLSWKpXmrqx";var mi=function(e){var n,t=e.onClick,i=(0,At.L)(),r=(0,ui.P)(),o=r.draggable,a=r.onDragStart,c=(0,Ze.AI)(Ye.Z.NowPlayingView),l=c.isActive,u=c.panelSend;if(null===i)return null;var d=i.context,v=i.item,f=We.$S.NPV_BUTTON_CLICK;return(0,p.jsx)(ti.h,{menu:(0,p.jsx)(ri.W,{context:d,item:v}),children:(0,p.jsx)("div",{draggable:o&&si(v),onDragStart:function(e){a(e,{itemUris:[v.uri],dragLabelText:(0,ai.r)(v)})},children:(0,p.jsx)(oi.R,{uri:d.uri,owner:null===(n=d.metadata)||void 0===n?void 0:n.context_owner,children:(0,p.jsx)("button",{type:"button","data-testid":"cover-art-button",className:gi,"aria-label":s.Ru.get("web-player.now-playing-view.label"),onClick:function(){u(f),null==t||t(l)},children:(0,p.jsx)(ii.b,{item:v,size:56,maxSize:56,className:fi})})})})})},bi=t(16023),hi=t(96464),yi=t(98538);const ki="main-coverSlotCollapsed-container",xi="main-coverSlotCollapsed-expandButton";var ji=We.$S.NPV_BUTTON_CLICK,Ci=function(e){var n=e.children,t=e.className,r=(0,Ze.Ev)(ji),o=(0,Ze.AI)(Ye.Z.NowPlayingView).isActive,a=(0,Ze._Y)(),c=(0,i.useMemo)((function(){return o?{label:s.Ru.get("npb.collapseCoverArt"),Icon:hi.r}:{label:s.Ru.get("npb.expandCoverArt"),Icon:bi.o}}),[o]);return(0,p.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:h()(ki,t),children:[n,(0,p.jsx)(yi.Zp,{label:c.label,children:(0,p.jsx)("button",{className:h()(xi),disabled:!r,onClick:function(){a(ji)},"aria-label":s.Ru.get("web-player.now-playing-view.label"),"aria-pressed":o,children:(0,p.jsx)(c.Icon,{iconSize:16})})})]})},Ni=t(55529),Ai=t(86147),wi=t(12306);var Ii=t(96178),Pi=t(80377),Si=t(54477),Oi=t(24777),Ti=t(23483),Di=t(99741),Ei=t(84959),Ri=function(e){var n,t,i,r,o,a=e.context,c=e.item,l=e.onLike,s=(0,Si.X)(),u=(0,$t.v)(c);return s&&(0,Pi.N)(c)?(0,p.jsx)(Ii.o,{contextUri:null!==(n=null===(t=c.metadata)||void 0===t?void 0:t.context_uri)&&void 0!==n?n:a.uri,id:null!==(i=c.uid)&&void 0!==i?i:void 0,uri:c.uri,isActive:!0}):u?(0,p.jsx)(Jt.g,{uri:c.uri,condensed:!1}):(0,li.v)(c)?c.isLocal?null:(0,p.jsx)(Wt.b,{uri:c.uri,className:"control-button control-button-heart",onClick:l}):(0,ci.p)(c)?(0,p.jsx)(Zt.b,{uri:c.uri,className:"control-button control-button-heart",onClick:l,condensed:!0}):(0,Ti.d)(c)?"trailer"===(null==c||null===(r=c.metadata)||void 0===r?void 0:r.type)&&"true"===(null==c||null===(o=c.metadata)||void 0===o?void 0:o.is_pre_release)?(0,p.jsx)(Xt,{uri:c.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:l}):(0,p.jsx)(Kt,{uri:c.book.uri,className:"control-button control-button-heart",onClick:l}):(0,Oi.N)(c)||(0,Di.v)(c)?null:(0,Pn.d)(c)},Bi=function(e){var n=e.state,t=n.item,r=n.context,o=n.index;!function(e){var n=(0,wi.i)(),t=(0,Ai.X)(e);(0,i.useEffect)((function(){t&&n.say(t)}),[t,n])}(t);var a=(0,bt.d)(),c=a.videoPlayerMode,l=a.setVideoPlayerUIFlag,s=(0,A.r)(Bt.p6,{data:{identifier:c===St.K.cinema?Bt.gw.CINEMA:Bt.gw.DESKTOP}}),u=s.spec,d=s.logger,v=(0,Ai.P)(t),f=(0,H.NC)(Gn.WAA),g=(0,Qt.w)(t);(0,i.useEffect)((function(){l(St.n.nowPlayingBar,f)}),[f,l]);var m=c===St.K.nowPlayingBar&&f;return(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsxs)("div",{"data-testid":"now-playing-widget",className:di,role:"contentinfo","aria-label":v,children:[g?(0,p.jsx)(zt,{item:t,context:r,index:o}):(0,p.jsxs)(Ci,{className:vi,children:[!m&&(0,p.jsx)(mi,{onClick:function(e){e?d.logInteraction(u.coverartFactory({uri:t.uri}).hitUiReveal()):d.logInteraction(u.coverartFactory({uri:t.uri}).hitUiHide())}}),f&&(0,p.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,p.jsx)(ei.d,{context:r,className:pi,item:t,size:"xsmall",enableVideoButton:!0,onTitleClick:function(e){d.logInteraction(u.titleFactory({uri:t.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:function(e){d.logInteraction(u.subtitleFactory({uri:t.uri}).hitUiNavigate({destination:e||""}))},referrer:ni.G.NPB}),(0,p.jsx)(Ni.a,{context:r,item:t,onClick:function(){d.logInteraction(u.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:r.uri}))}}),(0,p.jsx)(Ei.r,{spec:u,children:(0,p.jsx)(Ri,{item:t,onLike:function(e){d.logInteraction(e?u.likeButtonFactory({uri:t.uri}).hitLike({itemToBeLiked:t.uri}):u.likeButtonFactory({uri:t.uri}).hitRemoveLike({itemNoLongerLiked:t.uri}))},context:r})})]})})},_i=function(){var e=(0,At.L)();return null===e?(0,p.jsx)("div",{className:h()("now-playing")}):(0,p.jsx)(Bi,{state:e})},Fi=t(88027),Li=t(286);const Ui="aguQsGoZR9wZeawKGdDh",Mi="ieqOSqJb6kk3bG5XDOHk";var Vi=function(e){var n=e.paused,t=e.fromSeconds,r=(0,i.useState)(t),o=(0,ae.A)(r,2),a=o[0],c=o[1];return(0,Li.$)((function(e){c((function(t){return n?t:t>0?t-1:(e(),t)}))}),1e3),(0,p.jsxs)("div",{className:Ui,children:[s.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,p.jsx)("span",{className:Mi,children:a})]})},Hi=t(84723),zi=function(e){var n,t=e.children,i=(0,$.o)((function(e){return e}),(function(e,n){var t,i;return(0,B.a)(null==e?void 0:e.restrictions,null==n?void 0:n.restrictions)&&(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===(null==n||null===(i=n.item)||void 0===i?void 0:i.uri)&&(null==e?void 0:e.isPaused)===(null==n?void 0:n.isPaused)})),o=null==i?void 0:i.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),a=null!==(n=null==i?void 0:i.isPaused)&&void 0!==n&&n,c=(0,Hi.qc)(i),l=(0,Hi.Tv)(i),s=(0,r.d4)((function(e){var n,t;return c?null==e||null===(n=e.ads)||void 0===n||null===(n=n.audio)||void 0===n||null===(n=n.info)||void 0===n?void 0:n.skippableAdDelaySeconds:l?null==e||null===(t=e.ads)||void 0===t||null===(t=t.vto)||void 0===t||null===(t=t.info)||void 0===t?void 0:t.skippableAdDelaySeconds:void 0}));return o&&s?(0,p.jsx)(Vi,{paused:!!a,fromSeconds:s}):(0,p.jsx)(p.Fragment,{children:t})},Qi=t(74269),qi=t(16150),Gi=t(12046),Ki=t(85467),Zi=t(91325),Wi=t(90895),Yi=t(23527),Xi=t(53499),Ji=t(71353);const $i="player-controls",er="player-controls__buttons",nr="player-controls__left",tr="player-controls__right";var ir=(0,i.memo)((function(e){var n=e.item,t=n.isPodcastAd;return(0,p.jsxs)("div",{"data-testid":"ad-controls",className:er,children:[(0,p.jsxs)("div",{className:nr,children:[t&&(0,p.jsx)(Ji.w,{}),(0,p.jsx)(Gi.T,{item:n}),t?(0,p.jsx)(Zi.h,{}):(0,p.jsx)(Yi.d,{})]}),(0,p.jsx)(Ki.x,{}),(0,p.jsxs)("div",{className:tr,children:[t?(0,p.jsx)(Wi.v,{}):(0,p.jsx)(zi,{children:(0,p.jsx)(Xi.$,{})}),(0,p.jsx)(qi.t,{item:n})]})]})})),rr=t(56309),or=t(93313),ar=t(36277),cr=t(52742),lr=t(25077),sr=t(35949),ur=t(41772),dr=(0,i.memo)((function(e){var n=e.isPreview,t=(0,Ce.z)(),r=(0,bt.d)().videoPlayerMode,o=(0,A.r)(Fi.kD,{data:{identifier:r===St.K.cinema?Fi.gw.CINEMA:Fi.gw.DESKTOP}}),a=o.spec,c=o.logger,l=(0,$.o)((function(e){var n;return null!==(n=null==e?void 0:e.item)&&void 0!==n?n:void 0}),(function(e,n){return(null==e?void 0:e.uri)===(null==n?void 0:n.uri)})),u=(0,Qt.w)(l),d=(0,ar.p)(),v=(0,i.useCallback)((function(e,n){switch(n){case"drag":return c.logInteraction(a.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return c.logInteraction(a.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Pn.k)(n)}}),[c,a]);return(0,p.jsxs)("div",{className:$i,"data-testid":"player-controls",dir:"ltr","aria-label":s.Ru.get("playback-control.a11y.landmark-label"),children:[u?(0,p.jsx)(ir,{item:l}):(0,p.jsxs)("div",{className:er,"data-testid":"general-controls",children:[(0,p.jsxs)("div",{className:nr,children:[d&&(0,p.jsx)(Ji.w,{onClick:function(e){var n=t.getState();null!=n&&n.item&&c.logInteraction(a.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:n.item.uri,playbackSpeed:e}))}})," ",!d&&(0,p.jsx)(lr.w,{renderEnabled:function(){return(0,p.jsx)(Ei.r,{spec:a,children:(0,p.jsx)(cr.a,{size:"small"})})},renderDisabled:function(){return(0,p.jsx)(or.u,{onClick:function(e){c.logInteraction(e?a.shuffleButtonFactory().hitShuffleEnable():a.shuffleButtonFactory().hitShuffleDisable())}})}}),d&&(0,p.jsx)(Zi.h,{onClick:function(e){c.logInteraction(a.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}}),(0,p.jsx)(Yi.d,{onClick:function(){var e,n,i,r=t.getState();r&&c.logInteraction(a.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:(null===(e=r.item)||void 0===e?void 0:e.uri)||"",positionMs:null!==(n=(0,ur.s)(r))&&void 0!==n?n:-1,totalContentMs:null!==(i=r.duration)&&void 0!==i?i:-1}))}})]}),(0,p.jsx)(Ki.x,{onClick:function(e){var n=t.getState();null!=n&&n.item&&("resume"===e?c.logInteraction(null==a?void 0:a.playPauseButtonFactory().hitResume({itemToBeResumed:n.item.uri})):"pause"===e&&c.logInteraction(null==a?void 0:a.playPauseButtonFactory().hitPause({itemToBePaused:n.item.uri})))}}),(0,p.jsxs)("div",{className:tr,children:[(0,p.jsx)(zi,{children:(0,p.jsx)(Xi.$,{onClick:function(){var e,n,i=t.getState();null!=i&&i.item&&c.logInteraction(a.nextButtonFactory().hitSkipToNext({itemToBeSkipped:i.item.uri,positionMs:null!==(e=(0,ur.s)(i))&&void 0!==e?e:-1,totalContentMs:null!==(n=i.duration)&&void 0!==n?n:-1}))}})}),d&&(0,p.jsx)(Wi.v,{onClick:function(e){c.logInteraction(a.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}}),!d&&(0,p.jsx)(rr.s,{onClick:function(e){var n=(0,m.A)((0,m.A)((0,m.A)({},sr.p.REPEAT_NONE,a.repeatButtonFactory().hitRepeatDisable()),sr.p.REPEAT_TRACK,a.repeatButtonFactory().hitRepeatOneEnable()),sr.p.REPEAT_CONTEXT,a.repeatButtonFactory().hitRepeatEnable());c.logInteraction(n[e])}})]})]}),(0,p.jsx)(Qi.x,{isPreview:n,onChange:v})]})})),vr=t(14816),fr=t(99299),pr=t(29765),gr=t(77871);const mr="main-nowPlayingBar-container",br="main-nowPlayingBar-nowPlayingBar",hr="MWD1i_CSJ5N9wRBDpZmX",yr="k3NVrHXkbfflNdAxpT1_",kr="m8UPWsNtWbdkvBNvqgBN",xr="aepuRyT82biv_XmkH1eS",jr="main-nowPlayingBar-left",Cr="main-nowPlayingBar-center",Nr="main-nowPlayingBar-right";var Ar=function(){var e,n=(0,r.d4)(Mn.Ht).isAnonymous,t=(0,r.wA)(),c=(0,pt.W)(),l=(0,$.o)((function(e){return e}),(function(e,n){var t,i;return(null==e?void 0:e.hasContext)===(null==n?void 0:n.hasContext)&&(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===(null==n||null===(i=n.item)||void 0===i?void 0:i.uri)})),s=(0,$.o)((function(e){var n;return(0,Oi.N)(null!==(n=null==e?void 0:e.item)&&void 0!==n?n:void 0)})),u=(0,i.useCallback)((function(e){e.stopPropagation(),t((0,a.Ai)()),c({intent:"signup",type:"click"})}),[t,c]),d=function(){return(0,p.jsx)(fr.ql.Provider,{value:"now_playing_bar",children:(0,p.jsxs)("div",{className:n?hr:br,children:[(0,p.jsx)("div",{className:jr,children:(0,p.jsx)(_i,{})}),(0,p.jsx)("div",{className:Cr,children:(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(dr,{isPreview:n})})}),(0,p.jsx)("div",{className:Nr,children:(0,p.jsx)(Rt,{})})]})})};return(0,p.jsx)(gr.P,{surface:pr.u.NOW_PLAYING,children:(0,p.jsx)(vr.pZ,{value:"now-playing-bar",children:(0,p.jsxs)("footer",{className:mr,"data-testid":"now-playing-bar","data-testadtype":"ad-type-".concat(s?"ad":"none"),children:[n?(0,p.jsx)(vr.pZ,{value:"preview-bar",children:(0,p.jsx)(g,{handleClick:u})}):null,n?(0,p.jsx)(o.A,{in:null!==(e=null==l?void 0:l.hasContext)&&void 0!==e&&e,timeout:200,classNames:{enter:yr,enterActive:kr,enterDone:xr},children:d()}):d(),(0,p.jsx)(M,{})]})})})}},94980:(e,n,t)=>{t.d(n,{L:()=>a});var i=t(43332),r=t(81752),o=t(1131),a=function(e){var n=(0,r.dY)(),t=(0,o.vh)(),a=n.getInStreamAd();return{logAdFeedback:function(n){var r,o;t.send((0,i.F)({ad_id:e.id,advertiser:e.advertiser,creative_id:(null==a?void 0:a.adId)===e.id?null==a||null===(r=a.metadata)||void 0===r?void 0:r.creative_id:void 0,format:e.mediaType,line_item_id:(null==a?void 0:a.adId)===e.id?null==a||null===(o=a.metadata)||void 0===o?void 0:o.lineitem_id:void 0,event:n}))}}}},97787:(e,n,t)=>{t.d(n,{N2:()=>a,Tt:()=>o});var i=t(42551),r=function(e){return e.ads.adFeedback},o=(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return!(!n||e.adId!==n)&&e.liked})),a=(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return!(!n||e.adId!==n)&&e.disliked}));(0,i.Mz)([function(e){return r(e)},function(e,n){return n}],(function(e,n){return n&&e.adId===n?e.feedback:null}))},49557:(e,n,t)=>{t.d(n,{w:()=>f});var i=t(5904),r=t(64501),o=t.n(r),a=(t(16347),t(18653),t(30758)),c=t(37937),l=t(99),s=t(78253),u=t(13048),d=t(73129),v=t(57965),f=function(e){var n=e.uri,t=e.isBook,r=(0,d.p)("prerelease"),f=r.add,p=r.remove,g=(0,u.o)("prerelease",[n]).at(0),m=(0,s.d)().enqueueSnackbar,b=(0,v.r)(c.k,{data:{uri:n}}),h=b.spec,y=b.logger;return{isPreSaved:g,addPresave:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.logInteraction(h.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:n,itemToBePresaved:n,contextUri:n})),e.next=3,f(n);case 3:m(t?l.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):l.Ru.get("web-player.prerelease.album_feedback_presaved"));case 4:case"end":return e.stop()}}),e)}))),[f,m,t,y,h,n]),removePresave:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.logInteraction(h.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:n,itemToBeRemovedFromPresaved:n,contextUri:n})),e.next=3,p(n);case 3:case"end":return e.stop()}}),e)}))),[y,p,h,n])}}},39370:(e,n,t)=>{t.d(n,{s:()=>r,u:()=>i});var i=function(e){return e.ui.lyrics.mode},r=function(e){return e.ui.lyrics.translationLanguage}},10364:(e,n,t)=>{t.d(n,{A:()=>c});var i=t(90543),r=t(64748),o=t(11001),a=t(32813);function c(e){var n=e.referrer,t=e.onChange,c=(0,i.Zp)(),l=(0,r.$)(),s=l.isActive,u=l.routeDestination,d=(0,o.d)().setVideoPlayerUIFlag,v=function(){s||(d(a.n.cinema,!1),c(u,{state:{referrer:n}}),null==t||t(u))},f=function(){s&&(c(-1),null==t||t(null))};return{isActive:s,showLyrics:v,hideLyrics:f,toggleLyrics:function(){s?f():v()}}}},54477:(e,n,t)=>{t.d(n,{X:()=>i.XR});var i=t(47060)},286:(e,n,t)=>{t.d(n,{$:()=>r});t(60287);var i=t(30758),r=function(e,n){var t=(0,i.useRef)(e);(0,i.useEffect)((function(){t.current=e}),[e]),(0,i.useEffect)((function(){var e=void 0;function i(){e&&clearInterval(e)}if(null!==n)return e=setInterval((function(){t.current(i)}),n),i}),[n])}},82245:(e,n,t)=>{t.d(n,{D:()=>u});var i=t(30758),r=t(9516),o=(t(60287),t(11001)),a=t(32813),c=t(33786),l=t(24821),s=t(57965),u=function(e){var n=e.item,t=e.onClick,u=(0,c.W)(),d=(0,l.H)(),v=d.capabilities.isEnabled,f=d.isOpen,p=d.close,g=d.open,m=d.canOpen,b=(0,o.d)().videoPlayerMode,h=(0,s.r)(r.h9,{data:{identifier:b===a.K.cinema?r.gw.CINEMA:r.gw.DESKTOP}}),y=h.spec,k=h.logger,x=(0,i.useCallback)((function(){var e;v&&(f?(p(),null!=n&&n.uri&&k.logInteraction(y.pipButtonFactory({uri:n.uri}).hitUiHide()),e="close-picture-in-picture"):(g(),null!=n&&n.uri&&function(e){var n=e.spec,t=e.logger,i=e.uri,r=window.documentPictureInPicture;if(r){var o=function(e){setTimeout((function(){var r,o,a=null===(r=e.window)||void 0===r?void 0:r.innerWidth,c=null===(o=e.window)||void 0===o?void 0:o.innerHeight;if(a&&c){var l=n.pipButtonFactory({uri:i}).hitUiOpenWindow({widthPx:a,heightPx:c});t.logInteraction(l)}}),100),r.removeEventListener("enter",o)};r.addEventListener("enter",o)}}({spec:y,logger:k,uri:n.uri}),e="show-picture-in-picture"),null==t||t(!f,null==n?void 0:n.uri),u({type:"click",intent:e,targetUri:null==n?void 0:n.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[p,v,f,null==n?void 0:n.uri,k,t,u,g,y]);return{showButton:m,isActive:f,onClick:x}}},58771:(e,n,t)=>{t.d(n,{I:()=>p});var i=t(5904),r=t(64501),o=t.n(r),a=t(30758),c=t(46908),l=(t(2823),t(4672),t(71007)),s=function(e,n,t){var i=n.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",t);return e.build().withMethod("POST").withHost(l.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()},u=function(e,n,t){var i=n.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",t);return e.build().withMethod("DELETE").withHost(l.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()},d=t(64654),v=t(4178),f=t(34871),p=function(e){var n=e.uri,t=e.setFeedbackPath,r=e.removeFeedbackPath,l=e.contextUri,p=(0,d.z)(),g=(0,v.m)(),m=(0,f.te)(n).isPlaying,b=(0,a.useCallback)((function(){l&&g.resync(l)}),[l,g]);return{setDislikeFeedback:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,s(c.n.getInstance(),t,n);case 4:b(),m&&p.skipToNext();case 6:case"end":return e.stop()}}),e)}))),[t,n,b,m,p]),removeDislikeFeedback:(0,a.useCallback)((0,i.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u(c.n.getInstance(),r,n);case 4:b();case 5:case"end":return e.stop()}}),e)}))),[r,b,n])}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map